{"remainingRequest":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js!D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\apply\\expense\\Info.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\apply\\expense\\Info.vue","mtime":1591091905398},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _defineProperty from \"D:\\\\DDMS\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getExpenseInfo as _getExpenseInfo, updateExpress, affirmExpense, getExpenseApproverList as _getExpenseApproverList, updateExpenseApprover } from \"../../../api/apply/expense.js\";\nimport { mapGetters } from 'vuex';\nimport ElImageViewer from 'element-ui/packages/image/src/image-viewer';\nexport default {\n  components: {\n    ElImageViewer: ElImageViewer\n  },\n  data: function data() {\n    return {\n      dialogVisibleExpress: false,\n      dialogVisibleInvoice: false,\n      editExpressData: {\n        expenseId: null,\n        purchaseStatus: null,\n        expressName: '',\n        expressNum: ''\n      },\n      editInvoiceData: {\n        expenseId: null,\n        invoiceType: '',\n        taxRate: '',\n        invoiceImg: ''\n      },\n      purchaseStatusOptions: [{\n        value: '0',\n        label: '未支付'\n      }, {\n        value: '1',\n        label: '已支付未发货'\n      }, {\n        value: '2',\n        label: '已发货'\n      }, {\n        value: '3',\n        label: '已签收'\n      }, {\n        value: '4',\n        label: '已支付无需发货'\n      }],\n      invoiceTypeOptions: [{\n        value: '0',\n        label: '无发票'\n      }, {\n        value: '1',\n        label: '专票'\n      }, {\n        value: '2',\n        label: '普票'\n      }],\n      formData: {\n        approverId: null,\n        checkUserId: null,\n        check: '1',\n        summary: '同意'\n      },\n      expenseId: null,\n      expenseInfo: null,\n      listLoading: false,\n      list: [],\n      approverList: [],\n      ruleForm: {\n        check: '1',\n        desc: '同意'\n      },\n      rules: {\n        desc: [{\n          required: true,\n          message: '请填写批注',\n          trigger: 'blur'\n        }],\n        purchaseStatus: [{\n          required: true,\n          message: '请选择采购状态',\n          trigger: 'change'\n        }],\n        expressName: [{\n          required: true,\n          message: '请填写快递公司'\n        }],\n        expressNum: [{\n          required: true,\n          message: '请填写快递单号'\n        }],\n        invoiceType: [{\n          required: true,\n          message: '请选择发票状态',\n          trigger: 'change'\n        }],\n        taxRate: [{\n          required: true,\n          message: '请填写税率'\n        }]\n      },\n      showViewer: false,\n      // 显示查看器\n      url: '',\n      urls1: [],\n      urls2: [],\n      showCheck: false,\n      saving: false,\n      uploadUrl: '',\n      fileList1: []\n    };\n  },\n  computed: _objectSpread({}, mapGetters(['permissions', 'userId', 'deptId'])),\n  created: function created() {\n    this.expenseId = this.$route.params.expenseId;\n    this.formData.checkUserId = this.userId;\n    this.getExpenseInfo();\n    this.getExpenseApproverList();\n    this.uploadUrl = \"\".concat(window.location.origin, \"/apply/expense/upload\");\n  },\n  methods: {\n    getExpenseInfo: function getExpenseInfo() {\n      var _this = this;\n\n      _getExpenseInfo(this.expenseId).then(function (response) {\n        _this.expenseInfo = response.data.data;\n\n        if (_this.expenseInfo.invoiceImg) {\n          _this.expenseInfo.invoiceImg.split(',').forEach(function (item, index) {\n            if (item) {\n              _this.urls1.push(\"\".concat(window.location.origin, \"/apply/expense/\") + item);\n            }\n          });\n        }\n\n        if (_this.expenseInfo.contract) {\n          _this.expenseInfo.contract.split(',').forEach(function (item, index) {\n            if (item) {\n              _this.urls2.push(\"\".concat(window.location.origin, \"/apply/expense/\") + item);\n            }\n          });\n        }\n      });\n    },\n    getExpenseApproverList: function getExpenseApproverList() {\n      var _this2 = this;\n\n      _getExpenseApproverList(this.expenseId).then(function (response) {\n        _this2.approverList = response.data.data;\n\n        _this2.approverList.forEach(function (item, index) {\n          if (item.check == '0' && item.isBeing == '1' && item.userId == _this2.formData.checkUserId) {\n            _this2.formData.approverId = item.approverId;\n            _this2.showCheck = true;\n          }\n        });\n      });\n    },\n    backHistory: function backHistory() {\n      this.$router.go(-1);\n    },\n    onPreview1: function onPreview1(val) {\n      this.url = this.urls1[val];\n      this.showViewer = true;\n    },\n    onPreview2: function onPreview2(val) {\n      this.url = this.urls2[val];\n      this.showViewer = true;\n    },\n    closeViewer: function closeViewer() {\n      this.showViewer = false;\n      this.url = '';\n    },\n    selectChcek: function selectChcek() {\n      if (this.formData.check == 1) {\n        this.formData.summary = '同意';\n      } else {\n        this.formData.summary = '';\n      }\n    },\n    onSubmit: function onSubmit() {\n      var _this3 = this;\n\n      updateExpenseApprover(this.formData).then(function (res) {\n        if (res.data.data) {\n          _this3.backHistory();\n        }\n      }).finally(function () {\n        _this3.saving = false;\n      });\n    },\n    selectPurchaseStatus: function selectPurchaseStatus(val) {// if (val == 2 || val == 3){\n      //     console.log(val)\n      // }\n    },\n    selectInvoiceType: function selectInvoiceType(val) {},\n    handleModal: function handleModal(data) {\n      this.editExpressData.expenseId = data.expenseId;\n      this.editExpressData.purchaseStatus = data.purchaseStatus;\n      this.editExpressData.expressName = data.expressName;\n      this.editExpressData.expressNum = data.expressNum;\n      this.dialogVisibleExpress = true;\n    },\n    handleModalInvoice: function handleModalInvoice(data) {\n      var _this4 = this;\n\n      this.editInvoiceData.expenseId = data.expenseId;\n      this.editInvoiceData.invoiceType = data.invoiceType;\n      this.editInvoiceData.taxRate = data.taxRate;\n      this.editInvoiceData.invoiceImg = data.invoiceImg;\n\n      if (data.invoiceImg) {\n        data.invoiceImg.split(',').forEach(function (item, index) {\n          if (item) {\n            _this4.fileList1.push({\n              url: \"\".concat(window.location.origin, \"/apply/expense/\") + item\n            });\n          }\n        });\n      }\n\n      this.dialogVisibleInvoice = true;\n    },\n    handleSubmit: function handleSubmit() {\n      var _this5 = this;\n\n      this.$refs['editExpressData'].validate(function (valid) {\n        if (valid) {\n          updateExpress(_this5.editExpressData).then(function (res) {\n            if (res.data.data) {\n              _this5.dialogVisibleExpress = false;\n\n              _this5.getExpenseInfo();\n            }\n          }).finally(function () {});\n        }\n      });\n    },\n    handleSubmitInvoice: function handleSubmitInvoice() {\n      var _this6 = this;\n\n      this.$refs['editInvoiceData'].validate(function (valid) {\n        if (valid) {\n          updateExpress(_this6.editInvoiceData).then(function (res) {\n            if (res.data.data) {\n              _this6.dialogVisibleInvoice = false;\n\n              _this6.getExpenseInfo();\n            }\n          }).finally(function () {});\n        }\n      });\n    },\n    beforeAvatarUpload: function beforeAvatarUpload(file) {\n      var isJPG = file.type === 'image/jpeg';\n      var isPNG = file.type === 'image/png';\n      var isPG = isJPG || isPNG; //限制图片格式为jpg / png\n\n      var isLt5M = file.size / 1024 / 1024 < 5; //限制图片大小\n\n      if (!isPG) {\n        this.$message.error('图片只能是 JPG 或 PNG 格式!');\n      }\n\n      if (!isLt5M) {\n        this.$message.error('图片大小不能超过 5MB!');\n      }\n\n      return isPG && isLt5M;\n    },\n    handleRemove1: function handleRemove1(data) {\n      var imgInfo = data.response.data;\n      var imgUrl = imgInfo.bucketName + '-' + imgInfo.fileName;\n      this.editInvoiceData.invoiceImg = this.editInvoiceData.invoiceImg.replace(imgUrl + ',', ''); //console.log(this.editInvoiceData.invoiceImg)\n    },\n    handlePreview1: function handlePreview1(file) {\n      console.log(file);\n    },\n    handSuccess1: function handSuccess1(data) {\n      var imgInfo = data.data;\n      var imgUrl = imgInfo.bucketName + '-' + imgInfo.fileName;\n      this.editInvoiceData.invoiceImg += imgUrl + ','; //console.log(this.editInvoiceData.invoiceImg)\n    },\n    handleModalAffirm: function handleModalAffirm(data) {\n      var _this7 = this;\n\n      //console.log(data)\n      if (data.expenseId) {\n        this.$confirm('确认收到发票了吗?', '提示', {\n          type: 'warning'\n        }).then(function () {\n          var editData = {\n            expenseId: data.expenseId,\n            isAffirm: '1'\n          };\n          affirmExpense(editData).then(function (res) {\n            if (res.data.data) {\n              _this7.getExpenseInfo();\n            }\n          });\n        });\n      }\n    }\n  }\n};",{"version":3,"sources":["Info.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div style=\"max-width: 800px;\">\r\n        <el-button @click=\"backHistory\" class=\"back\">返回</el-button>\r\n        <div class=\"title\" style=\"margin-top: -40px;margin-bottom:20px;\">\r\n            <p class=\"name\">支出申请单</p>\r\n            <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" v-if=\"expenseInfo\">\r\n                <tr v-if=\"expenseInfo.isPublic == 1\">\r\n                    <td>支出名称</td>\r\n                    <td>{{ expenseInfo.name }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 0\">\r\n                    <td>采购名称</td>\r\n                    <td>{{ expenseInfo.name }}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>总分类</td>\r\n                    <td v-if=\"expenseInfo.classify == 1\">项目</td>\r\n                    <td v-else-if=\"expenseInfo.classify == 2\">产品</td>\r\n                    <td v-else-if=\"expenseInfo.classify == 3\">库存</td>\r\n                    <td v-else-if=\"expenseInfo.classify == 4\">其他</td>\r\n                    <td v-else></td>\r\n                </tr>\r\n\r\n                <tr v-if=\"expenseInfo.classify == 1\">\r\n                    <td style=\"width: 35%;\">项目</td>\r\n                    <td v-if=\"expenseInfo.alias != null\">{{ expenseInfo.alias }}</td>\r\n                    <td v-else>与项目无关</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.classify == 2\">\r\n                    <td style=\"width: 35%;\">产品</td>\r\n                    <td v-if=\"expenseInfo.alias != null\">{{ expenseInfo.alias }}</td>\r\n                    <td v-else>与项目无关</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.classify == 3\">\r\n                    <td>明细分类</td>\r\n                    <td v-if=\"expenseInfo.type == 1\">研发库存</td>\r\n                    <td v-else-if=\"expenseInfo.type == 2\">产品库存</td>\r\n                    <td v-else></td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.classify == 4\">\r\n                    <td>明细分类</td>\r\n                    <td v-if=\"expenseInfo.type == 1\">工具采购</td>\r\n                    <td v-else-if=\"expenseInfo.type == 2\">办公用品</td>\r\n                    <td v-else-if=\"expenseInfo.type == 3\">办公家具</td>\r\n                    <td v-else-if=\"expenseInfo.type == 4\">税款</td>\r\n                    <td v-else-if=\"expenseInfo.type == 5\">会议服务费</td>\r\n\t\t\t\t\t<td v-else-if=\"expenseInfo.type == 6\">管理费</td>\r\n                    <td v-else></td>\r\n                </tr>\r\n                <tr>\r\n                    <td>申请人</td>\r\n                    <td>{{ expenseInfo.applyUserName }}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>是否对外</td>\r\n                    <td v-if=\"expenseInfo.isPublic == 0\"><el-tag type=\"danger\">否</el-tag></td>\r\n                    <td v-if=\"expenseInfo.isPublic == 1\"><el-tag type=\"success\">是</el-tag></td>\r\n                </tr>\r\n\r\n                <tr v-if=\"expenseInfo.isPublic == 1\">\r\n                    <td>公司名称</td>\r\n                    <td>{{ expenseInfo.companyName }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 1\">\r\n                    <td>银行名称</td>\r\n                    <td>{{ expenseInfo.bankName }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 1\">\r\n                    <td>银行账号</td>\r\n                    <td>{{ expenseInfo.bankAccount }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 1\">\r\n                    <td>支出金额</td>\r\n                    <td>{{ expenseInfo.priceYuan }} 元</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 1\">\r\n                    <td>备注信息</td>\r\n                    <td>{{ expenseInfo.remark }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 1\">\r\n                    <td>用途及明细</td>\r\n                    <td>{{ expenseInfo.detailed }}</td>\r\n                </tr>\r\n\r\n                <tr v-if=\"expenseInfo.isPublic == 0\">\r\n                    <td>厂家名称</td>\r\n                    <td>{{ expenseInfo.companyName }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 0\">\r\n                    <td>联系方式</td>\r\n                    <td>{{ expenseInfo.contact }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 0\">\r\n                    <td>购买链接</td>\r\n                    <td>{{ expenseInfo.buyUrl }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 0\">\r\n                    <td>型号参数</td>\r\n                    <td>{{ expenseInfo.model }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 0\">\r\n                    <td>数量/单位</td>\r\n                    <td>{{ expenseInfo.num }}&nbsp;{{ expenseInfo.unit }}</td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 0\">\r\n                    <td>议定单价</td>\r\n                    <td>{{ expenseInfo.priceYuan }} 元</td>\r\n                </tr>\r\n\r\n                <tr>\r\n                    <td>合同及附件图片</td>\r\n                    <td v-if=\"expenseInfo.contract\">\r\n                        <el-image v-for=\"(url, index) in urls2\" :key=\"url\" :src=\"url\" lazy @click=\"onPreview2(index)\"></el-image>\r\n                        <el-image-viewer v-if=\"showViewer\" :on-close=\"closeViewer\" :url-list=\"[url]\"></el-image-viewer>\r\n                    </td>\r\n                    <td v-else>无</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>审批状态</td>\r\n                    <td>\r\n                        <span v-if=\"expenseInfo.status == '0'\"><el-tag type=\"warning\">审批中</el-tag></span>\r\n                        <span v-else-if=\"expenseInfo.status == '1'\"><el-tag type=\"success\">已同意</el-tag></span>\r\n                        <span v-else-if=\"expenseInfo.status == '2'\"><el-tag type=\"danger\">已拒绝</el-tag></span>\r\n                        <span v-else></span>\r\n                    </td>\r\n                </tr>\r\n                <tr v-if=\"(formData.isPublic = '1')\">\r\n                    <td>确认状态</td>\r\n                    <td>\r\n                        <span v-if=\"expenseInfo.isAffirm == '1'\"><el-tag type=\"success\">已确认</el-tag></span>\r\n                        <span v-else-if=\"expenseInfo.isAffirm == '0'\"><el-tag type=\"danger\">未确认</el-tag></span>\r\n                        <span v-else></span>\r\n                        &nbsp;&nbsp;\r\n                        <el-button\r\n                            size=\"mini\"\r\n                            type=\"danger\"\r\n                            @click.native=\"handleModalAffirm(expenseInfo)\"\r\n                            v-if=\"expenseInfo.status == 1 && expenseInfo.isAffirm == 0 && deptId == '7100'\"\r\n                        >\r\n                            确认\r\n                        </el-button>\r\n                    </td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 0\">\r\n                    <td>采购状态</td>\r\n                    <td>\r\n                        <el-tag v-if=\"expenseInfo.purchaseStatus == 0\" type=\"warning\">未支付</el-tag>\r\n                        <el-tag v-else-if=\"expenseInfo.purchaseStatus == 1\" type=\"warning\">已支付未发货</el-tag>\r\n                        <el-tag v-else-if=\"expenseInfo.purchaseStatus == 2\" type=\"success\">已发货</el-tag>\r\n                        <el-tag v-else-if=\"expenseInfo.purchaseStatus == 3\" type=\"success\">已签收</el-tag>\r\n                        <el-tag v-else-if=\"expenseInfo.purchaseStatus == 4\" type=\"success\">已支付无需发货</el-tag>\r\n                        <el-tag v-else></el-tag>\r\n                        <el-button size=\"mini\" type=\"danger\" @click.native=\"handleModal(expenseInfo)\" v-if=\"deptId == '3000' || deptId == '3200'\">编辑</el-button>\r\n                    </td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.isPublic == 0 && (expenseInfo.purchaseStatus == 2 || expenseInfo.purchaseStatus == 3)\">\r\n                    <td>物流信息</td>\r\n                    <td>{{ expenseInfo.expressName }}：{{ expenseInfo.expressNum }}</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>发票信息</td>\r\n                    <td>\r\n                        <span v-if=\"expenseInfo.invoiceType == 0\">无发票</span>\r\n                        <span v-else-if=\"expenseInfo.invoiceType == 1\">专票</span>\r\n                        <span v-else-if=\"expenseInfo.invoiceType == 2\">普票</span>\r\n                        <span v-if=\"expenseInfo.invoiceType > 0\">：{{ expenseInfo.taxRate }} %</span>\r\n                        <el-button size=\"mini\" type=\"danger\" @click.native=\"handleModalInvoice(expenseInfo)\" v-if=\"deptId == '3000' || deptId == '3200'\">编辑</el-button>\r\n                    </td>\r\n                </tr>\r\n                <tr v-if=\"expenseInfo.invoiceType > 0\">\r\n                    <td>发票图片</td>\r\n                    <td v-if=\"expenseInfo.invoiceImg\">\r\n                        <el-image v-for=\"(url, index) in urls1\" :key=\"url\" :src=\"url\" lazy @click=\"onPreview1(index)\"></el-image>\r\n                        <el-image-viewer v-if=\"showViewer\" :on-close=\"closeViewer\" :url-list=\"[url]\"></el-image-viewer>\r\n                    </td>\r\n                    <td v-else>无</td>\r\n                </tr>\r\n                <tr>\r\n                    <td>申请时间</td>\r\n                    <td>{{ expenseInfo.createTime }}</td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n        <div><p class=\"name\">审批结果</p></div>\r\n        <div class=\"result\" v-for=\"approver in approverList\">\r\n            <el-avatar size=\"medium\" :src=\"approver.checkUserAvatar\" class=\"avatar\"></el-avatar>\r\n            <span class=\"username\" style=\"color: #65CEA7;\">\r\n                {{ approver.checkUserName }}\r\n                <i class=\"el-icon-time\" style=\"color: #000;margin-left: 10px;margin-right: 5px\" v-if=\"approver.check > 0\"></i>\r\n                <span style=\"color: #000\" v-if=\"approver.check > 0\">{{ approver.updateTime }}</span>\r\n            </span>\r\n            <span style=\"color: #000000;margin-top: 45px;position: absolute;font-size: 12px\">审批意见：{{ approver.summary }}</span>\r\n            <div>\r\n                <span v-if=\"approver.check == 0 && approver.isBeing == 1\">\r\n                    <el-tag class=\"checkSty\" type=\"warning\">\r\n                        <i class=\"el-icon-loading\" style=\"margin-right:5px\"></i>\r\n                        审批中\r\n                    </el-tag>\r\n                </span>\r\n                <span v-if=\"approver.check == 0 && approver.isBeing == 0\">\r\n                    <el-tag class=\"checkSty\" type=\"\">\r\n                        <i class=\"el-icon-loading\" style=\"margin-right:5px\"></i>\r\n                        待审批\r\n                    </el-tag>\r\n                </span>\r\n                <span v-if=\"approver.check == 1\">\r\n                    <el-tag class=\"checkSty\" type=\"success\">\r\n                        <i class=\"el-icon-success\" style=\"margin-right:5px\"></i>\r\n                        已同意\r\n                    </el-tag>\r\n                </span>\r\n                <span v-if=\"approver.check == 2\">\r\n                    <el-tag class=\"checkSty\" type=\"danger\">\r\n                        <i class=\"el-icon-error\" style=\"margin-right:5px\"></i>\r\n                        已拒绝\r\n                    </el-tag>\r\n                </span>\r\n            </div>\r\n        </div>\r\n\r\n        <div v-if=\"showCheck\">\r\n            <div class=\"title left\"><p class=\"name\">审批</p></div>\r\n            <el-alert title=\"审批流程不可逆转\" type=\"warning\"></el-alert>\r\n            <el-form :model=\"formData\" :rules=\"rules\" ref=\"formData\" label-width=\"100px\" class=\"demo-ruleForm res\" style=\"width: 100%\">\r\n                <el-radio-group v-model=\"formData.check\" @change=\"selectChcek\" style=\"margin-top: 10px;margin-left: 20px\">\r\n                    <el-radio label=\"1\">同意</el-radio>\r\n                    <el-radio label=\"2\">拒绝</el-radio>\r\n                </el-radio-group>\r\n                <el-form-item prop=\"summary\" style=\"margin-left: -100px;margin-top: 10px\">\r\n                    <el-input type=\"textarea\" v-model=\"formData.summary\" placeholder=\"请填写原因\" maxlength=\"30\" show-word-limit></el-input>\r\n                </el-form-item>\r\n                <el-form-item><el-button type=\"success\" class=\"submit\" @click=\"onSubmit\" :loading=\"saving\">提交</el-button></el-form-item>\r\n            </el-form>\r\n        </div>\r\n\r\n        <el-dialog title=\"修改采购状态\" :visible.sync=\"dialogVisibleExpress\" :width=\"'80%'\">\r\n            <el-form :model=\"editExpressData\" :rules=\"rules\" ref=\"editExpressData\" label-width=\"80px\">\r\n                <el-form-item label=\"状态\" prop=\"purchaseStatus\">\r\n                    <el-select v-model=\"editExpressData.purchaseStatus\" placeholder=\"请选择\" @change=\"selectPurchaseStatus\">\r\n                        <el-option v-for=\"(item, index) in purchaseStatusOptions\" :value=\"item.value\" :key=\"index\" :label=\"item.label\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"快递公司\" prop=\"expressName\" v-if=\"editExpressData.purchaseStatus == 2 || editExpressData.purchaseStatus == 3\">\r\n                    <el-input v-model=\"editExpressData.expressName\" placeholder=\"请填写快递公司\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"快递单号\" prop=\"expressNum\" v-if=\"editExpressData.purchaseStatus == 2 || editExpressData.purchaseStatus == 3\">\r\n                    <el-input v-model=\"editExpressData.expressNum\" placeholder=\"请填写快递单号\"></el-input>\r\n                </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button type=\"primary\" @click=\"handleSubmit\">提 交</el-button>\r\n                <el-button @click=\"dialogVisibleExpress = false\">取 消</el-button>\r\n            </div>\r\n        </el-dialog>\r\n        <el-dialog title=\"修改审批状态\" :visible.sync=\"dialogVisibleInvoice\" :width=\"'80%'\">\r\n            <el-form :model=\"editInvoiceData\" :rules=\"rules\" ref=\"editInvoiceData\" label-width=\"135px\">\r\n                <el-form-item label=\"状态\" prop=\"invoiceType\">\r\n                    <el-select v-model=\"editInvoiceData.invoiceType\" placeholder=\"请选择\" @change=\"selectInvoiceType\">\r\n                        <el-option v-for=\"(item, index) in invoiceTypeOptions\" :value=\"item.value\" :key=\"index\" :label=\"item.label\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"税率\" prop=\"taxRate\" v-if=\"editInvoiceData.invoiceType > 0\">\r\n                    <el-input type=\"number\" v-model=\"editInvoiceData.taxRate\" placeholder=\"请填写税率\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"发票图片：\" v-if=\"editInvoiceData.invoiceType > 0\" prop=\"invoiceImg\">\r\n                    <el-upload\r\n                        class=\"upload-demo box\"\r\n                        :action=\"uploadUrl\"\r\n                        name=\"file\"\r\n                        :on-preview=\"handlePreview1\"\r\n                        :on-remove=\"handleRemove1\"\r\n                        :on-success=\"handSuccess1\"\r\n                        :file-list=\"fileList1\"\r\n                        accept=\".png,.jpg,.jpeg,.JPEG,.PNG,.JPG\"\r\n                        :auto-upload=\"true\"\r\n                        :before-upload=\"beforeAvatarUpload\"\r\n                        list-type=\"picture\"\r\n                    >\r\n                        <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n                        <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n                    </el-upload>\r\n                </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button type=\"primary\" @click=\"handleSubmitInvoice\">提 交</el-button>\r\n                <el-button @click=\"dialogVisibleInvoice = false\">取 消</el-button>\r\n            </div>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { getExpenseInfo, updateExpress, affirmExpense, getExpenseApproverList, updateExpenseApprover } from '../../../api/apply/expense.js';\r\nimport { mapGetters } from 'vuex';\r\nimport ElImageViewer from 'element-ui/packages/image/src/image-viewer';\r\nexport default {\r\n    components: { ElImageViewer },\r\n    data() {\r\n        return {\r\n            dialogVisibleExpress: false,\r\n            dialogVisibleInvoice: false,\r\n            editExpressData: {\r\n                expenseId: null,\r\n                purchaseStatus: null,\r\n                expressName: '',\r\n                expressNum: ''\r\n            },\r\n            editInvoiceData: {\r\n                expenseId: null,\r\n                invoiceType: '',\r\n                taxRate: '',\r\n                invoiceImg: ''\r\n            },\r\n            purchaseStatusOptions: [\r\n                {\r\n                    value: '0',\r\n                    label: '未支付'\r\n                },\r\n                {\r\n                    value: '1',\r\n                    label: '已支付未发货'\r\n                },\r\n                {\r\n                    value: '2',\r\n                    label: '已发货'\r\n                },\r\n                {\r\n                    value: '3',\r\n                    label: '已签收'\r\n                },\r\n                {\r\n                    value: '4',\r\n                    label: '已支付无需发货'\r\n                }\r\n            ],\r\n            invoiceTypeOptions: [\r\n                {\r\n                    value: '0',\r\n                    label: '无发票'\r\n                },\r\n                {\r\n                    value: '1',\r\n                    label: '专票'\r\n                },\r\n                {\r\n                    value: '2',\r\n                    label: '普票'\r\n                }\r\n            ],\r\n            formData: {\r\n                approverId: null,\r\n                checkUserId: null,\r\n                check: '1',\r\n                summary: '同意'\r\n            },\r\n            expenseId: null,\r\n            expenseInfo: null,\r\n            listLoading: false,\r\n            list: [],\r\n            approverList: [],\r\n            ruleForm: {\r\n                check: '1',\r\n                desc: '同意'\r\n            },\r\n            rules: {\r\n                desc: [{ required: true, message: '请填写批注', trigger: 'blur' }],\r\n                purchaseStatus: [\r\n                    {\r\n                        required: true,\r\n                        message: '请选择采购状态',\r\n                        trigger: 'change'\r\n                    }\r\n                ],\r\n                expressName: [{ required: true, message: '请填写快递公司' }],\r\n                expressNum: [{ required: true, message: '请填写快递单号' }],\r\n                invoiceType: [\r\n                    {\r\n                        required: true,\r\n                        message: '请选择发票状态',\r\n                        trigger: 'change'\r\n                    }\r\n                ],\r\n                taxRate: [{ required: true, message: '请填写税率' }]\r\n            },\r\n            showViewer: false, // 显示查看器\r\n            url: '',\r\n            urls1: [],\r\n            urls2: [],\r\n            showCheck: false,\r\n            saving: false,\r\n            uploadUrl: '',\r\n            fileList1: []\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapGetters(['permissions', 'userId', 'deptId'])\r\n    },\r\n    created() {\r\n        this.expenseId = this.$route.params.expenseId;\r\n        this.formData.checkUserId = this.userId;\r\n        this.getExpenseInfo();\r\n        this.getExpenseApproverList();\r\n        this.uploadUrl = `${window.location.origin}/apply/expense/upload`;\r\n    },\r\n    methods: {\r\n        getExpenseInfo() {\r\n            getExpenseInfo(this.expenseId).then(response => {\r\n                this.expenseInfo = response.data.data;\r\n                if (this.expenseInfo.invoiceImg) {\r\n                    this.expenseInfo.invoiceImg.split(',').forEach((item, index) => {\r\n                        if (item) {\r\n                            this.urls1.push(`${window.location.origin}/apply/expense/` + item);\r\n                        }\r\n                    });\r\n                }\r\n                if (this.expenseInfo.contract) {\r\n                    this.expenseInfo.contract.split(',').forEach((item, index) => {\r\n                        if (item) {\r\n                            this.urls2.push(`${window.location.origin}/apply/expense/` + item);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        },\r\n        getExpenseApproverList() {\r\n            getExpenseApproverList(this.expenseId).then(response => {\r\n                this.approverList = response.data.data;\r\n                this.approverList.forEach((item, index) => {\r\n                    if (item.check == '0' && item.isBeing == '1' && item.userId == this.formData.checkUserId) {\r\n                        this.formData.approverId = item.approverId;\r\n                        this.showCheck = true;\r\n                    }\r\n                });\r\n            });\r\n        },\r\n        backHistory() {\r\n            this.$router.go(-1);\r\n        },\r\n        onPreview1(val) {\r\n            this.url = this.urls1[val];\r\n            this.showViewer = true;\r\n        },\r\n        onPreview2(val) {\r\n            this.url = this.urls2[val];\r\n            this.showViewer = true;\r\n        },\r\n        closeViewer() {\r\n            this.showViewer = false;\r\n            this.url = '';\r\n        },\r\n        selectChcek() {\r\n            if (this.formData.check == 1) {\r\n                this.formData.summary = '同意';\r\n            } else {\r\n                this.formData.summary = '';\r\n            }\r\n        },\r\n        onSubmit() {\r\n            updateExpenseApprover(this.formData)\r\n                .then(res => {\r\n                    if (res.data.data) {\r\n                        this.backHistory();\r\n                    }\r\n                })\r\n                .finally(() => {\r\n                    this.saving = false;\r\n                });\r\n        },\r\n        selectPurchaseStatus(val) {\r\n            // if (val == 2 || val == 3){\r\n            //     console.log(val)\r\n            // }\r\n        },\r\n        selectInvoiceType(val) {},\r\n        handleModal(data) {\r\n            this.editExpressData.expenseId = data.expenseId;\r\n            this.editExpressData.purchaseStatus = data.purchaseStatus;\r\n            this.editExpressData.expressName = data.expressName;\r\n            this.editExpressData.expressNum = data.expressNum;\r\n            this.dialogVisibleExpress = true;\r\n        },\r\n        handleModalInvoice(data) {\r\n            this.editInvoiceData.expenseId = data.expenseId;\r\n            this.editInvoiceData.invoiceType = data.invoiceType;\r\n            this.editInvoiceData.taxRate = data.taxRate;\r\n            this.editInvoiceData.invoiceImg = data.invoiceImg;\r\n            if (data.invoiceImg) {\r\n                data.invoiceImg.split(',').forEach((item, index) => {\r\n                    if (item) {\r\n                        this.fileList1.push({\r\n                            url: `${window.location.origin}/apply/expense/` + item\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n            this.dialogVisibleInvoice = true;\r\n        },\r\n        handleSubmit() {\r\n            this.$refs['editExpressData'].validate(valid => {\r\n                if (valid) {\r\n                    updateExpress(this.editExpressData)\r\n                        .then(res => {\r\n                            if (res.data.data) {\r\n                                this.dialogVisibleExpress = false;\r\n                                this.getExpenseInfo();\r\n                            }\r\n                        })\r\n                        .finally(() => {});\r\n                }\r\n            });\r\n        },\r\n        handleSubmitInvoice() {\r\n            this.$refs['editInvoiceData'].validate(valid => {\r\n                if (valid) {\r\n                    updateExpress(this.editInvoiceData)\r\n                        .then(res => {\r\n                            if (res.data.data) {\r\n                                this.dialogVisibleInvoice = false;\r\n                                this.getExpenseInfo();\r\n                            }\r\n                        })\r\n                        .finally(() => {});\r\n                }\r\n            });\r\n        },\r\n        beforeAvatarUpload: function(file) {\r\n            const isJPG = file.type === 'image/jpeg';\r\n            const isPNG = file.type === 'image/png';\r\n            const isPG = isJPG || isPNG; //限制图片格式为jpg / png\r\n            const isLt5M = file.size / 1024 / 1024 < 5; //限制图片大小\r\n            if (!isPG) {\r\n                this.$message.error('图片只能是 JPG 或 PNG 格式!');\r\n            }\r\n            if (!isLt5M) {\r\n                this.$message.error('图片大小不能超过 5MB!');\r\n            }\r\n            return isPG && isLt5M;\r\n        },\r\n        handleRemove1(data) {\r\n            const imgInfo = data.response.data;\r\n            const imgUrl = imgInfo.bucketName + '-' + imgInfo.fileName;\r\n            this.editInvoiceData.invoiceImg = this.editInvoiceData.invoiceImg.replace(imgUrl + ',', '');\r\n            //console.log(this.editInvoiceData.invoiceImg)\r\n        },\r\n        handlePreview1(file) {\r\n            console.log(file);\r\n        },\r\n        handSuccess1(data) {\r\n            const imgInfo = data.data;\r\n            const imgUrl = imgInfo.bucketName + '-' + imgInfo.fileName;\r\n            this.editInvoiceData.invoiceImg += imgUrl + ',';\r\n            //console.log(this.editInvoiceData.invoiceImg)\r\n        },\r\n        handleModalAffirm(data) {\r\n            //console.log(data)\r\n            if (data.expenseId) {\r\n                this.$confirm('确认收到发票了吗?', '提示', {\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    const editData = {\r\n                        expenseId: data.expenseId,\r\n                        isAffirm: '1'\r\n                    };\r\n                    affirmExpense(editData).then(res => {\r\n                        if (res.data.data) {\r\n                            this.getExpenseInfo();\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\ntable {\r\n    margin-top: 20px;\r\n    color: #1f2d3d;\r\n    width: 100%;\r\n    border-right: 1px solid #c8cbce;\r\n    border-bottom: 1px solid #c8cbce;\r\n}\r\ntable td {\r\n    padding: 10px 0;\r\n    border-left: 1px solid #c8cbce;\r\n    border-top: 1px solid #c8cbce;\r\n}\r\n.el-tag {\r\n    line-height: 16px;\r\n    height: auto;\r\n}\r\n.el-image {\r\n    width: 100px;\r\n}\r\n.back {\r\n    margin-top: 10px;\r\n}\r\n.title {\r\n    text-align: center;\r\n}\r\n.name {\r\n    font-size: 21px;\r\n    color: #1f2d3d;\r\n    padding: 10px 0 5px 0;\r\n}\r\n.time {\r\n    font-size: 16px;\r\n    color: #9d9e61;\r\n    padding: 10px 0;\r\n}\r\n/*.result:first-child{*/\r\n/*    margin-top: 50px;*/\r\n/*}*/\r\n.result {\r\n    max-width: 800px;\r\n    height: 100px;\r\n    border: 1px solid #f1f3f4;\r\n    margin-bottom: 10px;\r\n}\r\n.avatar {\r\n    margin-top: 20px;\r\n    margin-left: 20px;\r\n    margin-right: 20px;\r\n    height: 45px;\r\n    width: 45px;\r\n}\r\n.username {\r\n    margin-top: 22px;\r\n    position: absolute;\r\n}\r\n.res {\r\n    max-width: 800px;\r\n    height: 200px;\r\n    border: 1px solid #f1f3f4;\r\n    padding: 10px;\r\n}\r\n.submit {\r\n    float: right;\r\n    margin-top: -10px;\r\n}\r\n.checkSty {\r\n    float: right;\r\n    right: 10px;\r\n    margin-top: -60px;\r\n    position: relative;\r\n    line-height: 32px;\r\n    height: 32px;\r\n}\r\n</style>\n"],"sourceRoot":"src/views/apply/expense"}]}