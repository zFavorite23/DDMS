{"remainingRequest":"D:\\DDMS\\node_modules\\thread-loader\\dist\\cjs.js!D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js!D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\project\\Total.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\project\\Total.vue","mtime":1588235430075},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { adList, adSave, adDelete } from \"../../api/ad/ad\";\nimport Upload from \"../../components/File/Upload.vue\";\nvar formJson = {\n  ad_id: \"\",\n  title: \"\",\n  describe: \"\",\n  pic: \"\",\n  pic_url: \"\",\n  jump_type: \"\",\n  jump_url: \"\",\n  ios_url: \"\",\n  android_url: \"\",\n  wxa_appid: \"\",\n  channel_type: 0,\n  channel_list: [],\n  android_version_type: 0,\n  android_version_list: [],\n  ios_version_type: 0,\n  ios_version_list: [],\n  new_show_start_num: 0,\n  new_show_max_num: 0,\n  old_show_start_num: 0,\n  old_show_max_num: 0,\n  end_time: \"\",\n  event_name: \"\",\n  status: 1\n};\nexport default {\n  data: function data() {\n    return {\n      query: {\n        title: \"\",\n        page: 1,\n        limit: 20\n      },\n      channelListInput: \"\",\n      androidVersionListInput: \"\",\n      iosVersionListInput: \"\",\n      list: [],\n      total: 0,\n      loading: true,\n      index: null,\n      formName: null,\n      formMap: {\n        add: \"新增\",\n        edit: \"编辑\"\n      },\n      formLoading: false,\n      formVisible: false,\n      formData: formJson,\n      formRules: {\n        title: [{\n          required: true,\n          message: \"请输入广告标题\",\n          trigger: \"blur\"\n        }],\n        pic: [{\n          required: true,\n          message: \"请选择封面图片\",\n          trigger: \"change\"\n        }],\n        jump_type: [{\n          required: true,\n          message: \"请选择跳转方式\",\n          trigger: \"change\"\n        }],\n        jump_url: [{\n          required: true,\n          message: \"请输入跳转链接\",\n          trigger: \"blur\"\n        }],\n        android_url: [{\n          required: true,\n          message: \"请输入Android类名\",\n          trigger: \"blur\"\n        }],\n        ios_url: [{\n          required: true,\n          message: \"请输入IOS类名\",\n          trigger: \"blur\"\n        }],\n        wxa_appid: [{\n          required: true,\n          message: \"请输入小程序Appid\",\n          trigger: \"blur\"\n        }],\n        channel_list: [{\n          required: true,\n          message: \"请输入至少一个渠道名单\",\n          trigger: \"change\"\n        }],\n        android_version_list: [{\n          required: true,\n          message: \"请输入至少一个Android版本名单\",\n          trigger: \"change\"\n        }],\n        ios_version_list: [{\n          required: true,\n          message: \"请输入至少一个iOS版本名单\",\n          trigger: \"change\"\n        }],\n        status: [{\n          required: true,\n          message: \"请选择状态\",\n          trigger: \"change\"\n        }]\n      },\n      deleteLoading: false\n    };\n  },\n  components: {\n    Upload: Upload\n  },\n  methods: {\n    onReset: function onReset() {\n      this.$router.push({\n        path: \"\"\n      });\n      this.query = {\n        title: \"\",\n        page: 1,\n        limit: 20\n      };\n      this.getList();\n    },\n    onSubmit: function onSubmit() {\n      this.$router.push({\n        path: \"\",\n        query: this.query\n      });\n      this.getList();\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.query.limit = val;\n      this.getList();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.query.page = val;\n      this.getList();\n    },\n    getList: function getList() {\n      var _this = this;\n\n      this.loading = true;\n      adList(this.query).then(function (response) {\n        _this.loading = false;\n        _this.list = response.data.List || [];\n        _this.total = response.data.total || 0;\n      }).catch(function () {\n        _this.loading = false;\n        _this.list = [];\n        _this.total = 0;\n      });\n    },\n    // 删除渠道\n    handleChannelListClose: function handleChannelListClose(index) {\n      console.log(index); // 更改值\n\n      this.formData.channel_list.splice(index, 1);\n    },\n    // 添加渠道白名单\n    handleChannelListSubmit: function handleChannelListSubmit() {\n      // 更改值\n      if (this.channelListInput && this.formData.channel_list.length < 15) {\n        var arr = this.channelListInput.split(\",\");\n\n        for (var i in arr) {\n          if (arr[i] !== \"\" && (this.formData.channel_list.length === 0 || this.formData.channel_list.indexOf(arr[i]) < 0)) {\n            this.formData.channel_list.push(arr[i]);\n          }\n        }\n\n        this.channelListInput = \"\";\n        this.$refs.channelListRef.focus();\n      }\n    },\n    // 删除Android版本\n    handleAndroidVersionListClose: function handleAndroidVersionListClose(index) {\n      // 更改值\n      this.formData.android_version_list.splice(index, 1);\n    },\n    // 添加Android版本\n    handleAndroidVersionListSubmit: function handleAndroidVersionListSubmit() {\n      // 更改值\n      if (this.androidVersionListInput && this.formData.android_version_list.length < 15) {\n        var arr = this.androidVersionListInput.split(\",\");\n\n        for (var i in arr) {\n          var avList = this.formData.android_version_list;\n\n          if (arr[i] !== \"\" && (avList.length === 0 || avList.indexOf(arr[i]) < 0)) {\n            this.formData.android_version_list.push(arr[i]);\n          }\n        }\n\n        this.androidVersionListInput = \"\";\n        this.$refs.androidVersionListRef.focus();\n      }\n    },\n    // 删除Ios版本\n    handleIosVersionListClose: function handleIosVersionListClose(index) {\n      // 更改值\n      this.formData.ios_version_list.splice(index, 1);\n    },\n    // 添加Ios版本\n    handleIosVersionListSubmit: function handleIosVersionListSubmit() {\n      // 更改值\n      if (this.iosVersionListInput && this.formData.ios_version_list.length < 15) {\n        var arr = this.iosVersionListInput.split(\",\");\n\n        for (var i in arr) {\n          if (arr[i] !== \"\" && (this.formData.ios_version_list.length === 0 || this.formData.ios_version_list.indexOf(arr[i]) < 0)) {\n            this.formData.ios_version_list.push(arr[i]);\n          }\n        }\n\n        this.iosVersionListInput = \"\";\n        this.$refs.iosVersionListRef.focus();\n      }\n    },\n    // 刷新表单\n    resetForm: function resetForm() {\n      if (this.$refs[\"dataForm\"]) {\n        // 清空字段\n        this.$refs[\"dataForm\"].resetFields(); // 清空验证信息表单\n\n        this.$refs[\"dataForm\"].clearValidate();\n      }\n    },\n    // 隐藏表单\n    hideForm: function hideForm() {\n      // 更改值\n      this.formVisible = !this.formVisible;\n      return true;\n    },\n    // 显示表单\n    handleForm: function handleForm(index, row) {\n      this.formVisible = true; // 刷新表单\n\n      this.resetForm();\n      this.formData = JSON.parse(JSON.stringify(formJson));\n\n      if (row !== null) {\n        this.formData = Object.assign({}, row);\n      }\n\n      this.formName = \"add\";\n\n      if (index !== null) {\n        this.index = index;\n        this.formName = \"edit\";\n      }\n    },\n    formSubmit: function formSubmit() {\n      var _this2 = this;\n\n      this.$refs[\"dataForm\"].validate(function (valid) {\n        if (valid) {\n          _this2.formLoading = true;\n          var data = Object.assign({}, _this2.formData);\n          adSave(data, _this2.formName).then(function (response) {\n            _this2.formLoading = false;\n\n            if (response.code) {\n              _this2.$message.error(response.message);\n\n              return false;\n            }\n\n            _this2.$message.success(\"操作成功\");\n\n            _this2.formVisible = false;\n\n            if (_this2.formName === \"add\") {\n              // 向头部添加数据\n              data.ad_id = response.data.ad_id;\n\n              _this2.list.unshift(data);\n            } else {\n              _this2.list.splice(_this2.index, 1, data);\n            }\n          }).catch(function () {\n            _this2.formLoading = false;\n          });\n        }\n      });\n    },\n    // 删除\n    handleDel: function handleDel(index, row) {\n      var _this3 = this;\n\n      if (row.ad_id) {\n        this.$confirm(\"确认删除该记录吗?\", \"提示\", {\n          type: \"warning\"\n        }).then(function () {\n          var para = {\n            ad_id: row.ad_id\n          };\n          _this3.deleteLoading = true;\n          adDelete(para).then(function (response) {\n            _this3.deleteLoading = false;\n\n            if (response.code) {\n              _this3.$message.error(response.message);\n\n              return false;\n            }\n\n            _this3.$message(\"删除成功\"); // 刷新数据\n\n\n            _this3.list.splice(index, 1);\n          }).catch(function () {\n            _this3.deleteLoading = false;\n          });\n        }).catch(function () {\n          _this3.$message.info(\"取消删除\");\n        });\n      }\n    },\n    onSelectPic: function onSelectPic(filePath, filePathUrl) {\n      this.formData.pic = filePath;\n      this.formData.pic_url = filePathUrl;\n    }\n  },\n  filters: {\n    statusFilterType: function statusFilterType(status) {\n      var statusMap = {\n        0: \"gray\",\n        1: \"success\"\n      };\n      return statusMap[status];\n    },\n    statusFilterName: function statusFilterName(status) {\n      var statusMap = {\n        0: \"禁用\",\n        1: \"正常\"\n      };\n      return statusMap[status];\n    }\n  },\n  mounted: function mounted() {},\n  created: function created() {\n    // 将参数拷贝进查询对象\n    var query = this.$route.query;\n    this.query = Object.assign(this.query, query);\n    this.query.limit = parseInt(this.query.limit); // 加载表格数据\n\n    this.getList();\n  }\n};",null]}