{"remainingRequest":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js!D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\apply\\clock\\Form.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\apply\\clock\\Form.vue","mtime":1591786451986},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _defineProperty from \"D:\\\\DDMS\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getApplyUserInfo } from \"../../../api/admin/user.js\";\nimport { getAbnormalSeven as _getAbnormalSeven, getClockInfo } from \"../../../api/checkwork/clock.js\";\nimport { addObj, editObj } from \"../../../api/apply/clock.js\";\nimport { getClockNum as _getClockNum } from \"../../../api/checkwork/month.js\";\nimport { getStandardApplyInfoById } from \"../../../api/standard/apply.js\";\nimport { mapGetters } from \"vuex\";\nexport default {\n  data: function data() {\n    return {\n      query: {\n        itemId: null,\n        userId: null,\n        deptId: null,\n        type: 5\n      },\n      queryClockNum: {\n        userId: null,\n        month: \"\"\n      },\n      formData: {\n        newData: true,\n        userId: \"\",\n        day: \"\",\n        time: \"\",\n        reason: \"\",\n        clockList: \"\",\n        approverids: \"\"\n      },\n      dayOptions: [// {\n        //     lable:\"2020-01-08\",\n        //     value:\"2020-01-08\"\n        // }\n      ],\n      saving: false,\n      clockNum: 0,\n      disabledDay: true,\n      rules: {\n        day: [{\n          required: true,\n          message: \"请选择未打卡日期\",\n          trigger: \"change\"\n        }],\n        time: [{\n          required: true,\n          message: \"请选择未打卡时间\",\n          trigger: \"change\"\n        }],\n        reason: [{\n          required: true,\n          message: \"请填写未打卡事由\"\n        }]\n      },\n      applyUserList: [],\n      applyClockInfo: \"\"\n    };\n  },\n  created: function created() {\n    this.getStandardApplyInfo();\n    this.getApplyUser(this.userId);\n    this.formData.userId = this.userId;\n    this.query.userId = this.userId;\n    this.queryClockNum.userId = this.userId;\n    this.getAbnormalSeven();\n    var editClockInfo = JSON.parse(window.localStorage.getItem(\"editClockInfo\"));\n\n    if (editClockInfo) {\n      this.formData.newData = false;\n      this.formData.clockId = editClockInfo.clockId;\n      this.formData.day = editClockInfo.day;\n      this.formData.time = editClockInfo.time;\n      this.formData.reason = editClockInfo.reason;\n      this.clockNum = 1;\n    } else {\n      this.disabledDay = false;\n      this.applyClockInfo = JSON.parse(window.localStorage.getItem(\"applyClockInfo\"));\n\n      if (this.applyClockInfo) {\n        this.formData.day = this.applyClockInfo.day;\n\n        if (this.applyClockInfo.type == 1) {\n          this.formData.time = \"09:30\";\n        }\n\n        if (this.applyClockInfo.type == 2) {\n          this.formData.time = \"18:30\";\n        }\n\n        this.formData.clockList = JSON.stringify(this.applyClockInfo);\n        this.queryClockNum.month = this.applyClockInfo.day.substring(0, 7);\n        this.getClockNum();\n      }\n    }\n  },\n  computed: _objectSpread({}, mapGetters([\"permissions\", \"userId\"])),\n  methods: {\n    getClockNum: function getClockNum() {\n      var _this = this;\n\n      if (this.formData.newData) {\n        _getClockNum(this.queryClockNum).then(function (response) {\n          if (response.data.data) {\n            _this.clockNum = response.data.data.clockNum;\n          }\n        });\n      }\n    },\n    selectClockDay: function selectClockDay(val) {\n      var _this2 = this;\n\n      getClockInfo(val).then(function (response) {\n        //console.log(response.data.data)\n        var clockInfo = response.data.data;\n\n        if (clockInfo.type == 1) {\n          _this2.formData.time = \"09:30\";\n        }\n\n        if (clockInfo.type == 2) {\n          _this2.formData.time = \"18:30\";\n        }\n\n        _this2.formData.day = clockInfo.day;\n        _this2.formData.clockList = JSON.stringify(clockInfo);\n        _this2.queryClockNum.month = clockInfo.day.substring(0, 7);\n\n        _this2.getClockNum();\n      });\n    },\n    getAbnormalSeven: function getAbnormalSeven() {\n      var _this3 = this;\n\n      _getAbnormalSeven(this.query.userId).then(function (response) {\n        response.data.data.forEach(function (element) {\n          if (element.type == 1) {\n            _this3.dayOptions.push({\n              value: element.clockId,\n              label: element.day + \"  上班卡\"\n            });\n          } else if (element.type == 2) {\n            _this3.dayOptions.push({\n              value: element.clockId,\n              label: element.day + \"  下班卡\"\n            });\n          }\n        });\n      });\n    },\n    getApplyUser: function getApplyUser() {\n      var _this4 = this;\n\n      getApplyUserInfo(this.query).then(function (response) {\n        var applyUser = response.data.data;\n\n        _this4.applyUserList.push({\n          userId: applyUser.userId,\n          username: applyUser.username,\n          avatar: applyUser.avatar\n        });\n\n        _this4.formData.approverids = applyUser.userId;\n      });\n    },\n    backHistory: function backHistory() {\n      window.localStorage.removeItem(\"editClockInfo\");\n      window.localStorage.removeItem(\"applyClockInfo\");\n      this.formData.newData = true;\n      this.formData.clockId = null;\n      this.formData.day = \"\";\n      this.formData.time = \"\";\n      this.formData.reason = \"\";\n      this.clockNum = 0;\n      this.$router.go(-1);\n    },\n    onSubmit: function onSubmit() {\n      var _this5 = this;\n\n      this.$refs[\"formData\"].validate(function (valid) {\n        if (valid) {\n          _this5.saving = true;\n\n          if (!_this5.formData.newData) {\n            editObj(_this5.formData).then(function (res) {\n              if (res.data.data) {\n                _this5.backHistory();\n              }\n            }).finally(function () {\n              _this5.saving = false;\n            });\n          } else {\n            addObj(_this5.formData).then(function (res) {\n              if (res.data.data) {\n                _this5.backHistory();\n              }\n            }).finally(function () {\n              _this5.saving = false;\n            });\n          }\n        }\n      });\n    },\n    getStandardApplyInfo: function getStandardApplyInfo() {\n      var _this6 = this;\n\n      getStandardApplyInfoById(5).then(function (response) {\n        console.log(response);\n\n        if (response.data.data) {\n          var data = response.data.data;\n          _this6.content = data.content;\n          var clockStandardApply = JSON.parse(window.localStorage.getItem(\"clockStandardApply\"));\n\n          if (clockStandardApply) {\n            if (clockStandardApply.version < data.version) {\n              _this6.open();\n            }\n          } else {\n            _this6.open();\n          }\n\n          window.localStorage.setItem(\"clockStandardApply\", JSON.stringify(data));\n        }\n      });\n    },\n    open: function open() {\n      var content = this.content.split(\"\\n\\n\");\n      var newDatas = [];\n      var h = this.$createElement;\n\n      for (var i in content) {\n        newDatas.push(h(\"p\", null, content[i]));\n      }\n\n      this.$alert(h(\"div\", null, newDatas), \"未打卡规范\");\n    }\n  },\n  mounted: function mounted() {}\n};",{"version":3,"sources":["Form.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <el-form\r\n            label-position=\"right\"\r\n            :model=\"formData\"\r\n            :rules=\"rules\"\r\n            ref=\"formData\"\r\n            class=\"form\"\r\n            label-width=\"135px\"\r\n        >\r\n            <el-form-item label=\"未打卡日期：\" prop=\"day\">\r\n                <el-select\r\n                    v-model=\"formData.day\"\r\n                    :disabled=\"disabledDay\"\r\n                    placeholder=\"请选择未打卡日期\"\r\n                    @change=\"selectClockDay\"\r\n                >\r\n                    <el-option\r\n                        v-for=\"(item, index) in dayOptions\"\r\n                        :value=\"item.value\"\r\n                        :key=\"index\"\r\n                        :label=\"item.label\"\r\n                    >\r\n                    </el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"未打卡时间：\" prop=\"time\">\r\n                <el-time-select\r\n                    v-model=\"formData.time\"\r\n                    :picker-options=\"{\r\n                        start: '07:00',\r\n                        step: '00:30',\r\n                        end: '23:30'\r\n                    }\"\r\n                    placeholder=\"选择时间：\"\r\n                >\r\n                </el-time-select>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"未打卡事由：\" prop=\"reason\">\r\n                <el-input\r\n                    type=\"textarea\"\r\n                    v-model=\"formData.reason\"\r\n                    placeholder=\"请输入未打卡事由\"\r\n                    maxlength=\"30\"\r\n                    show-word-limit\r\n                ></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"审批人：\">\r\n                <div class=\"apply-user-list\" v-for=\"user in applyUserList\">\r\n                    <el-avatar :size=\"60\" :src=\"user.avatar\"></el-avatar>\r\n                    <span class=\"username\">{{ user.username }}</span>\r\n                </div>\r\n            </el-form-item>\r\n            <div\r\n                style=\"color: #1f2d3d;margin-left: 30%;padding: 10px 0;\"\r\n                v-if=\"formData.day\"\r\n            >\r\n                你本月还有<span style=\"color: #a94442\"> {{ clockNum }} </span\r\n                >次未打卡申请次数\r\n            </div>\r\n            <el-form-item style=\"text-align: center\" class=\"save\">\r\n                <el-button v-if=\"clockNum <= 0\" type=\"info\" disabled=\"disabled\"\r\n                    >保存</el-button\r\n                >\r\n                <el-button\r\n                    v-else\r\n                    type=\"primary\"\r\n                    @click=\"onSubmit\"\r\n                    :loading=\"saving\"\r\n                    >保存</el-button\r\n                >\r\n                <el-button @click=\"backHistory\">取消</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n        <el-button type=\"primary\" class=\"invoiceRules\" @click=\"open\"\r\n            >未打卡规范</el-button\r\n        >\r\n    </div>\r\n</template>\r\n<script>\r\nimport { getApplyUserInfo } from \"../../../api/admin/user.js\";\r\nimport {\r\n    getAbnormalSeven,\r\n    getClockInfo\r\n} from \"../../../api/checkwork/clock.js\";\r\nimport { addObj, editObj } from \"../../../api/apply/clock.js\";\r\nimport { getClockNum } from \"../../../api/checkwork/month.js\";\r\nimport { getStandardApplyInfoById } from \"../../../api/standard/apply.js\";\r\nimport { mapGetters } from \"vuex\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            query: {\r\n                itemId: null,\r\n                userId: null,\r\n                deptId: null,\r\n                type: 5\r\n            },\r\n            queryClockNum: {\r\n                userId: null,\r\n                month: \"\"\r\n            },\r\n            formData: {\r\n                newData: true,\r\n                userId: \"\",\r\n                day: \"\",\r\n                time: \"\",\r\n                reason: \"\",\r\n                clockList: \"\",\r\n                approverids: \"\"\r\n            },\r\n            dayOptions: [\r\n                // {\r\n                //     lable:\"2020-01-08\",\r\n                //     value:\"2020-01-08\"\r\n                // }\r\n            ],\r\n            saving: false,\r\n            clockNum: 0,\r\n            disabledDay: true,\r\n            rules: {\r\n                day: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请选择未打卡日期\",\r\n                        trigger: \"change\"\r\n                    }\r\n                ],\r\n                time: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请选择未打卡时间\",\r\n                        trigger: \"change\"\r\n                    }\r\n                ],\r\n                reason: [{ required: true, message: \"请填写未打卡事由\" }]\r\n            },\r\n            applyUserList: [],\r\n            applyClockInfo: \"\"\r\n        };\r\n    },\r\n    created() {\r\n        this.getStandardApplyInfo();\r\n        this.getApplyUser(this.userId);\r\n        this.formData.userId = this.userId;\r\n        this.query.userId = this.userId;\r\n        this.queryClockNum.userId = this.userId;\r\n        this.getAbnormalSeven();\r\n\r\n        const editClockInfo = JSON.parse(\r\n            window.localStorage.getItem(\"editClockInfo\")\r\n        );\r\n        if (editClockInfo) {\r\n            this.formData.newData = false;\r\n            this.formData.clockId = editClockInfo.clockId;\r\n            this.formData.day = editClockInfo.day;\r\n            this.formData.time = editClockInfo.time;\r\n            this.formData.reason = editClockInfo.reason;\r\n            this.clockNum = 1;\r\n        } else {\r\n            this.disabledDay = false;\r\n            this.applyClockInfo = JSON.parse(\r\n                window.localStorage.getItem(\"applyClockInfo\")\r\n            );\r\n            if (this.applyClockInfo) {\r\n                this.formData.day = this.applyClockInfo.day;\r\n                if (this.applyClockInfo.type == 1) {\r\n                    this.formData.time = \"09:30\";\r\n                }\r\n                if (this.applyClockInfo.type == 2) {\r\n                    this.formData.time = \"18:30\";\r\n                }\r\n                this.formData.clockList = JSON.stringify(this.applyClockInfo);\r\n\r\n                this.queryClockNum.month = this.applyClockInfo.day.substring(\r\n                    0,\r\n                    7\r\n                );\r\n                this.getClockNum();\r\n            }\r\n        }\r\n    },\r\n    computed: {\r\n        ...mapGetters([\"permissions\", \"userId\"])\r\n    },\r\n    methods: {\r\n        getClockNum() {\r\n            if (this.formData.newData) {\r\n                getClockNum(this.queryClockNum).then(response => {\r\n                    if (response.data.data) {\r\n                        this.clockNum = response.data.data.clockNum;\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        selectClockDay(val) {\r\n            getClockInfo(val).then(response => {\r\n                //console.log(response.data.data)\r\n                const clockInfo = response.data.data;\r\n                if (clockInfo.type == 1) {\r\n                    this.formData.time = \"09:30\";\r\n                }\r\n                if (clockInfo.type == 2) {\r\n                    this.formData.time = \"18:30\";\r\n                }\r\n\r\n                this.formData.day = clockInfo.day;\r\n                this.formData.clockList = JSON.stringify(clockInfo);\r\n                this.queryClockNum.month = clockInfo.day.substring(0, 7);\r\n                this.getClockNum();\r\n            });\r\n        },\r\n        getAbnormalSeven() {\r\n            getAbnormalSeven(this.query.userId).then(response => {\r\n                response.data.data.forEach(element => {\r\n                    if (element.type == 1) {\r\n                        this.dayOptions.push({\r\n                            value: element.clockId,\r\n                            label: element.day + \"  上班卡\"\r\n                        });\r\n                    } else if (element.type == 2) {\r\n                        this.dayOptions.push({\r\n                            value: element.clockId,\r\n                            label: element.day + \"  下班卡\"\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        },\r\n        getApplyUser() {\r\n            getApplyUserInfo(this.query).then(response => {\r\n                const applyUser = response.data.data;\r\n                this.applyUserList.push({\r\n                    userId: applyUser.userId,\r\n                    username: applyUser.username,\r\n                    avatar: applyUser.avatar\r\n                });\r\n                this.formData.approverids = applyUser.userId;\r\n            });\r\n        },\r\n        backHistory() {\r\n            window.localStorage.removeItem(\"editClockInfo\");\r\n            window.localStorage.removeItem(\"applyClockInfo\");\r\n            this.formData.newData = true;\r\n            this.formData.clockId = null;\r\n            this.formData.day = \"\";\r\n            this.formData.time = \"\";\r\n            this.formData.reason = \"\";\r\n            this.clockNum = 0;\r\n            this.$router.go(-1);\r\n        },\r\n        onSubmit() {\r\n            this.$refs[\"formData\"].validate(valid => {\r\n                if (valid) {\r\n                    this.saving = true;\r\n                    if (!this.formData.newData) {\r\n                        editObj(this.formData)\r\n                            .then(res => {\r\n                                if (res.data.data) {\r\n                                    this.backHistory();\r\n                                }\r\n                            })\r\n                            .finally(() => {\r\n                                this.saving = false;\r\n                            });\r\n                    } else {\r\n                        addObj(this.formData)\r\n                            .then(res => {\r\n                                if (res.data.data) {\r\n                                    this.backHistory();\r\n                                }\r\n                            })\r\n                            .finally(() => {\r\n                                this.saving = false;\r\n                            });\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        getStandardApplyInfo() {\r\n            getStandardApplyInfoById(5).then(response => {\n                console.log(response)\r\n                if (response.data.data) {\r\n                    const data = response.data.data;\r\n                    this.content = data.content;\r\n                    const clockStandardApply = JSON.parse(\r\n                        window.localStorage.getItem(\"clockStandardApply\")\r\n                    );\r\n                    if (clockStandardApply) {\r\n                        if (clockStandardApply.version < data.version) {\r\n                            this.open();\r\n                        }\r\n                    } else {\r\n                        this.open();\r\n                    }\r\n                    window.localStorage.setItem(\r\n                        \"clockStandardApply\",\r\n                        JSON.stringify(data)\r\n                    );\r\n                }\r\n            });\r\n        },\r\n        open() {\r\n            let content = this.content.split(\"\\n\\n\");\r\n            let newDatas = [];\r\n            const h = this.$createElement;\r\n            for (let i in content) {\r\n                newDatas.push(h(\"p\", null, content[i]));\r\n            }\r\n            this.$alert(h(\"div\", null, newDatas), \"未打卡规范\");\r\n        }\r\n    },\r\n    mounted() {}\r\n};\r\n</script>\r\n<style type=\"text/scss\" scoped lang=\"scss\">\r\n.el-input .el-input__count .el-input__count-inner {\r\n    height: 50%;\r\n}\r\n.el-image img {\r\n    border-radius: 50%;\r\n}\r\n@media screen and (min-width: 1300px) {\r\n    .el-input {\r\n        width: 300%;\r\n    }\r\n    .el-textarea {\r\n        width: 400% !important;\r\n    }\r\n}\r\n@media screen and (max-width: 320px) {\r\n    .el-input {\r\n        width: 85% !important;\r\n    }\r\n    .save {\r\n        margin-left: -45%;\r\n    }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/apply/clock"}]}