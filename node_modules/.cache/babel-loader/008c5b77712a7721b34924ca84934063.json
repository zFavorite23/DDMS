{"remainingRequest":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js!D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\admin\\User.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\admin\\User.vue","mtime":1594003835232},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _defineProperty from \"D:\\\\DDMS\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getPageList, addUser, updateUser, deleteUser } from \"../../api/admin/user.js\";\nimport { getTree } from \"../../api/admin/dept.js\";\nimport { deptRoleList } from \"../../api/other/role.js\";\nimport { mapGetters } from \"vuex\";\nexport default {\n  data: function data() {\n    var _this = this;\n\n    return {\n      circleUrl: \"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png\",\n      query: {\n        username: \"\",\n        deptId: \"\",\n        current: 1,\n        size: 10\n      },\n      pages: 0,\n      total: 0,\n      defaultImg: \"\",\n      deptOptions: [],\n      rolesOptions: [],\n      pickerOptions: {\n        disabledDate: function disabledDate(time) {\n          return _this.dealDisabledDate(time);\n        }\n      },\n      dialogTitle: \"\",\n      listLoading: false,\n      dialogVisible: false,\n      saving: false,\n      list: [],\n      user_btn_add: false,\n      user_btn_edit: false,\n      user_btn_del: false,\n      formData: {\n        newData: true,\n        userId: \"\",\n        companyId: \"\",\n        username: \"\",\n        password: \"\",\n        deptId: \"\",\n        sex: 0,\n        phone: \"\",\n        role: \"\",\n        joinedTime: \"\",\n        lockFlag: 0\n      },\n      rules: {\n        username: [{\n          required: true,\n          message: \"请输入姓名\",\n          trigger: \"blur\"\n        }],\n        deptId: [{\n          required: true,\n          message: \"请选择部门\",\n          trigger: \"change\"\n        }],\n        sex: [{\n          required: true,\n          message: \"请选择性别\",\n          trigger: \"blur\"\n        }],\n        phone: [{\n          required: true,\n          message: \"请输入手机号\",\n          trigger: \"blur\"\n        }],\n        role: [{\n          required: true,\n          message: \"请选择角色\",\n          trigger: \"change\"\n        }],\n        joinedTime: [{\n          required: true,\n          message: \"请选择入职日期\",\n          trigger: \"blur\"\n        }],\n        lockFlag: [{\n          required: true,\n          message: \"请选择\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.getDeptList();\n    this.getRolelist();\n    this.getUserList();\n    this.user_btn_add = this.permissions[\"sys_user_add\"];\n    this.user_btn_edit = this.permissions[\"sys_user_edit\"];\n    this.user_btn_del = this.permissions[\"sys_user_del\"];\n  },\n  computed: _objectSpread({}, mapGetters([\"permissions\"])),\n  methods: {\n    getDeptList: function getDeptList() {\n      var _this2 = this;\n\n      getTree().then(function (response) {\n        response.data.data.forEach(function (element) {\n          element.children.forEach(function (dept) {\n            _this2.deptOptions.push({\n              value: dept.id,\n              label: element.name + \"-\" + dept.name\n            });\n          });\n        });\n      });\n    },\n    getRolelist: function getRolelist() {\n      var _this3 = this;\n\n      deptRoleList().then(function (response) {\n        _this3.rolesOptions = response.data.data;\n      });\n    },\n    getUserList: function getUserList() {\n      var _this4 = this;\n\n      this.loading = true;\n      getPageList(this.query).then(function (response) {\n        _this4.loading = false;\n        console.log(response.data.data);\n        _this4.total = response.data.data.total;\n        _this4.query.current = response.data.data.current;\n        _this4.query.size = response.data.data.size;\n        _this4.list = response.data.data.records;\n      }).catch(function () {\n        _this4.loading = false;\n      });\n    },\n    handleModal: function handleModal(data) {\n      if (this.formData.phone.indexOf(\"*\") > 0) {\n        this.formData.phone = undefined;\n      }\n\n      console.log(data);\n\n      if (data) {\n        this.dialogTitle = \"编辑员工 - \" + data.username;\n        this.formData.newData = false;\n        this.formData.userId = data.userId;\n        this.formData.companyId = data.companyId;\n        this.formData.username = data.username;\n        this.formData.password = \"\";\n        this.formData.deptId = data.deptId;\n        this.formData.sex = Number(data.sex);\n        this.formData.phone = data.phone;\n        this.formData.role = [];\n\n        for (var i = 0; i < data.roleList.length; i++) {\n          this.formData.role[i] = data.roleList[i].roleId;\n        }\n\n        this.formData.joinedTime = data.joinedTime;\n        this.formData.lockFlag = Number(data.lockFlag);\n      } else {\n        this.dialogTitle = \"添加员工\";\n        this.formData.newData = true;\n        this.formData.userId = \"\";\n        this.formData.companyId = \"\";\n        this.formData.username = \"\";\n        this.formData.password = \"\";\n        this.formData.deptId = \"\";\n        this.formData.sex = 0;\n        this.formData.phone = \"\";\n        this.formData.role = [];\n        this.formData.joinedTime = \"2019-12-01\";\n        this.formData.lockFlag = 0;\n      }\n\n      this.dialogVisible = true;\n    },\n    // 单独处理时间的函数\n    dealDisabledDate: function dealDisabledDate(time) {\n      return time.getTime() >= Date.now();\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.query.size = val;\n      this.getUserList();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.query.current = val;\n      this.getUserList();\n    },\n    formatSex: function formatSex(row) {\n      return row.sex == 0 ? \"男\" : row.sex == 1 ? \"女\" : \"未知\";\n    },\n    selsChange: function selsChange(sels) {\n      this.sels = sels;\n    },\n    handleSubmit: function handleSubmit() {\n      var _this5 = this;\n\n      this.$refs[\"formData\"].validate(function (valid) {\n        if (valid) {\n          _this5.saving = true;\n\n          if (!_this5.formData.newData) {\n            console.log(_this5.formData);\n\n            if (_this5.formData.phone.indexOf(\"*\") != -1) {\n              _this5.formData.phone = \"\";\n            }\n\n            updateUser(_this5.formData).then(function (res) {\n              if (res.data.data) {\n                _this5.dialogVisible = false;\n\n                _this5.getUserList();\n              }\n            }).finally(function () {\n              _this5.saving = false;\n            });\n          } else {\n            addUser(_this5.formData).then(function (res) {\n              if (res.data.data) {\n                _this5.dialogVisible = false;\n\n                _this5.getUserList();\n              }\n            }).finally(function () {\n              _this5.saving = false;\n            });\n          }\n        }\n      });\n    },\n    // 删除\n    handleDel: function handleDel(index, row) {\n      var _this6 = this;\n\n      if (row.userId) {\n        this.$confirm(\"确认删除 \" + row.username + \" 吗?\", \"提示\", {\n          type: \"warning\"\n        }).then(function () {\n          deleteUser(row.userId).then(function (res) {\n            if (res.data.data) {\n              _this6.getUserList();\n            }\n          });\n        });\n      }\n    }\n  },\n  mounted: function mounted() {}\n};",{"version":3,"sources":["User.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div>\r\n        <div>\r\n            <span class=\"tit\">员工管理 / 总数 : {{ total }}</span>\r\n            <el-form :inline=\"true\" :model=\"query\">\r\n                <el-form-item>\r\n                    <el-input\r\n                        clearable\r\n                        v-model=\"query.username\"\r\n                        placeholder=\"关键字\"\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item>\r\n                    <el-select\r\n                        clearable\r\n                        v-model=\"query.deptId\"\r\n                        filterable\r\n                        placeholder=\"请选择\"\r\n                    >\r\n                        <el-option\r\n                            v-for=\"item in deptOptions\"\r\n                            :key=\"item.value\"\r\n                            :label=\"item.label\"\r\n                            :value=\"item.value\"\r\n                            :disabled=\"item.disabled\"\r\n                        >\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item>\r\n                    <el-button\r\n                        type=\"primary\"\r\n                        size=\"medium\"\r\n                        v-on:click=\"getUserList()\"\r\n                        icon=\"el-icon-search\"\r\n                        >搜索</el-button\r\n                    >\r\n                </el-form-item>\r\n                <el-form-item>\r\n                    <el-button\r\n                        type=\"primary\"\r\n                        size=\"medium\"\r\n                        @click=\"handleModal()\"\r\n                        v-if=\"user_btn_add\"\r\n                        >新增</el-button\r\n                    >\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n        <el-table\r\n            :data=\"list\"\r\n            stripe\r\n            border\r\n            v-loading=\"listLoading\"\r\n            style=\"width: 100%;\"\r\n        >\r\n            <el-table-column\r\n                scope=\"scope\"\r\n                min-width=\"120\"\r\n                label=\"头像\"\r\n                class=\"hidden-phone hidden-xs\"\r\n            >\r\n                <template slot-scope=\"scope\">\r\n                    <el-image :src=\"scope.row.avatar\" style=\"width: 3rem;\" />\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"username\"\r\n                min-width=\"120\"\r\n                label=\"姓名\"\r\n            ></el-table-column>\r\n            <el-table-column prop=\"companyId\" min-width=\"120\" label=\"公司\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-tag\r\n                        v-if=\"\r\n                            scope.row.companyId == '1' ||\r\n                                scope.row.companyId == null\r\n                        \"\r\n                        type=\"warning\"\r\n                        >未转正</el-tag\r\n                    >\r\n                    <el-tag v-if=\"scope.row.companyId == '2'\" type=\"success\"\r\n                        >甲板智慧</el-tag\r\n                    >\r\n                    <el-tag v-if=\"scope.row.companyId == '3'\" type=\"\"\r\n                        >甲板数字</el-tag\r\n                    >\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"deptName\"\r\n                min-width=\"120\"\r\n                label=\"部门\"\r\n                class=\"hidden-phone\"\r\n            ></el-table-column>\r\n            <el-table-column min-width=\"120\" label=\"角色\" class=\"hidden-phone\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-tag\r\n                        v-for=\"item in scope.row.roleList\"\r\n                        :key=\"item.label\"\r\n                        :type=\"item.type\"\r\n                    >\r\n                        {{ item.roleName }}\r\n                    </el-tag>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n                prop=\"sex\"\r\n                min-width=\"120\"\r\n                label=\"性别\"\r\n                :formatter=\"formatSex\"\r\n                class=\"hidden-phone hidden-xs\"\r\n            ></el-table-column>\r\n            <el-table-column\r\n                prop=\"phone\"\r\n                min-width=\"120\"\r\n                label=\"手机号\"\r\n            ></el-table-column>\r\n            <el-table-column label=\"操作\" min-width=\"160\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-button\r\n                        v-if=\"user_btn_edit\"\r\n                        size=\"mini\"\r\n                        @click.native=\"handleModal(scope.row)\"\r\n                        >编辑</el-button\r\n                    >\r\n                    <el-button\r\n                        v-if=\"user_btn_del\"\r\n                        size=\"mini\"\r\n                        type=\"danger\"\r\n                        @click.native=\"handleDel(scope.$index, scope.row)\"\r\n                        >删除</el-button\r\n                    >\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n        <el-pagination\r\n            class=\"right\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"query.current\"\r\n            :page-sizes=\"[10, 20, 50, 100]\"\r\n            :page-size=\"query.size\"\r\n            layout=\"total, sizes, prev, pager, next\"\r\n            :total=\"total\"\r\n        >\r\n        </el-pagination>\r\n\r\n        <!--编辑界面-->\r\n        <el-dialog\r\n            :title=\"dialogTitle\"\r\n            @click=\"dialogVisible = true\"\r\n            :visible.sync=\"dialogVisible\"\r\n            :width=\"'80%'\"\r\n        >\r\n            <el-form\r\n                label-width=\"80px\"\r\n                :model=\"formData\"\r\n                :rules=\"rules\"\r\n                ref=\"formData\"\r\n            >\r\n                <el-form-item label=\"姓名\" prop=\"username\">\r\n                    <el-input\r\n                        type=\"text\"\r\n                        placeholder=\"请输入姓名\"\r\n                        v-model=\"formData.username\"\r\n                        auto-complete=\"off\"\r\n                        maxlength=\"5\"\r\n                        show-word-limit\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"公司\" prop=\"companyId\">\r\n                    <el-radio-group v-model=\"formData.companyId\">\r\n                        <el-radio :label=\"1\">未转正</el-radio>\r\n                        <el-radio :label=\"2\">甲板智慧</el-radio>\r\n                        <el-radio :label=\"3\">甲板数字</el-radio>\r\n                    </el-radio-group>\r\n                </el-form-item>\r\n                <el-form-item label=\"手机号\" prop=\"phone\">\r\n                    <el-input\r\n                        type=\"text\"\r\n                        placeholder=\"请输入手机号\"\r\n                        v-model=\"formData.phone\"\r\n                        auto-complete=\"off\"\r\n                        maxlength=\"20\"\r\n                        show-word-limit\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"密码\">\r\n                    <el-input\r\n                        type=\"text\"\r\n                        placeholder=\"请输入密码\"\r\n                        v-model=\"formData.password\"\r\n                        auto-complete=\"off\"\r\n                        maxlength=\"11\"\r\n                        show-word-limit\r\n                    ></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"性别\" prop=\"sex\">\r\n                    <el-radio-group v-model=\"formData.sex\">\r\n                        <el-radio :label=\"0\">男</el-radio>\r\n                        <el-radio :label=\"1\">女</el-radio>\r\n                    </el-radio-group>\r\n                </el-form-item>\r\n                <el-form-item label=\"部门\" prop=\"deptId\">\r\n                    <el-select v-model=\"formData.deptId\" placeholder=\"请选择\">\r\n                        <el-option\r\n                            v-for=\"item in deptOptions\"\r\n                            :key=\"item.value\"\r\n                            :label=\"item.label\"\r\n                            :value=\"item.value\"\r\n                            :disabled=\"item.disabled\"\r\n                        >\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"权限\" prop=\"role\">\r\n                    <el-select\r\n                        v-model=\"formData.role\"\r\n                        multiple\r\n                        placeholder=\"请选择\"\r\n                    >\r\n                        <el-option\r\n                            v-for=\"item in rolesOptions\"\r\n                            :key=\"item.roleId\"\r\n                            :label=\"item.roleName\"\r\n                            :value=\"item.roleId\"\r\n                        >\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"入职日期\" prop=\"joinedTime\" class=\"data\">\r\n                    <el-date-picker\r\n                        v-model=\"formData.joinedTime\"\r\n                        :picker-options=\"pickerOptions\"\r\n                        value-format=\"yyyy-MM-dd\"\r\n                        type=\"date\"\r\n                        placeholder=\"选择日期\"\r\n                        style=\"width: 100%\"\r\n                    >\r\n                    </el-date-picker>\r\n                </el-form-item>\r\n                <el-form-item label=\"状态\" prop=\"lockFlag\">\r\n                    <el-radio-group v-model=\"formData.lockFlag\">\r\n                        <el-radio :label=\"0\">全职</el-radio>\r\n                        <el-radio :label=\"1\">非全职</el-radio>\r\n                        <el-radio :label=\"2\">休息</el-radio>\r\n                    </el-radio-group>\r\n                </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click.native=\"dialogVisible = false\"\r\n                    >取消</el-button\r\n                >\r\n                <el-button\r\n                    type=\"primary\"\r\n                    @click=\"handleSubmit\"\r\n                    :loading=\"saving\"\r\n                    >提交</el-button\r\n                >\r\n            </div>\r\n        </el-dialog>\r\n        <!--        <el-avatar :size=\"size\" :src=\"circleUrl\"></el-avatar>-->\r\n    </div>\r\n</template>\r\n<script>\r\nimport {\r\n    getPageList,\r\n    addUser,\r\n    updateUser,\r\n    deleteUser\r\n} from \"../../api/admin/user.js\";\r\nimport { getTree } from \"../../api/admin/dept.js\";\r\nimport { deptRoleList } from \"../../api/other/role.js\";\r\nimport { mapGetters } from \"vuex\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            circleUrl:\r\n                \"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png\",\r\n            query: {\r\n                username: \"\",\r\n                deptId: \"\",\r\n                current: 1,\r\n                size: 10\r\n            },\r\n            pages: 0,\r\n            total: 0,\r\n            defaultImg: \"\",\r\n            deptOptions: [],\r\n            rolesOptions: [],\r\n            pickerOptions: {\r\n                disabledDate: time => {\r\n                    return this.dealDisabledDate(time);\r\n                }\r\n            },\r\n            dialogTitle: \"\",\r\n            listLoading: false,\r\n            dialogVisible: false,\r\n            saving: false,\r\n            list: [],\r\n            user_btn_add: false,\r\n            user_btn_edit: false,\r\n            user_btn_del: false,\r\n            formData: {\r\n                newData: true,\r\n                userId: \"\",\r\n                companyId: \"\",\r\n                username: \"\",\r\n                password: \"\",\r\n                deptId: \"\",\r\n                sex: 0,\r\n                phone: \"\",\r\n                role: \"\",\r\n                joinedTime: \"\",\r\n                lockFlag: 0\r\n            },\r\n            rules: {\r\n                username: [\r\n                    { required: true, message: \"请输入姓名\", trigger: \"blur\" }\r\n                ],\r\n                deptId: [\r\n                    { required: true, message: \"请选择部门\", trigger: \"change\" }\r\n                ],\r\n                sex: [\r\n                    { required: true, message: \"请选择性别\", trigger: \"blur\" }\r\n                ],\r\n                phone: [\r\n                    { required: true, message: \"请输入手机号\", trigger: \"blur\" }\r\n                ],\r\n                role: [\r\n                    { required: true, message: \"请选择角色\", trigger: \"change\" }\r\n                ],\r\n                joinedTime: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请选择入职日期\",\r\n                        trigger: \"blur\"\r\n                    }\r\n                ],\r\n                lockFlag: [\r\n                    { required: true, message: \"请选择\", trigger: \"blur\" }\r\n                ],\r\n            }\r\n        };\r\n    },\r\n    created() {\r\n        this.getDeptList();\r\n        this.getRolelist();\r\n        this.getUserList();\r\n        this.user_btn_add = this.permissions[\"sys_user_add\"];\r\n        this.user_btn_edit = this.permissions[\"sys_user_edit\"];\r\n        this.user_btn_del = this.permissions[\"sys_user_del\"];\r\n    },\r\n    computed: {\r\n        ...mapGetters([\"permissions\"])\r\n    },\r\n    methods: {\r\n        getDeptList() {\r\n            getTree().then(response => {\r\n                response.data.data.forEach(element => {\r\n                    element.children.forEach(dept => {\r\n                        this.deptOptions.push({\r\n                            value: dept.id,\r\n                            label: element.name + \"-\" + dept.name\r\n                        });\r\n                    });\r\n                });\r\n            });\r\n        },\r\n        getRolelist() {\r\n            deptRoleList().then(response => {\r\n                this.rolesOptions = response.data.data;\r\n            });\r\n        },\r\n        getUserList() {\r\n            this.loading = true;\r\n            getPageList(this.query)\r\n                .then(response => {\r\n                    this.loading = false;\r\n                    console.log(response.data.data)\r\n                    this.total = response.data.data.total;\r\n                    this.query.current = response.data.data.current;\r\n                    this.query.size = response.data.data.size;\r\n                    this.list = response.data.data.records;\r\n                })\r\n                .catch(() => {\r\n                    this.loading = false;\r\n                });\r\n        },\r\n        handleModal(data) {\r\n            if (this.formData.phone.indexOf(\"*\") > 0) {\r\n                this.formData.phone = undefined;\r\n            }\r\n            console.log(data)\r\n            if (data) {\r\n                this.dialogTitle = \"编辑员工 - \" + data.username;\r\n                this.formData.newData = false;\r\n                this.formData.userId = data.userId;\r\n                this.formData.companyId = data.companyId;\r\n                this.formData.username = data.username;\r\n                this.formData.password = \"\";\r\n                this.formData.deptId = data.deptId;\r\n                this.formData.sex = Number(data.sex);\r\n                this.formData.phone = data.phone;\r\n                this.formData.role = [];\r\n                for (var i = 0; i < data.roleList.length; i++) {\r\n                    this.formData.role[i] = data.roleList[i].roleId;\r\n                }\r\n                this.formData.joinedTime = data.joinedTime;\r\n                this.formData.lockFlag = Number(data.lockFlag);\r\n            } else {\r\n                this.dialogTitle = \"添加员工\";\r\n                this.formData.newData = true;\r\n                this.formData.userId = \"\";\r\n                this.formData.companyId = \"\";\r\n                this.formData.username = \"\";\r\n                this.formData.password = \"\";\r\n                this.formData.deptId = \"\";\r\n                this.formData.sex = 0;\r\n                this.formData.phone = \"\";\r\n                this.formData.role = [];\r\n                this.formData.joinedTime = \"2019-12-01\";\r\n                this.formData.lockFlag = 0;\r\n            }\r\n            this.dialogVisible = true;\r\n        },\r\n        // 单独处理时间的函数\r\n        dealDisabledDate(time) {\r\n            return time.getTime() >= Date.now();\r\n        },\r\n        handleSizeChange(val) {\r\n            this.query.size = val;\r\n            this.getUserList();\r\n        },\r\n        handleCurrentChange(val) {\r\n            this.query.current = val;\r\n            this.getUserList();\r\n        },\r\n        formatSex: function(row) {\r\n            return row.sex == 0 ? \"男\" : row.sex == 1 ? \"女\" : \"未知\";\r\n        },\r\n        selsChange: function(sels) {\r\n            this.sels = sels;\r\n        },\r\n        handleSubmit() {\r\n            this.$refs[\"formData\"].validate(valid => {\r\n                if (valid) {\r\n                    this.saving = true;\r\n                    if (!this.formData.newData) {\r\n                        console.log(this.formData);\r\n                        if (this.formData.phone.indexOf(\"*\") != -1) {\r\n                            this.formData.phone = \"\";\r\n                        }\r\n                        updateUser(this.formData)\r\n                            .then(res => {\r\n                                if (res.data.data) {\r\n                                    this.dialogVisible = false;\r\n                                    this.getUserList();\r\n                                }\r\n                            })\r\n                            .finally(() => {\r\n                                this.saving = false;\r\n                            });\r\n                    } else {\r\n                        addUser(this.formData)\r\n                            .then(res => {\r\n                                if (res.data.data) {\r\n                                    this.dialogVisible = false;\r\n                                    this.getUserList();\r\n                                }\r\n                            })\r\n                            .finally(() => {\r\n                                this.saving = false;\r\n                            });\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        // 删除\r\n        handleDel(index, row) {\r\n            if (row.userId) {\r\n                this.$confirm(\"确认删除 \" + row.username + \" 吗?\", \"提示\", {\r\n                    type: \"warning\"\r\n                }).then(() => {\r\n                    deleteUser(row.userId).then(res => {\r\n                        if (res.data.data) {\r\n                            this.getUserList();\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    },\r\n    mounted() {}\r\n};\r\n</script>\r\n<style type=\"text/scss\" lang=\"scss\" scoped>\r\n.el-input .el-input__count .el-input__count-inner {\r\n    height: 50%;\r\n}\r\n@media (min-width: 600px) {\r\n    .zzz {\r\n        display: none;\r\n    }\r\n}\r\n.el-image img {\r\n    border-radius: 50%;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views/admin"}]}