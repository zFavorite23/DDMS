{"remainingRequest":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js!D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\apply\\manhour\\Approver.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\apply\\manhour\\Approver.vue","mtime":1591971949556},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _defineProperty from \"D:\\\\DDMS\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getManhourApproverPage as _getManhourApproverPage, updateManhourApprover as _updateManhourApprover, updateManhourApproverAll } from \"../../../api/apply/manhour.js\"; // import {getUserInfo} from \"../../../api/admin/user.js\";\n\nimport { mapGetters } from 'vuex';\nexport default {\n  data: function data() {\n    return {\n      show: '',\n      query: {\n        userId: null,\n        status: '',\n        current: 1,\n        size: 10\n      },\n      pages: 0,\n      total: 0,\n      listLoading: false,\n      list: [],\n      number: '',\n      listType: '2'\n    };\n  },\n  created: function created() {\n    window.localStorage.removeItem('editManhourInfo');\n    this.query.status = this.$route.query.status;\n\n    if (!this.query.status) {\n      this.query.status = '';\n    }\n\n    this.query.userId = this.userId;\n    this.getManhourApproverPage();\n  },\n  computed: _objectSpread({}, mapGetters(['permissions', 'userId'])),\n  methods: {\n    getManhourApproverPage: function getManhourApproverPage() {\n      var _this = this;\n\n      this.listLoading = true;\n\n      _getManhourApproverPage(this.query).then(function (response) {\n        _this.listLoading = false;\n        _this.total = response.data.data.total;\n        _this.query.current = response.data.data.current;\n        _this.query.size = response.data.data.size;\n        _this.list = response.data.data.records;\n\n        _this.list.forEach(function (item) {\n          _this.$set(item, 'show', true);\n\n          if (item.checkMin == null || item.checkMin == 0) {\n            item.checkMin = item.useHour;\n          }\n\n          console.log(item);\n        });\n      }).catch(function () {\n        _this.listLoading = false;\n      });\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.query.size = val;\n      this.getManhourApproverPage();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.query.current = val;\n      this.getManhourApproverPage();\n    },\n    // 通过审批\n    updateManhourApprover: function updateManhourApprover(val) {\n      var _this2 = this;\n\n      if (this.list[val].checkMin == this.list[val].useHour - 2 || this.list[val].checkMin == 0) {\n        this.list[val].checkMin = this.list[val].useHour;\n      }\n\n      this.list[val].checkMin = parseFloat(this.list[val].checkMin);\n      this.$set(this.list[val], 'check', 1);\n      console.log(this.list[val]);\n\n      _updateManhourApprover(this.list[val]).then(function (res) {\n        console.log(res);\n\n        _this2.getManhourApproverPage();\n      });\n    },\n    //  不通过审批\n    okUpdate: function okUpdate(val) {\n      var _this3 = this;\n\n      this.list[val].show = false;\n\n      if (this.list[val].checkMin == this.list[val].useHour - 2 || this.list[val].checkMin == 0) {\n        this.list[val].checkMin = this.list[val].useHour;\n      }\n\n      this.list[val].checkMin = parseFloat(this.list[val].checkMin);\n      this.$set(this.list[val], 'check', 2);\n      console.log(this.list[val]);\n\n      _updateManhourApprover(this.list[val]).then(function (res) {\n        console.log(res);\n\n        _this3.getManhourApproverPage();\n      });\n    },\n    // 一键审批\n    updateManhourAll: function updateManhourAll() {\n      var _this4 = this;\n\n      var Newlist = this.list.filter(function (item) {\n        return item.status == 0;\n      });\n\n      for (var i = 0; i < Newlist.length; i++) {\n        if (Newlist[i].checkMin == Newlist[i].useHour - 2 || this.list[val].checkMin == 0) {\n          Newlist[i].checkMin = Newlist[i].useHour;\n        }\n      }\n\n      updateManhourApproverAll(Newlist).then(function (res) {\n        console.log(res);\n\n        _this4.getManhourApproverPage();\n\n        _this4.show = true;\n      });\n    },\n    //  合并\n    flitterData: function flitterData(arr) {\n      var spanOneArr = [],\n          spanTwoArr = [],\n          spanThreeArr = [],\n          concatOne = 0,\n          concatTwo = 0,\n          concatThree = 0;\n      arr.forEach(function (item, index) {\n        if (index === 0) {\n          spanOneArr.push(1);\n          spanTwoArr.push(1);\n          spanThreeArr.push(1);\n        } else {\n          if (item.day === arr[index - 1].day) {\n            //第一列需合并相同内容的判断条件\n            spanOneArr[concatOne] += 1;\n            spanOneArr.push(0);\n          } else {\n            spanOneArr.push(1);\n            concatOne = index;\n          }\n\n          if (item.day === arr[index - 1].day && item.integral === arr[index - 1].integral) {\n            //第二列需合并相同内容的判断条件\n            spanTwoArr[concatTwo] += 1;\n            spanTwoArr.push(0);\n          } else {\n            spanTwoArr.push(1);\n            concatTwo = index;\n          }\n        }\n      });\n      return {\n        one: spanOneArr,\n        two: spanTwoArr,\n        three: spanThreeArr\n      };\n    },\n    objectSpanMethod: function objectSpanMethod(_ref) {\n      var row = _ref.row,\n          column = _ref.column,\n          rowIndex = _ref.rowIndex,\n          columnIndex = _ref.columnIndex;\n\n      if (columnIndex === 0) {\n        var _row = this.flitterData(this.list).one[rowIndex];\n\n        var _col = _row > 0 ? 1 : 0;\n\n        return {\n          rowspan: _row,\n          colspan: _col\n        };\n      }\n\n      if (columnIndex === 1) {\n        var _row2 = this.flitterData(this.list).two[rowIndex];\n\n        var _col2 = _row2 > 0 ? 1 : 0;\n\n        return {\n          rowspan: _row2,\n          colspan: _col2\n        };\n      }\n    }\n  },\n  mounted: function mounted() {}\n};",{"version":3,"sources":["Approver.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmKA,SAAA,sBAAA,IAAA,uBAAA,EAAA,qBAAA,IAAA,sBAAA,EAAA,wBAAA,wC,CACA;;AACA,SAAA,UAAA,QAAA,MAAA;AACA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,IAAA,EAAA,EADA;AAEA,MAAA,KAAA,EAAA;AACA,QAAA,MAAA,EAAA,IADA;AAEA,QAAA,MAAA,EAAA,EAFA;AAGA,QAAA,OAAA,EAAA,CAHA;AAIA,QAAA,IAAA,EAAA;AAJA,OAFA;AAQA,MAAA,KAAA,EAAA,CARA;AASA,MAAA,KAAA,EAAA,CATA;AAUA,MAAA,WAAA,EAAA,KAVA;AAWA,MAAA,IAAA,EAAA,EAXA;AAYA,MAAA,MAAA,EAAA,EAZA;AAaA,MAAA,QAAA,EAAA;AAbA,KAAA;AAeA,GAjBA;AAkBA,EAAA,OAlBA,qBAkBA;AACA,IAAA,MAAA,CAAA,YAAA,CAAA,UAAA,CAAA,iBAAA;AACA,SAAA,KAAA,CAAA,MAAA,GAAA,KAAA,MAAA,CAAA,KAAA,CAAA,MAAA;;AACA,QAAA,CAAA,KAAA,KAAA,CAAA,MAAA,EAAA;AACA,WAAA,KAAA,CAAA,MAAA,GAAA,EAAA;AACA;;AACA,SAAA,KAAA,CAAA,MAAA,GAAA,KAAA,MAAA;AACA,SAAA,sBAAA;AACA,GA1BA;AA2BA,EAAA,QAAA,oBACA,UAAA,CAAA,CAAA,aAAA,EAAA,QAAA,CAAA,CADA,CA3BA;AA8BA,EAAA,OAAA,EAAA;AACA,IAAA,sBADA,oCACA;AAAA;;AACA,WAAA,WAAA,GAAA,IAAA;;AACA,MAAA,uBAAA,CAAA,KAAA,KAAA,CAAA,CACA,IADA,CACA,UAAA,QAAA,EAAA;AACA,QAAA,KAAA,CAAA,WAAA,GAAA,KAAA;AACA,QAAA,KAAA,CAAA,KAAA,GAAA,QAAA,CAAA,IAAA,CAAA,IAAA,CAAA,KAAA;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,OAAA,GAAA,QAAA,CAAA,IAAA,CAAA,IAAA,CAAA,OAAA;AACA,QAAA,KAAA,CAAA,KAAA,CAAA,IAAA,GAAA,QAAA,CAAA,IAAA,CAAA,IAAA,CAAA,IAAA;AACA,QAAA,KAAA,CAAA,IAAA,GAAA,QAAA,CAAA,IAAA,CAAA,IAAA,CAAA,OAAA;;AACA,QAAA,KAAA,CAAA,IAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,KAAA,CAAA,IAAA,CAAA,IAAA,EAAA,MAAA,EAAA,IAAA;;AACA,cAAA,IAAA,CAAA,QAAA,IAAA,IAAA,IAAA,IAAA,CAAA,QAAA,IAAA,CAAA,EAAA;AACA,YAAA,IAAA,CAAA,QAAA,GAAA,IAAA,CAAA,OAAA;AACA;;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,SANA;AAOA,OAdA,EAeA,KAfA,CAeA,YAAA;AACA,QAAA,KAAA,CAAA,WAAA,GAAA,KAAA;AACA,OAjBA;AAkBA,KArBA;AAsBA,IAAA,gBAtBA,4BAsBA,GAtBA,EAsBA;AACA,WAAA,KAAA,CAAA,IAAA,GAAA,GAAA;AACA,WAAA,sBAAA;AACA,KAzBA;AA0BA,IAAA,mBA1BA,+BA0BA,GA1BA,EA0BA;AACA,WAAA,KAAA,CAAA,OAAA,GAAA,GAAA;AACA,WAAA,sBAAA;AACA,KA7BA;AA+BA;AACA,IAAA,qBAhCA,iCAgCA,GAhCA,EAgCA;AAAA;;AACA,UAAA,KAAA,IAAA,CAAA,GAAA,EAAA,QAAA,IAAA,KAAA,IAAA,CAAA,GAAA,EAAA,OAAA,GAAA,CAAA,IAAA,KAAA,IAAA,CAAA,GAAA,EAAA,QAAA,IAAA,CAAA,EAAA;AACA,aAAA,IAAA,CAAA,GAAA,EAAA,QAAA,GAAA,KAAA,IAAA,CAAA,GAAA,EAAA,OAAA;AACA;;AACA,WAAA,IAAA,CAAA,GAAA,EAAA,QAAA,GAAA,UAAA,CAAA,KAAA,IAAA,CAAA,GAAA,EAAA,QAAA,CAAA;AACA,WAAA,IAAA,CAAA,KAAA,IAAA,CAAA,GAAA,CAAA,EAAA,OAAA,EAAA,CAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,IAAA,CAAA,GAAA,CAAA;;AACA,MAAA,sBAAA,CAAA,KAAA,IAAA,CAAA,GAAA,CAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;;AACA,QAAA,MAAA,CAAA,sBAAA;AACA,OAHA;AAIA,KA3CA;AA6CA;AACA,IAAA,QA9CA,oBA8CA,GA9CA,EA8CA;AAAA;;AACA,WAAA,IAAA,CAAA,GAAA,EAAA,IAAA,GAAA,KAAA;;AACA,UAAA,KAAA,IAAA,CAAA,GAAA,EAAA,QAAA,IAAA,KAAA,IAAA,CAAA,GAAA,EAAA,OAAA,GAAA,CAAA,IAAA,KAAA,IAAA,CAAA,GAAA,EAAA,QAAA,IAAA,CAAA,EAAA;AACA,aAAA,IAAA,CAAA,GAAA,EAAA,QAAA,GAAA,KAAA,IAAA,CAAA,GAAA,EAAA,OAAA;AACA;;AACA,WAAA,IAAA,CAAA,GAAA,EAAA,QAAA,GAAA,UAAA,CAAA,KAAA,IAAA,CAAA,GAAA,EAAA,QAAA,CAAA;AACA,WAAA,IAAA,CAAA,KAAA,IAAA,CAAA,GAAA,CAAA,EAAA,OAAA,EAAA,CAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,IAAA,CAAA,GAAA,CAAA;;AACA,MAAA,sBAAA,CAAA,KAAA,IAAA,CAAA,GAAA,CAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;;AACA,QAAA,MAAA,CAAA,sBAAA;AACA,OAHA;AAIA,KA1DA;AA4DA;AACA,IAAA,gBA7DA,8BA6DA;AAAA;;AACA,UAAA,OAAA,GAAA,KAAA,IAAA,CAAA,MAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,MAAA,IAAA,CAAA;AAAA,OAAA,CAAA;;AACA,WAAA,IAAA,CAAA,GAAA,CAAA,EAAA,CAAA,GAAA,OAAA,CAAA,MAAA,EAAA,CAAA,EAAA,EAAA;AACA,YAAA,OAAA,CAAA,CAAA,CAAA,CAAA,QAAA,IAAA,OAAA,CAAA,CAAA,CAAA,CAAA,OAAA,GAAA,CAAA,IAAA,KAAA,IAAA,CAAA,GAAA,EAAA,QAAA,IAAA,CAAA,EAAA;AACA,UAAA,OAAA,CAAA,CAAA,CAAA,CAAA,QAAA,GAAA,OAAA,CAAA,CAAA,CAAA,CAAA,OAAA;AACA;AACA;;AACA,MAAA,wBAAA,CAAA,OAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;;AACA,QAAA,MAAA,CAAA,sBAAA;;AACA,QAAA,MAAA,CAAA,IAAA,GAAA,IAAA;AACA,OAJA;AAKA,KAzEA;AA0EA;AACA,IAAA,WA3EA,uBA2EA,GA3EA,EA2EA;AACA,UAAA,UAAA,GAAA,EAAA;AAAA,UACA,UAAA,GAAA,EADA;AAAA,UAEA,YAAA,GAAA,EAFA;AAAA,UAGA,SAAA,GAAA,CAHA;AAAA,UAIA,SAAA,GAAA,CAJA;AAAA,UAKA,WAAA,GAAA,CALA;AAMA,MAAA,GAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA,KAAA,EAAA;AACA,YAAA,KAAA,KAAA,CAAA,EAAA;AACA,UAAA,UAAA,CAAA,IAAA,CAAA,CAAA;AACA,UAAA,UAAA,CAAA,IAAA,CAAA,CAAA;AACA,UAAA,YAAA,CAAA,IAAA,CAAA,CAAA;AACA,SAJA,MAIA;AACA,cAAA,IAAA,CAAA,GAAA,KAAA,GAAA,CAAA,KAAA,GAAA,CAAA,CAAA,CAAA,GAAA,EAAA;AACA;AACA,YAAA,UAAA,CAAA,SAAA,CAAA,IAAA,CAAA;AACA,YAAA,UAAA,CAAA,IAAA,CAAA,CAAA;AACA,WAJA,MAIA;AACA,YAAA,UAAA,CAAA,IAAA,CAAA,CAAA;AACA,YAAA,SAAA,GAAA,KAAA;AACA;;AACA,cAAA,IAAA,CAAA,GAAA,KAAA,GAAA,CAAA,KAAA,GAAA,CAAA,CAAA,CAAA,GAAA,IAAA,IAAA,CAAA,QAAA,KAAA,GAAA,CAAA,KAAA,GAAA,CAAA,CAAA,CAAA,QAAA,EAAA;AACA;AACA,YAAA,UAAA,CAAA,SAAA,CAAA,IAAA,CAAA;AACA,YAAA,UAAA,CAAA,IAAA,CAAA,CAAA;AACA,WAJA,MAIA;AACA,YAAA,UAAA,CAAA,IAAA,CAAA,CAAA;AACA,YAAA,SAAA,GAAA,KAAA;AACA;AACA;AACA,OAvBA;AAwBA,aAAA;AACA,QAAA,GAAA,EAAA,UADA;AAEA,QAAA,GAAA,EAAA,UAFA;AAGA,QAAA,KAAA,EAAA;AAHA,OAAA;AAKA,KA/GA;AAiHA,IAAA,gBAjHA,kCAiHA;AAAA,UAAA,GAAA,QAAA,GAAA;AAAA,UAAA,MAAA,QAAA,MAAA;AAAA,UAAA,QAAA,QAAA,QAAA;AAAA,UAAA,WAAA,QAAA,WAAA;;AACA,UAAA,WAAA,KAAA,CAAA,EAAA;AACA,YAAA,IAAA,GAAA,KAAA,WAAA,CAAA,KAAA,IAAA,EAAA,GAAA,CAAA,QAAA,CAAA;;AACA,YAAA,IAAA,GAAA,IAAA,GAAA,CAAA,GAAA,CAAA,GAAA,CAAA;;AACA,eAAA;AACA,UAAA,OAAA,EAAA,IADA;AAEA,UAAA,OAAA,EAAA;AAFA,SAAA;AAIA;;AACA,UAAA,WAAA,KAAA,CAAA,EAAA;AACA,YAAA,KAAA,GAAA,KAAA,WAAA,CAAA,KAAA,IAAA,EAAA,GAAA,CAAA,QAAA,CAAA;;AACA,YAAA,KAAA,GAAA,KAAA,GAAA,CAAA,GAAA,CAAA,GAAA,CAAA;;AACA,eAAA;AACA,UAAA,OAAA,EAAA,KADA;AAEA,UAAA,OAAA,EAAA;AAFA,SAAA;AAIA;AACA;AAlIA,GA9BA;AAkKA,EAAA,OAlKA,qBAkKA,CAAA;AAlKA,CAAA","sourcesContent":["<template>\r\n    <div>\r\n        <div style=\"display: flex; justify-content: space-between;margin-bottom: 1%;\">\r\n            <span class=\"tit\">工时审批 / 总数 : {{ total }}</span>\r\n            <!-- <el-button size=\"mini\" type=\"primary\" style=\"margin-right: 30px;\" @click=\"updateManhourAll\">一键通过</el-button> -->\r\n        </div>\r\n        <el-table :data=\"list\" :span-method=\"objectSpanMethod\" stripe border v-loading=\"listLoading\" style=\"width: 100%;\">\r\n            <el-table-column prop=\"day\" min-width=\"100\" label=\"申请日期\"></el-table-column>\r\n            <el-table-column label=\"自评积分\">\r\n                <template slot-scope=\"scope\">\r\n                    <span>{{ scope.row.integral }} 分</span>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column min-width=\"200\" label=\"项目\" :show-overflow-tooltip=\"true\">\r\n                <template slot-scope=\"scope\">\r\n                    <span v-if=\"scope.row.alias == null || scope.row.alias == ''\">与项目无关</span>\r\n                    <span v-else>{{ scope.row.alias }}</span>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"applyUserName\" min-width=\"80\" label=\"申请人\"></el-table-column>\r\n\r\n            <el-table-column min-width=\"80\" label=\"工作类别\">\r\n                <template slot-scope=\"scope\">\r\n                    <p v-if=\"scope.row.category == 1\">管理</p>\r\n                    <p v-else-if=\"scope.row.category == 2\">项目</p>\r\n                    <p v-else-if=\"scope.row.category == 3\">产品</p>\r\n                    <p v-else-if=\"scope.row.category == 4\">长身体</p>\r\n                    <p v-else></p>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"分类\" :show-overflow-tooltip=\"true\">\r\n                <template slot-scope=\"scope\">\r\n                    <p v-if=\"scope.row.category == '1' && scope.row.mainClassify == 1\">\r\n                        公司管理\r\n                        <br />\r\n                        <span v-if=\"scope.row.subClassify == 1\">公司战略规划</span>\r\n                        <span v-if=\"scope.row.subClassify == 2\">客户对接</span>\r\n                        <span v-if=\"scope.row.subClassify == 3\">项目对接</span>\r\n                        <span v-if=\"scope.row.subClassify == 4\">人员管理及招聘</span>\r\n                        <span v-if=\"scope.row.subClassify == 5\">其他事务</span>\r\n                    </p>\r\n                    <p v-if=\"scope.row.category == '1' && scope.row.mainClassify == 2\">\r\n                        财务管理\r\n                        <br />\r\n                        <span v-if=\"scope.row.subClassify == 1\">开票</span>\r\n                        <span v-if=\"scope.row.subClassify == 2\">支付</span>\r\n                        <span v-if=\"scope.row.subClassify == 3\">税筹</span>\r\n                        <span v-if=\"scope.row.subClassify == 4\">账务处理</span>\r\n                        <span v-if=\"scope.row.subClassify == 5\">预算</span>\r\n                        <span v-if=\"scope.row.subClassify == 6\">补贴申报</span>\r\n                        <span v-if=\"scope.row.subClassify == 7\">v</span>\r\n                    </p>\r\n                    <p v-if=\"scope.row.category == '1' && scope.row.mainClassify == 3\">\r\n                        人事管理\r\n                        <br />\r\n                        <span v-if=\"scope.row.subClassify == 1\">薪酬福利管理</span>\r\n                        <span v-if=\"scope.row.subClassify == 2\">考勤管理</span>\r\n                        <span v-if=\"scope.row.subClassify == 3\">员工入职手续办理</span>\r\n                        <span v-if=\"scope.row.subClassify == 4\">招聘</span>\r\n                        <span v-if=\"scope.row.subClassify == 5\">培训</span>\r\n                        <span v-if=\"scope.row.subClassify == 6\">员工关系管理</span>\r\n                        <span v-if=\"scope.row.subClassify == 7\">其他事务</span>\r\n                    </p>\r\n                    <p v-if=\"scope.row.category == '1' && scope.row.mainClassify == 4\">\r\n                        部门管理\r\n                        <br />\r\n                        <span v-if=\"scope.row.subClassify == 1\">人员招聘</span>\r\n                        <span v-if=\"scope.row.subClassify == 2\">人员管理及培训</span>\r\n                        <span v-if=\"scope.row.subClassify == 3\">部门发展计划</span>\r\n                        <span v-if=\"scope.row.subClassify == 4\">工作流程</span>\r\n                        <span v-if=\"scope.row.subClassify == 5\">其他日常事务</span>\r\n                    </p>\r\n                    <p v-if=\"scope.row.category == '1' && scope.row.mainClassify == 5\">\r\n                        工厂管理\r\n                        <br />\r\n                        <span v-if=\"scope.row.subClassify == 1\">工厂备料</span>\r\n                        <span v-if=\"scope.row.subClassify == 2\">环境卫生</span>\r\n                        <span v-if=\"scope.row.subClassify == 3\">房租水电</span>\r\n                        <span v-if=\"scope.row.subClassify == 4\">其他事务</span>\r\n                    </p>\r\n\r\n                    <p v-if=\"scope.row.category == '2'\">\r\n                        <span v-if=\"scope.row.subClassify == 1\">管理</span>\r\n                        <span v-if=\"scope.row.subClassify == 2\">销售</span>\r\n                        <span v-if=\"scope.row.subClassify == 3\">售前</span>\r\n                        <span v-if=\"scope.row.subClassify == 4\">交付</span>\r\n                        <span v-if=\"scope.row.subClassify == 5\">产品</span>\r\n                    </p>\r\n\r\n                    <p v-if=\"scope.row.category == '3'\">\r\n                        <span v-if=\"scope.row.subClassify == 1\">管理</span>\r\n                        <span v-if=\"scope.row.subClassify == 2\">交付</span>\r\n                    </p>\r\n\r\n                    <p v-if=\"scope.row.category == '4'\">\r\n                        <span v-if=\"scope.row.subClassify == 1\">学习</span>\r\n                        <span v-if=\"scope.row.subClassify == 2\">吃饭</span>\r\n                        <span v-if=\"scope.row.subClassify == 3\">睡觉</span>\r\n                    </p>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"reason\" min-width=\"150\" label=\"工作内容\" :show-overflow-tooltip=\"true\"></el-table-column>\r\n            <el-table-column label=\"工时\">\r\n                <template slot-scope=\"scope\">\r\n                    <span>{{ scope.row.useHour }} 小时</span>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column min-width=\"180\" label=\"审批工时\">\r\n                <template slot-scope=\"scope\">\r\n                    <!-- <p v-show=\"scope.row.show\" v-if=\"scope.row.status == 2 || scope.row.status == 1\">{{ scope.row.checkMin }} 小时</p>\r\n                    <p v-show=\"scope.row.show\" v-else>{{ scope.row.useHour }} 小时</p> -->\r\n                    <!-- v-show=\"!scope.row.show\" -->\r\n                    <el-input-number v-model=\"scope.row.checkMin\" controls-position=\"right\" size=\"mini\" step-strictly :step=\"0.5\" :max=\"10\" :min=\"0.0\"></el-input-number>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column min-width=\"100\" label=\"反馈意见\">\r\n                <template slot-scope=\"scope\">\r\n                    <p v-show=\"scope.row.show\">{{ scope.row.summary }}</p>\r\n                    <el-input v-show=\"!scope.row.show\" v-model=\"scope.row.summary\" size=\"mini\" placeholder=\"请输入内容\"></el-input>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column min-width=\"180\" label=\"完成进度\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-tag v-if=\"scope.row.complete == '100'\" type=\"success\">已完成</el-tag>\r\n                    <div v-else>\r\n                        <el-tag type=\"warning\">完成 {{ scope.row.complete }}%</el-tag>\r\n                        <el-tag type=\"warning\">预计{{ scope.row.completeTime }}完成</el-tag>\r\n                    </div>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" min-width=\"180\" fixed=\"right\">\r\n                <template slot-scope=\"scope\">\r\n                    <span v-if=\"scope.row.status == 0\">\r\n                        <span v-if=\"scope.row.show == true\">\r\n                            <el-button size=\"mini\" type=\"primary\" @click=\"updateManhourApprover(scope.$index)\">通过</el-button>\r\n                            <el-button size=\"mini\" type=\"primary\" @click=\"scope.row.show = false\">不通过</el-button>\r\n                        </span>\r\n                        <span v-if=\"scope.row.show == false\">\r\n                            <el-button size=\"mini\" type=\"primary\" @click=\"okUpdate(scope.$index)\">确定</el-button>\r\n                            <el-button size=\"mini\" type=\"primary\" @click=\"scope.row.show = true\">返回</el-button>\r\n                        </span>\r\n                    </span>\r\n\r\n                    <el-tag v-if=\"scope.row.status == 1 && scope.row.complete == '100'\" type=\"success\">同意</el-tag>\r\n                    <el-tag v-if=\"scope.row.status == 1 && scope.row.complete != '100'\" type=\"warning\">同意(未完成)</el-tag>\r\n                    <el-tag v-if=\"scope.row.status == 2\" type=\"danger\">已拒绝</el-tag>\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n\r\n        <el-pagination\r\n            class=\"right\"\r\n            @size-change=\"handleSizeChange\"\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"query.current\"\r\n            :page-sizes=\"[10, 20, 50, 100]\"\r\n            :page-size=\"query.size\"\r\n            layout=\"total, sizes, prev, pager, next\"\r\n            :total=\"total\"\r\n        ></el-pagination>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { getManhourApproverPage, updateManhourApprover, updateManhourApproverAll } from '../../../api/apply/manhour.js';\r\n// import {getUserInfo} from \"../../../api/admin/user.js\";\r\nimport { mapGetters } from 'vuex';\r\nexport default {\r\n    data() {\r\n        return {\r\n            show: '',\r\n            query: {\r\n                userId: null,\r\n                status: '',\r\n                current: 1,\r\n                size: 10\r\n            },\r\n            pages: 0,\r\n            total: 0,\r\n            listLoading: false,\r\n            list: [],\r\n            number: '',\r\n            listType: '2'\r\n        };\r\n    },\r\n    created() {\r\n        window.localStorage.removeItem('editManhourInfo');\r\n        this.query.status = this.$route.query.status;\r\n        if (!this.query.status) {\r\n            this.query.status = '';\r\n        }\r\n        this.query.userId = this.userId;\r\n        this.getManhourApproverPage();\r\n    },\r\n    computed: {\r\n        ...mapGetters(['permissions', 'userId'])\r\n    },\r\n    methods: {\r\n        getManhourApproverPage() {\r\n            this.listLoading = true;\r\n            getManhourApproverPage(this.query)\r\n                .then(response => {\r\n                    this.listLoading = false;\r\n                    this.total = response.data.data.total;\r\n                    this.query.current = response.data.data.current;\r\n                    this.query.size = response.data.data.size;\r\n                    this.list = response.data.data.records;\r\n                    this.list.forEach(item => {\r\n                        this.$set(item, 'show', true);\r\n                        if (item.checkMin == null || item.checkMin == 0) {\r\n                            item.checkMin = item.useHour;\r\n                        }\r\n                        console.log(item);\r\n                    });\r\n                })\r\n                .catch(() => {\r\n                    this.listLoading = false;\r\n                });\r\n        },\r\n        handleSizeChange(val) {\r\n            this.query.size = val;\r\n            this.getManhourApproverPage();\r\n        },\r\n        handleCurrentChange(val) {\r\n            this.query.current = val;\r\n            this.getManhourApproverPage();\r\n        },\r\n\r\n        // 通过审批\r\n        updateManhourApprover(val) {\r\n            if (this.list[val].checkMin == this.list[val].useHour - 2 || this.list[val].checkMin == 0) {\r\n                this.list[val].checkMin = this.list[val].useHour;\r\n            }\r\n            this.list[val].checkMin = parseFloat(this.list[val].checkMin);\r\n            this.$set(this.list[val], 'check', 1);\r\n            console.log(this.list[val]);\r\n            updateManhourApprover(this.list[val]).then(res => {\r\n                console.log(res);\r\n                this.getManhourApproverPage();\r\n            });\r\n        },\r\n\r\n        //  不通过审批\r\n        okUpdate(val) {\r\n            this.list[val].show = false;\r\n            if (this.list[val].checkMin == this.list[val].useHour - 2 || this.list[val].checkMin == 0) {\r\n                this.list[val].checkMin = this.list[val].useHour;\r\n            }\r\n            this.list[val].checkMin = parseFloat(this.list[val].checkMin);\r\n            this.$set(this.list[val], 'check', 2);\r\n            console.log(this.list[val]);\r\n            updateManhourApprover(this.list[val]).then(res => {\r\n                console.log(res);\r\n                this.getManhourApproverPage();\r\n            });\r\n        },\r\n\r\n        // 一键审批\r\n        updateManhourAll() {\r\n            var Newlist = this.list.filter(item => item.status == 0);\r\n            for (var i = 0; i < Newlist.length; i++) {\r\n                if (Newlist[i].checkMin == Newlist[i].useHour - 2 || this.list[val].checkMin == 0) {\r\n                    Newlist[i].checkMin = Newlist[i].useHour;\r\n                }\r\n            }\r\n            updateManhourApproverAll(Newlist).then(res => {\r\n                console.log(res);\r\n                this.getManhourApproverPage();\r\n                this.show = true;\r\n            });\r\n        },\r\n        //  合并\r\n        flitterData(arr) {\r\n            let spanOneArr = [],\r\n                spanTwoArr = [],\r\n                spanThreeArr = [],\r\n                concatOne = 0,\r\n                concatTwo = 0,\r\n                concatThree = 0;\r\n            arr.forEach((item, index) => {\r\n                if (index === 0) {\r\n                    spanOneArr.push(1);\r\n                    spanTwoArr.push(1);\r\n                    spanThreeArr.push(1);\r\n                } else {\r\n                    if (item.day === arr[index - 1].day) {\r\n                        //第一列需合并相同内容的判断条件\r\n                        spanOneArr[concatOne] += 1;\r\n                        spanOneArr.push(0);\r\n                    } else {\r\n                        spanOneArr.push(1);\r\n                        concatOne = index;\r\n                    }\r\n                    if (item.day === arr[index - 1].day && item.integral === arr[index - 1].integral) {\r\n                        //第二列需合并相同内容的判断条件\r\n                        spanTwoArr[concatTwo] += 1;\r\n                        spanTwoArr.push(0);\r\n                    } else {\r\n                        spanTwoArr.push(1);\r\n                        concatTwo = index;\r\n                    }\r\n                }\r\n            });\r\n            return {\r\n                one: spanOneArr,\r\n                two: spanTwoArr,\r\n                three: spanThreeArr\r\n            };\r\n        },\r\n\r\n        objectSpanMethod({ row, column, rowIndex, columnIndex }) {\r\n            if (columnIndex === 0) {\r\n                const _row = this.flitterData(this.list).one[rowIndex];\r\n                const _col = _row > 0 ? 1 : 0;\r\n                return {\r\n                    rowspan: _row,\r\n                    colspan: _col\r\n                };\r\n            }\r\n            if (columnIndex === 1) {\r\n                const _row = this.flitterData(this.list).two[rowIndex];\r\n                const _col = _row > 0 ? 1 : 0;\r\n                return {\r\n                    rowspan: _row,\r\n                    colspan: _col\r\n                };\r\n            }\r\n        }\r\n    },\r\n    mounted() {}\r\n};\r\n</script>\r\n<style type=\"text/scss\" lang=\"scss\"></style>\n"],"sourceRoot":"src/views/apply/manhour"}]}