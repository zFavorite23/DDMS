{"remainingRequest":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js!D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\apply\\invoice\\Info.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\apply\\invoice\\Info.vue","mtime":1598348529786},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _defineProperty from \"D:\\\\DDMS\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getInvoiceInfo as _getInvoiceInfo, affirmInvoice, getInvoiceApproverList as _getInvoiceApproverList, updateInvoiceApprover, getInvoiceRefuse as _getInvoiceRefuse } from \"../../../api/apply/invoice.js\";\nimport { print as _print } from \"../../../utils/utils\";\nimport { mapGetters } from 'vuex';\nimport ElImageViewer from 'element-ui/packages/image/src/image-viewer';\nimport moment from 'moment';\nexport default {\n  components: {\n    ElImageViewer: ElImageViewer\n  },\n  data: function data() {\n    return {\n      month: '',\n      formData: {\n        approverId: null,\n        checkUserId: null,\n        check: '1',\n        summary: '同意'\n      },\n      invoiceInfo: {\n        applyUserName: '',\n        invoiceTime: ''\n      },\n      invoiceId: null,\n      createTime: null,\n      listLoading: false,\n      list: [],\n      approverList: [],\n      rules: {\n        summary: [{\n          required: true,\n          message: '请填写原因'\n        }]\n      },\n      previewTime: '',\n      previewList: [],\n      checkUser1: '',\n      checkUser2: '',\n      checkUser3: '',\n      applyUser: '',\n      showCheck: false,\n      saving: false,\n      url: '',\n      urls1: [],\n      urls2: [],\n      showViewer: false,\n      // 显示查看器\n      RefuseInfo: []\n    };\n  },\n  computed: _objectSpread({}, mapGetters(['permissions', 'userId', 'deptId'])),\n  created: function created() {\n    this.invoiceId = this.$route.params.invoiceId;\n    this.formData.checkUserId = this.userId;\n    this.getInvoiceInfo();\n    this.getInvoiceRefuse(); // window.addEventListener('beforeunload', e => this.beforeunloadFn(e))\n  },\n  methods: {\n    getInvoiceRefuse: function getInvoiceRefuse() {\n      var _this = this;\n\n      _getInvoiceRefuse(this.invoiceId).then(function (res) {\n        console.log(res);\n        _this.RefuseInfo = res.data.data;\n      });\n    },\n    getInvoiceInfo: function getInvoiceInfo() {\n      var _this2 = this;\n\n      _getInvoiceInfo(this.invoiceId).then(function (response) {\n        _this2.invoiceInfo = response.data.data;\n        console.log(_this2.invoiceInfo);\n        _this2.invoiceInfo.invoiceTimeCh = moment(_this2.invoiceInfo.invoiceTime).format('YYYY年MM月DD日');\n        _this2.invoiceInfo.payTimeCh = moment(_this2.invoiceInfo.payTime).format('YYYY年MM月DD日');\n        _this2.urls1 = [];\n        _this2.urls2 = [];\n\n        if (_this2.invoiceInfo.payImg) {\n          _this2.invoiceInfo.payImg.split(',').forEach(function (item, index) {\n            if (item) {\n              _this2.urls1.push(\"\".concat(window.location.origin, \"/apply/invoice/\") + item);\n            }\n          });\n        }\n\n        if (_this2.invoiceInfo.invoiceImg) {\n          _this2.invoiceInfo.invoiceImg.split(',').forEach(function (item, index) {\n            if (item) {\n              _this2.urls2.push(\"\".concat(window.location.origin, \"/apply/invoice/\") + item);\n            }\n          });\n        }\n\n        if (_this2.invoiceInfo.type1 == 22 || _this2.invoiceInfo.type1 == 10) {\n          _this2.checkUser1 = '王铮';\n          _this2.checkUser3 = '王海清';\n          _this2.applyUser = '李长霖';\n        } else {\n          _this2.applyUser = _this2.invoiceInfo.applyUserName;\n        }\n\n        _this2.getInvoiceApproverList();\n      });\n    },\n    getInvoiceApproverList: function getInvoiceApproverList() {\n      var _this3 = this;\n\n      _getInvoiceApproverList(this.invoiceId).then(function (response) {\n        // console.log(response);\n        _this3.approverList = response.data.data;\n\n        _this3.approverList.forEach(function (item, index) {\n          if (item.check == 0 && item.isBeing == 1 && item.userId == _this3.formData.checkUserId) {\n            _this3.formData.approverId = item.approverId;\n            _this3.showCheck = true;\n          }\n        });\n\n        if (_this3.invoiceInfo.status == 1) {\n          if (_this3.approverList.length == 2) {\n            _this3.checkUser1 = _this3.approverList[0].checkUserName;\n            _this3.checkUser3 = _this3.approverList[1].checkUserName;\n          }\n\n          if (_this3.approverList.length == 3) {\n            _this3.checkUser1 = _this3.approverList[0].checkUserName;\n            _this3.checkUser2 = _this3.approverList[1].checkUserName;\n            _this3.checkUser3 = _this3.approverList[2].checkUserName;\n          }\n        }\n      });\n    },\n    selectChcek: function selectChcek() {\n      if (this.formData.check == 1) {\n        this.formData.summary = '同意';\n      } else {\n        this.formData.summary = '';\n      }\n    },\n    onSubmit: function onSubmit() {\n      var _this4 = this;\n\n      this.$confirm('请审批人审核发票信息、报销内容、项目名称后再同意，一经同意后流程不能逆转。', '温馨提示：', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning',\n        showClose: false\n      }).then(function () {\n        updateInvoiceApprover(_this4.formData).then(function (res) {\n          // console.log(res);\n          if (res.data.data) {\n            _this4.backHistory();\n          }\n        }).finally(function () {\n          _this4.saving = false;\n        });\n      }).catch(function () {\n        _this4.saving = false;\n      }); // console.log(this.formData);\n    },\n    backHistory: function backHistory() {\n      this.$router.go(-1);\n    },\n    onPreview1: function onPreview1(index) {\n      // this.url = this.urls1[val];\n      // this.showViewer = true;\n      var arr = [];\n      var i = 0;\n\n      for (i; i < this.urls1.length; i++) {\n        arr.push(this.urls1[i + index]);\n\n        if (i + index >= this.urls1.length - 1) {\n          index = 0 - (i + 1);\n        }\n      }\n\n      return arr;\n    },\n    closeViewer: function closeViewer() {\n      this.showViewer = false;\n      this.url = '';\n    },\n    onPreview2: function onPreview2(index) {\n      // this.url = this.urls2[val];\n      // this.showViewer = true;\n      var arr = [];\n      var i = 0;\n\n      for (i; i < this.urls2.length; i++) {\n        arr.push(this.urls2[i + index]);\n\n        if (i + index >= this.urls2.length - 1) {\n          index = 0 - (i + 1);\n        }\n      }\n\n      return arr;\n    },\n    print: function print(e) {\n      // this.remove();\n      // let subOutputRankPrint = document.getElementById('printContent');\n      // let newContent =subOutputRankPrint.innerHTML;\n      // let oldContent = document.body.innerHTML;\n      // document.body.innerHTML = newContent;\n      // window.print();\n      // // window.location.reload();\n      // document.body.innerHTML = oldContent;\n      // return false;\n      this.remove();\n\n      var windows = _print(document.getElementById('printContent').innerHTML);\n\n      windows.close();\n    },\n    remove: function remove() {\n      document.getElementById('line').style.display = 'block';\n      document.getElementById('cont').style.display = 'block';\n      var hkey_path;\n      hkey_path = 'HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\PageSetup\\\\';\n\n      try {\n        var RegWsh = new ActiveXObject('WScript.Shell');\n        RegWsh.RegWrite(hkey_path + 'header', '');\n        RegWsh.RegWrite(hkey_path + 'footer', '');\n      } catch (e) {}\n    },\n    handleModalAffirm: function handleModalAffirm(data) {\n      var _this5 = this;\n\n      //console.log(data)\n      if (data.invoiceId) {\n        this.$confirm('确认收到发票了吗?', '提示', {\n          type: 'warning'\n        }).then(function () {\n          var editData = {\n            invoiceId: data.invoiceId,\n            isAffirm: '1',\n            backMonth: _this5.month\n          };\n          console.log(_this5.month);\n          affirmInvoice(editData).then(function (res) {\n            if (res.data.data) {\n              _this5.getInvoiceInfo();\n            }\n          });\n        });\n      }\n    }\n  },\n  mounted: function mounted() {\n    // window.addEventListener('beforeunload', e => this.beforeunloadFn(e))\n    var date = new Date();\n    var year = date.getFullYear();\n    var month = date.getMonth() + 1;\n    month = month > 9 ? month : '0' + month;\n    var toMonth = year + '-' + month;\n    this.month = toMonth;\n  }\n};",{"version":3,"sources":["Info.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiRA,SAAA,cAAA,IAAA,eAAA,EAAA,aAAA,EAAA,sBAAA,IAAA,uBAAA,EAAA,qBAAA,EAAA,gBAAA,IAAA,iBAAA;AACA,SAAA,KAAA,IAAA,MAAA;AACA,SAAA,UAAA,QAAA,MAAA;AAEA,OAAA,aAAA,MAAA,4CAAA;AACA,OAAA,MAAA,MAAA,QAAA;AACA,eAAA;AACA,EAAA,UAAA,EAAA;AAAA,IAAA,aAAA,EAAA;AAAA,GADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,QAAA,EAAA;AACA,QAAA,UAAA,EAAA,IADA;AAEA,QAAA,WAAA,EAAA,IAFA;AAGA,QAAA,KAAA,EAAA,GAHA;AAIA,QAAA,OAAA,EAAA;AAJA,OAFA;AAQA,MAAA,WAAA,EAAA;AACA,QAAA,aAAA,EAAA,EADA;AAEA,QAAA,WAAA,EAAA;AAFA,OARA;AAYA,MAAA,SAAA,EAAA,IAZA;AAaA,MAAA,UAAA,EAAA,IAbA;AAcA,MAAA,WAAA,EAAA,KAdA;AAeA,MAAA,IAAA,EAAA,EAfA;AAgBA,MAAA,YAAA,EAAA,EAhBA;AAiBA,MAAA,KAAA,EAAA;AACA,QAAA,OAAA,EAAA,CAAA;AAAA,UAAA,QAAA,EAAA,IAAA;AAAA,UAAA,OAAA,EAAA;AAAA,SAAA;AADA,OAjBA;AAoBA,MAAA,WAAA,EAAA,EApBA;AAqBA,MAAA,WAAA,EAAA,EArBA;AAsBA,MAAA,UAAA,EAAA,EAtBA;AAuBA,MAAA,UAAA,EAAA,EAvBA;AAwBA,MAAA,UAAA,EAAA,EAxBA;AAyBA,MAAA,SAAA,EAAA,EAzBA;AA0BA,MAAA,SAAA,EAAA,KA1BA;AA2BA,MAAA,MAAA,EAAA,KA3BA;AA4BA,MAAA,GAAA,EAAA,EA5BA;AA6BA,MAAA,KAAA,EAAA,EA7BA;AA8BA,MAAA,KAAA,EAAA,EA9BA;AA+BA,MAAA,UAAA,EAAA,KA/BA;AA+BA;AACA,MAAA,UAAA,EAAA;AAhCA,KAAA;AAkCA,GArCA;AAsCA,EAAA,QAAA,oBACA,UAAA,CAAA,CAAA,aAAA,EAAA,QAAA,EAAA,QAAA,CAAA,CADA,CAtCA;AAyCA,EAAA,OAzCA,qBAyCA;AACA,SAAA,SAAA,GAAA,KAAA,MAAA,CAAA,MAAA,CAAA,SAAA;AACA,SAAA,QAAA,CAAA,WAAA,GAAA,KAAA,MAAA;AACA,SAAA,cAAA;AACA,SAAA,gBAAA,GAJA,CAKA;AACA,GA/CA;AAgDA,EAAA,OAAA,EAAA;AACA,IAAA,gBADA,8BACA;AAAA;;AACA,MAAA,iBAAA,CAAA,KAAA,SAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,QAAA,KAAA,CAAA,UAAA,GAAA,GAAA,CAAA,IAAA,CAAA,IAAA;AACA,OAHA;AAIA,KANA;AAOA,IAAA,cAPA,4BAOA;AAAA;;AACA,MAAA,eAAA,CAAA,KAAA,SAAA,CAAA,CAAA,IAAA,CAAA,UAAA,QAAA,EAAA;AACA,QAAA,MAAA,CAAA,WAAA,GAAA,QAAA,CAAA,IAAA,CAAA,IAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,WAAA;AACA,QAAA,MAAA,CAAA,WAAA,CAAA,aAAA,GAAA,MAAA,CAAA,MAAA,CAAA,WAAA,CAAA,WAAA,CAAA,CAAA,MAAA,CAAA,aAAA,CAAA;AACA,QAAA,MAAA,CAAA,WAAA,CAAA,SAAA,GAAA,MAAA,CAAA,MAAA,CAAA,WAAA,CAAA,OAAA,CAAA,CAAA,MAAA,CAAA,aAAA,CAAA;AACA,QAAA,MAAA,CAAA,KAAA,GAAA,EAAA;AACA,QAAA,MAAA,CAAA,KAAA,GAAA,EAAA;;AACA,YAAA,MAAA,CAAA,WAAA,CAAA,MAAA,EAAA;AACA,UAAA,MAAA,CAAA,WAAA,CAAA,MAAA,CAAA,KAAA,CAAA,GAAA,EAAA,OAAA,CAAA,UAAA,IAAA,EAAA,KAAA,EAAA;AACA,gBAAA,IAAA,EAAA;AACA,cAAA,MAAA,CAAA,KAAA,CAAA,IAAA,CAAA,UAAA,MAAA,CAAA,QAAA,CAAA,MAAA,uBAAA,IAAA;AACA;AACA,WAJA;AAKA;;AACA,YAAA,MAAA,CAAA,WAAA,CAAA,UAAA,EAAA;AACA,UAAA,MAAA,CAAA,WAAA,CAAA,UAAA,CAAA,KAAA,CAAA,GAAA,EAAA,OAAA,CAAA,UAAA,IAAA,EAAA,KAAA,EAAA;AACA,gBAAA,IAAA,EAAA;AACA,cAAA,MAAA,CAAA,KAAA,CAAA,IAAA,CAAA,UAAA,MAAA,CAAA,QAAA,CAAA,MAAA,uBAAA,IAAA;AACA;AACA,WAJA;AAKA;;AAEA,YAAA,MAAA,CAAA,WAAA,CAAA,KAAA,IAAA,EAAA,IAAA,MAAA,CAAA,WAAA,CAAA,KAAA,IAAA,EAAA,EAAA;AACA,UAAA,MAAA,CAAA,UAAA,GAAA,IAAA;AACA,UAAA,MAAA,CAAA,UAAA,GAAA,KAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,KAAA;AACA,SAJA,MAIA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,MAAA,CAAA,WAAA,CAAA,aAAA;AACA;;AAEA,QAAA,MAAA,CAAA,sBAAA;AACA,OA/BA;AAgCA,KAxCA;AAyCA,IAAA,sBAzCA,oCAyCA;AAAA;;AACA,MAAA,uBAAA,CAAA,KAAA,SAAA,CAAA,CAAA,IAAA,CAAA,UAAA,QAAA,EAAA;AACA;AACA,QAAA,MAAA,CAAA,YAAA,GAAA,QAAA,CAAA,IAAA,CAAA,IAAA;;AACA,QAAA,MAAA,CAAA,YAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA,KAAA,EAAA;AACA,cAAA,IAAA,CAAA,KAAA,IAAA,CAAA,IAAA,IAAA,CAAA,OAAA,IAAA,CAAA,IAAA,IAAA,CAAA,MAAA,IAAA,MAAA,CAAA,QAAA,CAAA,WAAA,EAAA;AACA,YAAA,MAAA,CAAA,QAAA,CAAA,UAAA,GAAA,IAAA,CAAA,UAAA;AACA,YAAA,MAAA,CAAA,SAAA,GAAA,IAAA;AACA;AACA,SALA;;AAMA,YAAA,MAAA,CAAA,WAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,cAAA,MAAA,CAAA,YAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,YAAA,MAAA,CAAA,UAAA,GAAA,MAAA,CAAA,YAAA,CAAA,CAAA,EAAA,aAAA;AACA,YAAA,MAAA,CAAA,UAAA,GAAA,MAAA,CAAA,YAAA,CAAA,CAAA,EAAA,aAAA;AACA;;AACA,cAAA,MAAA,CAAA,YAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,YAAA,MAAA,CAAA,UAAA,GAAA,MAAA,CAAA,YAAA,CAAA,CAAA,EAAA,aAAA;AACA,YAAA,MAAA,CAAA,UAAA,GAAA,MAAA,CAAA,YAAA,CAAA,CAAA,EAAA,aAAA;AACA,YAAA,MAAA,CAAA,UAAA,GAAA,MAAA,CAAA,YAAA,CAAA,CAAA,EAAA,aAAA;AACA;AACA;AACA,OApBA;AAqBA,KA/DA;AAgEA,IAAA,WAhEA,yBAgEA;AACA,UAAA,KAAA,QAAA,CAAA,KAAA,IAAA,CAAA,EAAA;AACA,aAAA,QAAA,CAAA,OAAA,GAAA,IAAA;AACA,OAFA,MAEA;AACA,aAAA,QAAA,CAAA,OAAA,GAAA,EAAA;AACA;AACA,KAtEA;AAuEA,IAAA,QAvEA,sBAuEA;AAAA;;AACA,WAAA,QAAA,CAAA,uCAAA,EAAA,OAAA,EAAA;AACA,QAAA,iBAAA,EAAA,IADA;AAEA,QAAA,gBAAA,EAAA,IAFA;AAGA,QAAA,IAAA,EAAA,SAHA;AAIA,QAAA,SAAA,EAAA;AAJA,OAAA,EAMA,IANA,CAMA,YAAA;AACA,QAAA,qBAAA,CAAA,MAAA,CAAA,QAAA,CAAA,CACA,IADA,CACA,UAAA,GAAA,EAAA;AACA;AACA,cAAA,GAAA,CAAA,IAAA,CAAA,IAAA,EAAA;AACA,YAAA,MAAA,CAAA,WAAA;AACA;AACA,SANA,EAOA,OAPA,CAOA,YAAA;AACA,UAAA,MAAA,CAAA,MAAA,GAAA,KAAA;AACA,SATA;AAUA,OAjBA,EAkBA,KAlBA,CAkBA,YAAA;AACA,QAAA,MAAA,CAAA,MAAA,GAAA,KAAA;AACA,OApBA,EADA,CAuBA;AACA,KA/FA;AAgGA,IAAA,WAhGA,yBAgGA;AACA,WAAA,OAAA,CAAA,EAAA,CAAA,CAAA,CAAA;AACA,KAlGA;AAmGA,IAAA,UAnGA,sBAmGA,KAnGA,EAmGA;AACA;AACA;AACA,UAAA,GAAA,GAAA,EAAA;AACA,UAAA,CAAA,GAAA,CAAA;;AACA,WAAA,CAAA,EAAA,CAAA,GAAA,KAAA,KAAA,CAAA,MAAA,EAAA,CAAA,EAAA,EAAA;AACA,QAAA,GAAA,CAAA,IAAA,CAAA,KAAA,KAAA,CAAA,CAAA,GAAA,KAAA,CAAA;;AACA,YAAA,CAAA,GAAA,KAAA,IAAA,KAAA,KAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,UAAA,KAAA,GAAA,KAAA,CAAA,GAAA,CAAA,CAAA;AACA;AACA;;AACA,aAAA,GAAA;AACA,KA/GA;AAgHA,IAAA,WAhHA,yBAgHA;AACA,WAAA,UAAA,GAAA,KAAA;AACA,WAAA,GAAA,GAAA,EAAA;AACA,KAnHA;AAoHA,IAAA,UApHA,sBAoHA,KApHA,EAoHA;AACA;AACA;AACA,UAAA,GAAA,GAAA,EAAA;AACA,UAAA,CAAA,GAAA,CAAA;;AACA,WAAA,CAAA,EAAA,CAAA,GAAA,KAAA,KAAA,CAAA,MAAA,EAAA,CAAA,EAAA,EAAA;AACA,QAAA,GAAA,CAAA,IAAA,CAAA,KAAA,KAAA,CAAA,CAAA,GAAA,KAAA,CAAA;;AACA,YAAA,CAAA,GAAA,KAAA,IAAA,KAAA,KAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,UAAA,KAAA,GAAA,KAAA,CAAA,GAAA,CAAA,CAAA;AACA;AACA;;AACA,aAAA,GAAA;AACA,KAhIA;AAiIA,IAAA,KAjIA,iBAiIA,CAjIA,EAiIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAA,MAAA;;AACA,UAAA,OAAA,GAAA,MAAA,CAAA,QAAA,CAAA,cAAA,CAAA,cAAA,EAAA,SAAA,CAAA;;AACA,MAAA,OAAA,CAAA,KAAA;AACA,KA9IA;AA+IA,IAAA,MA/IA,oBA+IA;AACA,MAAA,QAAA,CAAA,cAAA,CAAA,MAAA,EAAA,KAAA,CAAA,OAAA,GAAA,OAAA;AACA,MAAA,QAAA,CAAA,cAAA,CAAA,MAAA,EAAA,KAAA,CAAA,OAAA,GAAA,OAAA;AACA,UAAA,SAAA;AACA,MAAA,SAAA,GAAA,wEAAA;;AACA,UAAA;AACA,YAAA,MAAA,GAAA,IAAA,aAAA,CAAA,eAAA,CAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,SAAA,GAAA,QAAA,EAAA,EAAA;AACA,QAAA,MAAA,CAAA,QAAA,CAAA,SAAA,GAAA,QAAA,EAAA,EAAA;AACA,OAJA,CAIA,OAAA,CAAA,EAAA,CAAA;AACA,KAzJA;AA0JA,IAAA,iBA1JA,6BA0JA,IA1JA,EA0JA;AAAA;;AACA;AAEA,UAAA,IAAA,CAAA,SAAA,EAAA;AACA,aAAA,QAAA,CAAA,WAAA,EAAA,IAAA,EAAA;AACA,UAAA,IAAA,EAAA;AADA,SAAA,EAEA,IAFA,CAEA,YAAA;AACA,cAAA,QAAA,GAAA;AACA,YAAA,SAAA,EAAA,IAAA,CAAA,SADA;AAEA,YAAA,QAAA,EAAA,GAFA;AAGA,YAAA,SAAA,EAAA,MAAA,CAAA;AAHA,WAAA;AAKA,UAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,KAAA;AACA,UAAA,aAAA,CAAA,QAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,gBAAA,GAAA,CAAA,IAAA,CAAA,IAAA,EAAA;AACA,cAAA,MAAA,CAAA,cAAA;AACA;AACA,WAJA;AAKA,SAdA;AAeA;AACA;AA9KA,GAhDA;AAgOA,EAAA,OAhOA,qBAgOA;AACA;AACA,QAAA,IAAA,GAAA,IAAA,IAAA,EAAA;AACA,QAAA,IAAA,GAAA,IAAA,CAAA,WAAA,EAAA;AACA,QAAA,KAAA,GAAA,IAAA,CAAA,QAAA,KAAA,CAAA;AACA,IAAA,KAAA,GAAA,KAAA,GAAA,CAAA,GAAA,KAAA,GAAA,MAAA,KAAA;AACA,QAAA,OAAA,GAAA,IAAA,GAAA,GAAA,GAAA,KAAA;AACA,SAAA,KAAA,GAAA,OAAA;AACA;AAxOA,CAAA","sourcesContent":["<template>\r\n    <div>\r\n        <el-button @click=\"backHistory\" class=\"back\">返回</el-button>\r\n\r\n        <el-row :gutter=\"20\">\r\n            <el-col :xs=\"{ span: 24 }\" :md=\"{ span: 12 }\">\r\n                <div class=\"title\" style=\"margin-bottom:20px;\">\r\n                    <p class=\"name\">报销申请单</p>\r\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" v-if=\"invoiceInfo\">\r\n                        <tr>\r\n                            <td>姓名</td>\r\n                            <td colspan=\"3\">{{ invoiceInfo.applyUserName }}</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>项目名称</td>\r\n                            <td colspan=\"3\" v-if=\"invoiceInfo.alias != null\">{{ invoiceInfo.alias }}</td>\r\n                            <td colspan=\"3\" v-else>与项目无关</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td width=\"100\">总分类</td>\r\n                            <td>{{ invoiceInfo.type1Name }}</td>\r\n                            <td width=\"100\">明细分类</td>\r\n                            <td>{{ invoiceInfo.type3Name }}</td>\r\n                        </tr>\r\n                        <tr v-if=\"invoiceInfo.type1 != 297\">\r\n                            <td>是否找票</td>\r\n                            <td colspan=\"3\" v-if=\"invoiceInfo.isFull == 0\">否</td>\r\n                            <td colspan=\"3\" v-else-if=\"invoiceInfo.isFull == 1\">是</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>报销支付描述</td>\r\n                            <td colspan=\"3\">{{ invoiceInfo.payDesc }}</td>\r\n                        </tr>\r\n\r\n                        <tr v-if=\"invoiceInfo.type1 != 10 && invoiceInfo.type1 != 22 && invoiceInfo.isFull == 1\">\r\n                            <td>支付时间</td>\r\n                            <td colspan=\"3\">{{ invoiceInfo.payTimeCh }}</td>\r\n                        </tr>\r\n                        <tr v-if=\"invoiceInfo.type1 == 297\">\r\n                            <td>支付时间</td>\r\n                            <td colspan=\"3\">{{ invoiceInfo.payTimeCh }}</td>\r\n                        </tr>\r\n\r\n                        <tr v-if=\"invoiceInfo.isFull == 1 && (invoiceInfo.type1 != 10 && invoiceInfo.type1 != 22)\">\r\n                            <td>支付金额</td>\r\n                            <td>{{ invoiceInfo.payPriceYuan }} 元</td>\r\n                            <td>支付截图数量</td>\r\n                            <td v-if=\"invoiceInfo.payImgNum != null\">{{ invoiceInfo.payImgNum }} 张</td>\r\n                            <td v-else>无</td>\r\n                        </tr>\r\n                        <tr v-if=\"invoiceInfo.type1 == 297\">\r\n                            <td>支付金额</td>\r\n                            <td>{{ invoiceInfo.payPriceYuan }} 元</td>\r\n                            <td>支付截图数量</td>\r\n                            <td v-if=\"invoiceInfo.payImgNum != null\">{{ invoiceInfo.payImgNum }} 张</td>\r\n                            <td v-else>无</td>\r\n                        </tr>\r\n\r\n                        <tr v-if=\"invoiceInfo.isFull == 1 && (invoiceInfo.type1 != 10 && invoiceInfo.type1 != 22)\">\r\n                            <td>支付截图</td>\r\n                            <td colspan=\"3\" v-if=\"invoiceInfo.payImg\">\r\n                                <!-- <el-image v-for=\"(url, index) in urls1\" :key=\"url\" :src=\"url\" lazy @click=\"onPreview1(index)\"></el-image> -->\r\n                                <el-image v-for=\"(img, index) in urls1\" :key=\"img\" :src=\"img\" lazy :preview-src-list=\"onPreview1(index)\"></el-image>\r\n                                <!-- <el-image-viewer v-if=\"showViewer\" :on-close=\"closeViewer\" :url-list=\"[url]\"></el-image-viewer> -->\r\n                            </td>\r\n                            <td colspan=\"3\" v-else>无</td>\r\n                        </tr>\r\n                        <tr v-if=\"invoiceInfo.type1 == 297\">\r\n                            <td>支付截图</td>\r\n                            <td colspan=\"3\" v-if=\"invoiceInfo.payImg\">\r\n                                <!-- <el-image v-for=\"(url, index) in urls1\" :key=\"url\" :src=\"url\" lazy @click=\"onPreview1(index)\"></el-image> -->\r\n                                <el-image v-for=\"(img, index) in urls1\" :key=\"img\" :src=\"img\" lazy :preview-src-list=\"onPreview1(index)\"></el-image>\r\n                                <!-- <el-image-viewer v-if=\"showViewer\" :on-close=\"closeViewer\" :url-list=\"[url]\"></el-image-viewer> -->\r\n                            </td>\r\n                            <td colspan=\"3\" v-else>无</td>\r\n                        </tr>\r\n\r\n                        <tr v-if=\"invoiceInfo.type1 != 297\">\r\n                            <td>发票描述</td>\r\n                            <td colspan=\"3\">{{ invoiceInfo.invoiceDesc }}</td>\r\n                        </tr>\r\n                        <tr v-if=\"invoiceInfo.type1 != 297\">\r\n                            <td>发票时间</td>\r\n                            <td colspan=\"3\">{{ invoiceInfo.invoiceTimeCh }}</td>\r\n                        </tr>\r\n                        <tr v-if=\"invoiceInfo.type1 != 297\">\r\n                            <td>发票金额</td>\r\n                            <td>{{ invoiceInfo.invoicePriceYuan }} 元</td>\r\n                            <td>发票数量</td>\r\n                            <td>{{ invoiceInfo.invoiceImgNum }} 张</td>\r\n                        </tr>\r\n                        <tr v-if=\"invoiceInfo.type1 != 297\">\r\n                            <td>发票图片</td>\r\n                            <td colspan=\"3\" v-if=\"invoiceInfo.invoiceImg\">\r\n                                <el-image v-for=\"(img, index) in urls2\" :key=\"img\" :src=\"img\" lazy :preview-src-list=\"onPreview2(index)\"></el-image>\r\n                                <!-- <el-image-viewer v-if=\"showViewer\" :on-close=\"closeViewer\" :url-list=\"[url]\"></el-image-viewer> -->\r\n                            </td>\r\n                            <td colspan=\"3\" v-else>无</td>\r\n                        </tr>\r\n                        <tr v-if=\"invoiceInfo.type1 != 297\">\r\n                            <td>发票代码</td>\r\n                            <td colspan=\"3\">无</td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>状态</td>\r\n                            <td colspan=\"3\">\r\n                                <el-tag v-if=\"invoiceInfo.status == 0\" type=\"warning\">审批中</el-tag>\r\n                                <el-tag v-else-if=\"invoiceInfo.status == 1\" type=\"success\">已同意</el-tag>\r\n                                <el-tag v-else-if=\"invoiceInfo.status == 2\" type=\"danger\">已拒绝</el-tag>\r\n\r\n                                <el-tag v-if=\"invoiceInfo.isAffirm == 1\" type=\"success\">已确认</el-tag>\r\n                                <el-tag v-else-if=\"invoiceInfo.isAffirm == 0\" type=\"danger\">未确认</el-tag>\r\n\r\n                                &nbsp;&nbsp;\r\n                                <el-date-picker\r\n                                    v-if=\"invoiceInfo.status == 1 && invoiceInfo.isAffirm == 0 && deptId == '7100'\"\r\n                                    v-model=\"month\"\r\n                                    value-format=\"yyyy-MM\"\r\n                                    format=\"yyyy 年 MM 月\"\r\n                                    type=\"month\"\r\n                                    placeholder=\"请选择归档月份\"\r\n                                    size=\"mini\"\r\n                                    style=\"width: 180px;margin-right: 15px;\"\r\n                                ></el-date-picker>\r\n                                <el-button\r\n                                    size=\"mini\"\r\n                                    type=\"danger\"\r\n                                    @click.native=\"handleModalAffirm(invoiceInfo)\"\r\n                                    v-if=\"invoiceInfo.status == 1 && invoiceInfo.isAffirm == 0 && deptId == '7100'\"\r\n                                >\r\n                                    确认收到票据\r\n                                </el-button>\r\n                            </td>\r\n                        </tr>\r\n                        <tr v-if=\"RefuseInfo.length == 0\">\r\n                            <td>审批历史</td>\r\n                            <td colspan=\"3\">\r\n                                <el-tag type=\"warning\">第{{ RefuseInfo.length + 1 }}次审批</el-tag>\r\n                            </td>\r\n                        </tr>\r\n                        <tr v-else v-for=\"(item, index) in RefuseInfo\" :key=\"index\">\r\n                            <td v-if=\"index == 0\" :rowspan=\"RefuseInfo.length\">拒绝历史</td>\r\n                            <td colspan=\"3\" style=\"height: 100px;\">\r\n                                <div style=\"color: #65CEA7;margin-top: 22px;\">\r\n                                    {{ item.checkUserName }}\r\n                                    <i class=\"el-icon-time\" style=\"color: #000;margin-left: 10px;margin-right: 5px\" v-if=\"item.check > 0\"></i>\r\n                                    <span style=\"color: #000\" v-if=\"item.check > 0\">{{ item.updateTime }}</span>\r\n                                </div>\r\n                                <div style=\"color: #000000;margin-top: 15px;font-size: 12px\">\r\n                                    <el-tag type=\"warning\">第{{ index + 1 }}次审批</el-tag>\r\n                                    审批意见：{{ item.summary }}\r\n                                </div>\r\n                            </td>\r\n                        </tr>\r\n                    </table>\r\n                </div>\r\n                <div><p class=\"name\">审批结果</p></div>\r\n                <div class=\"result\" v-for=\"approver in approverList\">\r\n                    <el-avatar size=\"medium\" :src=\"approver.checkUserAvatar\" class=\"avatar\"></el-avatar>\r\n                    <span class=\"username\" style=\"color: #65CEA7;\">\r\n                        {{ approver.checkUserName }}\r\n                        <i class=\"el-icon-time\" style=\"color: #000;margin-left: 10px;margin-right: 5px\" v-if=\"approver.check > 0\"></i>\r\n                        <span style=\"color: #000\" v-if=\"approver.check > 0\">{{ approver.updateTime }}</span>\r\n                    </span>\r\n                    <span style=\"color: #000000;margin-top: 45px;position: absolute;font-size: 12px\">审批意见：{{ approver.summary }}</span>\r\n                    <div>\r\n                        <span v-if=\"approver.check == 0 && approver.isBeing == 1\">\r\n                            <el-tag class=\"checkSty\" type=\"warning\">\r\n                                <i class=\"el-icon-loading\" style=\"margin-right:5px\"></i>\r\n                                审批中\r\n                            </el-tag>\r\n                        </span>\r\n                        <span v-if=\"approver.check == 0 && approver.isBeing == 0\">\r\n                            <el-tag class=\"checkSty\" type=\"\">\r\n                                <i class=\"el-icon-loading\" style=\"margin-right:5px\"></i>\r\n                                待审批\r\n                            </el-tag>\r\n                        </span>\r\n                        <span v-if=\"approver.check == 1\">\r\n                            <el-tag class=\"checkSty\" type=\"success\">\r\n                                <i class=\"el-icon-success\" style=\"margin-right:5px\"></i>\r\n                                已同意\r\n                            </el-tag>\r\n                        </span>\r\n                        <span v-if=\"approver.check == 2\">\r\n                            <el-tag class=\"checkSty\" type=\"danger\">\r\n                                <i class=\"el-icon-error\" style=\"margin-right:5px\"></i>\r\n                                已拒绝\r\n                            </el-tag>\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div v-if=\"showCheck\">\r\n                    <div class=\"title left\"><p class=\"name\">审批</p></div>\r\n                    <el-alert title=\"审批流程不可逆转\" type=\"warning\"></el-alert>\r\n                    <el-form :model=\"formData\" :rules=\"rules\" ref=\"formData\" label-width=\"100px\" class=\"demo-ruleForm res\" style=\"width: 100%\">\r\n                        <el-radio-group v-model=\"formData.check\" @change=\"selectChcek\" style=\"margin-top: 10px;margin-left: 20px\">\r\n                            <el-radio label=\"1\">同意</el-radio>\r\n                            <el-radio label=\"2\">拒绝</el-radio>\r\n                        </el-radio-group>\r\n                        <el-form-item prop=\"summary\" style=\"margin-left: -100px;margin-top: 10px\">\r\n                            <el-input type=\"textarea\" v-model=\"formData.summary\" placeholder=\"请填写原因\" maxlength=\"30\" show-word-limit></el-input>\r\n                        </el-form-item>\r\n                        <el-form-item><el-button type=\"success\" class=\"submit\" @click=\"onSubmit\" :loading=\"saving\">提交</el-button></el-form-item>\r\n                    </el-form>\r\n                </div>\r\n            </el-col>\r\n            <el-col :xs=\"{ span: 24 }\" :md=\"{ span: 12 }\">\r\n                <el-button class=\"print\" style=\"\" @click=\"print\" v-if=\"invoiceInfo.status == 1 && formData.checkUserId == invoiceInfo.userId\">打印</el-button>\r\n                <div class=\"title\" id=\"printContent\" ref=\"print\">\r\n                    <p class=\"name\" style=\"text-align: center\">费用报销单</p>\r\n                    <div style=\"width: 90%;margin-left:3%;\">\r\n                        <span style=\"color: #1f2d3d;display: inline-block;padding: 10px 10px 10px 0px;float: left; width: 40%;\">\r\n                            单位:\r\n                            <span v-if=\"invoiceInfo.companyId == '2'\">北京甲板智慧科技有限公司</span>\r\n                            <span v-if=\"invoiceInfo.companyId == '3'\">北京甲板数字科技有限公司</span>\r\n                        </span>\r\n                        <span style=\"color: #1f2d3d;display: inline-block;padding: 10px 0;float: left; width: 30%;\" v-if=\"invoiceInfo.type1 == 297\">\r\n                            {{ invoiceInfo.payTimeCh }}\r\n                        </span>\r\n                        <span style=\"color: #1f2d3d;display: inline-block;padding: 10px 0;float: left; width: 30%;\" v-if=\"invoiceInfo.type1 != 297\">\r\n                            {{ invoiceInfo.invoiceTimeCh }}\r\n                        </span>\r\n                        <span style=\"color: #1f2d3d;display: inline-block;padding: 10px 10px;float: right;text-align: right; margin-right: -3%;width: 20%;\">\r\n                            第\r\n                            <span v-if=\"invoiceInfo.type1 == 22 || invoiceInfo.type1 == 10\" style=\"padding: 0 2px;\">2</span>\r\n                            <span v-else style=\"padding: 0 2px;\">1</span>\r\n                            号\r\n                        </span>\r\n                    </div>\r\n                    <table border=\"1\" cellspacing=\"0\" cellpadding=\"0\" v-if=\"invoiceInfo\" style=\"width: 90%;margin-left: 5%;\">\r\n                        <tr style=\"height: 110px;text-align: center\">\r\n                            <td width=\"200\">摘要</td>\r\n                            <td colspan=\"3\" style=\"text-align: left; padding: 0 10px;\">{{ invoiceInfo.invoiceDesc }}</td>\r\n                        </tr>\r\n                        <tr style=\"height: 110px;text-align: center\">\r\n                            <td width=\"200\">金额</td>\r\n                            <td colspan=\"3\" style=\"padding: 0 10px;\">\r\n                                <span style=\"float: left;margin-top: 30px;\">\r\n                                    人民币(大写) :\r\n                                    <u>{{ invoiceInfo.invoicePriceChYuan }}</u>\r\n                                </span>\r\n                                <div style=\"float: right;margin-top: 60px;margin-right: 10px;\">\r\n                                    ￥\r\n                                    <u>{{ invoiceInfo.invoicePriceYuan }}</u>\r\n                                </div>\r\n                            </td>\r\n                        </tr>\r\n                        <tr style=\"height: 110px;text-align: center\">\r\n                            <td width=\"200\">附单据张数</td>\r\n                            <td width=\"400\" style=\"text-align: left; padding: 0 10px;\">{{ invoiceInfo.invoiceImgNum }}</td>\r\n                            <td width=\"200\">领款人签章</td>\r\n                            <td width=\"400\" style=\"text-align: left; padding: 0 10px;\">{{ applyUser }}</td>\r\n                        </tr>\r\n                    </table>\r\n\r\n                    <div style=\"display: flex;color: #000000;text-align:left;line-height: 60px;margin-left: 5%;\">\r\n                        <span style=\"flex:1;\">审批人：{{ checkUser1 }}</span>\r\n                        <span style=\"flex:1;\">审核：{{ checkUser2 }}</span>\r\n                        <span style=\"flex:1;\">证明或验收：{{ checkUser3 }}</span>\r\n                        <span style=\"flex:1;\">经手：{{ applyUser }}</span>\r\n                    </div>\r\n                    <div style=\"height: 1px;border-top: 1px dotted #000000;width: 90%;margin: 5% 5%;display: none\" id=\"line\"></div>\r\n                    <div style=\"height: 440px;border: 1px solid #000000;width: 90%;margin: 5% 5%;display: none\" id=\"cont\">\r\n                        <h2 style=\"line-height: 440px;color: #000000;letter-spacing: 30px;text-align: center;\">发票粘贴处</h2>\r\n                    </div>\r\n                </div>\r\n            </el-col>\r\n        </el-row>\r\n    </div>\r\n</template>\r\n<script>\r\nimport { getInvoiceInfo, affirmInvoice, getInvoiceApproverList, updateInvoiceApprover, getInvoiceRefuse } from '../../../api/apply/invoice.js';\r\nimport { print } from '../../../utils/utils';\r\nimport { mapGetters } from 'vuex';\r\n\r\nimport ElImageViewer from 'element-ui/packages/image/src/image-viewer';\r\nimport moment from 'moment';\r\nexport default {\r\n    components: { ElImageViewer },\r\n    data() {\r\n        return {\r\n            month: '',\r\n            formData: {\r\n                approverId: null,\r\n                checkUserId: null,\r\n                check: '1',\r\n                summary: '同意'\r\n            },\r\n            invoiceInfo: {\r\n                applyUserName: '',\r\n                invoiceTime: ''\r\n            },\r\n            invoiceId: null,\r\n            createTime: null,\r\n            listLoading: false,\r\n            list: [],\r\n            approverList: [],\r\n            rules: {\r\n                summary: [{ required: true, message: '请填写原因' }]\r\n            },\r\n            previewTime: '',\r\n            previewList: [],\r\n            checkUser1: '',\r\n            checkUser2: '',\r\n            checkUser3: '',\r\n            applyUser: '',\r\n            showCheck: false,\r\n            saving: false,\r\n            url: '',\r\n            urls1: [],\r\n            urls2: [],\r\n            showViewer: false, // 显示查看器\r\n            RefuseInfo: []\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapGetters(['permissions', 'userId', 'deptId'])\r\n    },\r\n    created() {\r\n        this.invoiceId = this.$route.params.invoiceId;\r\n        this.formData.checkUserId = this.userId;\r\n        this.getInvoiceInfo();\r\n        this.getInvoiceRefuse();\r\n        // window.addEventListener('beforeunload', e => this.beforeunloadFn(e))\r\n    },\r\n    methods: {\r\n        getInvoiceRefuse() {\r\n            getInvoiceRefuse(this.invoiceId).then(res => {\r\n                console.log(res);\r\n                this.RefuseInfo = res.data.data;\r\n            });\r\n        },\r\n        getInvoiceInfo() {\r\n            getInvoiceInfo(this.invoiceId).then(response => {\r\n                this.invoiceInfo = response.data.data;\r\n                console.log(this.invoiceInfo);\r\n                this.invoiceInfo.invoiceTimeCh = moment(this.invoiceInfo.invoiceTime).format('YYYY年MM月DD日');\r\n                this.invoiceInfo.payTimeCh = moment(this.invoiceInfo.payTime).format('YYYY年MM月DD日');\r\n                this.urls1 = [];\r\n                this.urls2 = [];\r\n                if (this.invoiceInfo.payImg) {\r\n                    this.invoiceInfo.payImg.split(',').forEach((item, index) => {\r\n                        if (item) {\r\n                            this.urls1.push(`${window.location.origin}/apply/invoice/` + item);\r\n                        }\r\n                    });\r\n                }\r\n                if (this.invoiceInfo.invoiceImg) {\r\n                    this.invoiceInfo.invoiceImg.split(',').forEach((item, index) => {\r\n                        if (item) {\r\n                            this.urls2.push(`${window.location.origin}/apply/invoice/` + item);\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (this.invoiceInfo.type1 == 22 || this.invoiceInfo.type1 == 10) {\r\n                    this.checkUser1 = '王铮';\r\n                    this.checkUser3 = '王海清';\r\n                    this.applyUser = '李长霖';\r\n                } else {\r\n                    this.applyUser = this.invoiceInfo.applyUserName;\r\n                }\r\n\r\n                this.getInvoiceApproverList();\r\n            });\r\n        },\r\n        getInvoiceApproverList() {\r\n            getInvoiceApproverList(this.invoiceId).then(response => {\r\n                // console.log(response);\r\n                this.approverList = response.data.data;\r\n                this.approverList.forEach((item, index) => {\r\n                    if (item.check == 0 && item.isBeing == 1 && item.userId == this.formData.checkUserId) {\r\n                        this.formData.approverId = item.approverId;\r\n                        this.showCheck = true;\r\n                    }\r\n                });\r\n                if (this.invoiceInfo.status == 1) {\r\n                    if (this.approverList.length == 2) {\r\n                        this.checkUser1 = this.approverList[0].checkUserName;\r\n                        this.checkUser3 = this.approverList[1].checkUserName;\r\n                    }\r\n                    if (this.approverList.length == 3) {\r\n                        this.checkUser1 = this.approverList[0].checkUserName;\r\n                        this.checkUser2 = this.approverList[1].checkUserName;\r\n                        this.checkUser3 = this.approverList[2].checkUserName;\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        selectChcek() {\r\n            if (this.formData.check == 1) {\r\n                this.formData.summary = '同意';\r\n            } else {\r\n                this.formData.summary = '';\r\n            }\r\n        },\r\n        onSubmit() {\r\n            this.$confirm('请审批人审核发票信息、报销内容、项目名称后再同意，一经同意后流程不能逆转。', '温馨提示：', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning',\r\n                showClose: false\r\n            })\r\n                .then(() => {\r\n                    updateInvoiceApprover(this.formData)\r\n                        .then(res => {\r\n                            // console.log(res);\r\n                            if (res.data.data) {\r\n                                this.backHistory();\r\n                            }\r\n                        })\r\n                        .finally(() => {\r\n                            this.saving = false;\r\n                        });\r\n                })\r\n                .catch(() => {\r\n                    this.saving = false;\r\n                });\r\n\r\n            // console.log(this.formData);\r\n        },\r\n        backHistory() {\r\n            this.$router.go(-1);\r\n        },\r\n        onPreview1(index) {\r\n            // this.url = this.urls1[val];\r\n            // this.showViewer = true;\r\n            let arr = [];\r\n            let i = 0;\r\n            for (i; i < this.urls1.length; i++) {\r\n                arr.push(this.urls1[i + index]);\r\n                if (i + index >= this.urls1.length - 1) {\r\n                    index = 0 - (i + 1);\r\n                }\r\n            }\r\n            return arr;\r\n        },\r\n        closeViewer() {\r\n            this.showViewer = false;\r\n            this.url = '';\r\n        },\r\n        onPreview2(index) {\r\n            // this.url = this.urls2[val];\r\n            // this.showViewer = true;\r\n            let arr = [];\r\n            let i = 0;\r\n            for (i; i < this.urls2.length; i++) {\r\n                arr.push(this.urls2[i + index]);\r\n                if (i + index >= this.urls2.length - 1) {\r\n                    index = 0 - (i + 1);\r\n                }\r\n            }\r\n            return arr;\r\n        },\r\n        print(e) {\r\n            // this.remove();\r\n            // let subOutputRankPrint = document.getElementById('printContent');\r\n            // let newContent =subOutputRankPrint.innerHTML;\r\n            // let oldContent = document.body.innerHTML;\r\n            // document.body.innerHTML = newContent;\r\n            // window.print();\r\n            // // window.location.reload();\r\n            // document.body.innerHTML = oldContent;\r\n            // return false;\r\n            this.remove();\r\n            const windows = print(document.getElementById('printContent').innerHTML);\r\n            windows.close();\r\n        },\r\n        remove() {\r\n            document.getElementById('line').style.display = 'block';\r\n            document.getElementById('cont').style.display = 'block';\r\n            var hkey_path;\r\n            hkey_path = 'HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\PageSetup\\\\';\r\n            try {\r\n                var RegWsh = new ActiveXObject('WScript.Shell');\r\n                RegWsh.RegWrite(hkey_path + 'header', '');\r\n                RegWsh.RegWrite(hkey_path + 'footer', '');\r\n            } catch (e) {}\r\n        },\r\n        handleModalAffirm(data) {\r\n            //console.log(data)\r\n\r\n            if (data.invoiceId) {\r\n                this.$confirm('确认收到发票了吗?', '提示', {\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    const editData = {\r\n                        invoiceId: data.invoiceId,\r\n                        isAffirm: '1',\r\n                        backMonth: this.month\r\n                    };\r\n                    console.log(this.month);\r\n                    affirmInvoice(editData).then(res => {\r\n                        if (res.data.data) {\r\n                            this.getInvoiceInfo();\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    },\r\n    mounted() {\r\n        // window.addEventListener('beforeunload', e => this.beforeunloadFn(e))\r\n        var date = new Date();\r\n        var year = date.getFullYear();\r\n        var month = date.getMonth() + 1;\r\n        month = month > 9 ? month : '0' + month;\r\n        var toMonth = year + '-' + month;\r\n        this.month = toMonth;\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.paste {\r\n    display: none;\r\n}\r\n.line {\r\n    display: none;\r\n}\r\n@page {\r\n    size: auto; /* auto is the initial value */\r\n    margin: 0mm; /* this affects the margin in the printer settings */\r\n}\r\nhtml {\r\n    background-color: #ffffff;\r\n    margin: 0px; /* this affects the margin on the html before sending to printer */\r\n}\r\nbody {\r\n    border: solid 1px blue;\r\n    margin: 10mm 15mm 10mm 15mm; /* margin you want for the content */\r\n}\r\ntable {\r\n    margin-top: 20px;\r\n    color: #1f2d3d;\r\n    width: 100%;\r\n    border-right: 1px solid #1f2d3d;\r\n    border-bottom: 1px solid #1f2d3d;\r\n}\r\ntable td {\r\n    padding: 10px 0;\r\n    border-left: 1px solid #1f2d3d;\r\n    border-top: 1px solid #1f2d3d;\r\n}\r\n.el-tag {\r\n    line-height: 16px;\r\n    height: auto;\r\n}\r\n.el-image {\r\n    width: 100px;\r\n}\r\n.submit {\r\n    float: right;\r\n    margin-top: -10px;\r\n}\r\n.back {\r\n    margin-top: 10px;\r\n}\r\n.title {\r\n    text-align: center;\r\n}\r\n.name {\r\n    font-size: 21px;\r\n    color: #1f2d3d;\r\n    padding: 10px 0 5px 0;\r\n    text-align: center;\r\n}\r\n.time {\r\n    font-size: 16px;\r\n    color: #9d9e61;\r\n    padding: 10px 0;\r\n}\r\n.result {\r\n    max-width: 800px;\r\n    height: 100px;\r\n    border: 1px solid #f1f3f4;\r\n    margin-bottom: 10px;\r\n}\r\n.avatar {\r\n    margin-top: 20px;\r\n    margin-left: 20px;\r\n    margin-right: 20px;\r\n    height: 45px;\r\n    width: 45px;\r\n}\r\n.username {\r\n    margin-top: 22px;\r\n    position: absolute;\r\n}\r\n.res {\r\n    max-width: 800px;\r\n    height: 200px;\r\n    border: 1px solid #f1f3f4;\r\n    padding: 10px;\r\n}\r\n.submit {\r\n    float: right;\r\n    margin-top: -10px;\r\n}\r\n\r\n.checkSty {\r\n    float: right;\r\n    right: 10px;\r\n    margin-top: -60px;\r\n    position: relative;\r\n    line-height: 32px;\r\n    height: 32px;\r\n}\r\n.result {\r\n    max-width: 800px;\r\n    height: 100px;\r\n    border: 1px solid #f1f3f4;\r\n    margin-bottom: 10px;\r\n}\r\n.avatar {\r\n    margin-top: 20px;\r\n    margin-left: 20px;\r\n    margin-right: 20px;\r\n    height: 45px;\r\n    width: 45px;\r\n}\r\n.print {\r\n    float: right;\r\n    background-color: #65cea7;\r\n    color: #ffffff;\r\n    position: absolute;\r\n    right: 3%;\r\n}\r\n</style>\n"],"sourceRoot":"src/views/apply/invoice"}]}