{"remainingRequest":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\purchase\\purchaseApply\\Info.vue?vue&type=style&index=0&id=7cd44754&scoped=true&lang=css&","dependencies":[{"path":"D:\\DDMS\\src\\views\\purchase\\purchaseApply\\Info.vue","mtime":1598236622730},{"path":"D:\\DDMS\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.paste {\n    display: none;\n}\n.line {\n    display: none;\n}\n@page {\n    size: auto; /* auto is the initial value */\n    margin: 0mm; /* this affects the margin in the printer settings */\n}\nhtml {\n    background-color: #ffffff;\n    margin: 0px; /* this affects the margin on the html before sending to printer */\n}\nbody {\n    border: solid 1px blue;\n    margin: 10mm 15mm 10mm 15mm; /* margin you want for the content */\n}\ntable {\n    margin-top: 20px;\n    color: #1f2d3d;\n    width: 100%;\n    border-right: 1px solid #1f2d3d;\n    border-bottom: 1px solid #1f2d3d;\n}\ntable td {\n    padding: 10px 0;\n    border-left: 1px solid #1f2d3d;\n    border-top: 1px solid #1f2d3d;\n}\n.el-tag {\n    line-height: 16px;\n    height: auto;\n}\n.el-image {\n    width: 100px;\n}\n.submit {\n    float: right;\n    margin-top: -10px;\n}\n.back {\n    margin-top: 10px;\n}\n.title {\n    text-align: center;\n}\n.name {\n    font-size: 21px;\n    color: #1f2d3d;\n    padding: 10px 0 5px 0;\n    text-align: center;\n}\n.time {\n    font-size: 16px;\n    color: #9d9e61;\n    padding: 10px 0;\n}\n.result {\n    max-width: 800px;\n    height: 100px;\n    border: 1px solid #f1f3f4;\n    margin-bottom: 10px;\n}\n.avatar {\n    margin-top: 20px;\n    margin-left: 20px;\n    margin-right: 20px;\n    height: 45px;\n    width: 45px;\n}\n.username {\n    margin-top: 22px;\n    position: absolute;\n}\n.res {\n    max-width: 800px;\n    height: 225px;\n    border: 1px solid #f1f3f4;\n    padding: 10px;\n}\n.submit {\n    float: right;\n    margin-top: -10px;\n}\n\n.checkSty {\n    float: right;\n    right: 10px;\n    margin-top: -60px;\n    position: relative;\n    line-height: 32px;\n    height: 32px;\n}\n.result {\n    max-width: 800px;\n    height: 100px;\n    border: 1px solid #f1f3f4;\n    margin-bottom: 10px;\n}\n.avatar {\n    margin-top: 20px;\n    margin-left: 20px;\n    margin-right: 20px;\n    height: 45px;\n    width: 45px;\n}\n.print {\n    float: right;\n    background-color: #65cea7;\n    color: #ffffff;\n    position: absolute;\n    right: 3%;\n}\n",{"version":3,"sources":["Info.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Info.vue","sourceRoot":"src/views/purchase/purchaseApply","sourcesContent":["<template>\n    <div>\n        <el-button @click=\"backHistory\" class=\"back\">返回</el-button>\n\n        <el-row :gutter=\"20\">\n            <el-col :xs=\"{ span: 24 }\" :md=\"{ span: 12 }\">\n                <div class=\"title\" style=\"margin-bottom:20px;\">\n                    <p class=\"name\">采购申请单</p>\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n                        <tr>\n                            <td>申请人</td>\n                            <td colspan=\"3\">{{ purchaseInfo.applyUserName }}</td>\n                        </tr>\n                        <tr>\n                            <td>项目名称</td>\n                            <td colspan=\"3\" v-if=\"purchaseInfo.alias != null && purchaseInfo.aliasNext == null\">{{ purchaseInfo.alias }}</td>\n                            <td colspan=\"3\" v-else-if=\"purchaseInfo.alias != null && purchaseInfo.aliasNext != null\">{{ purchaseInfo.aliasNext }} / {{ purchaseInfo.alias }}</td>\n                            <td colspan=\"3\" v-else>与项目无关</td>\n                        </tr>\n                        <tr>\n                            <td width=\"100\">总分类</td>\n                            <td>{{ purchaseInfo.type1Name }}</td>\n\n                            <td width=\"100\">明细分类</td>\n                            <td>{{ purchaseInfo.type3Name }}</td>\n                        </tr>\n                        <tr>\n                            <td>采购物品名称</td>\n                            <td colspan=\"3\">{{ purchaseInfo.name }}</td>\n                        </tr>\n                        <tr>\n                            <td>数量</td>\n                            <td colspan=\"3\">{{ purchaseInfo.num }}</td>\n                        </tr>\n                        <tr>\n                            <td>单价</td>\n                            <td colspan=\"3\">{{ purchaseInfo.priceYuan }}</td>\n                        </tr>\n                        <tr>\n                            <td>总价</td>\n                            <td colspan=\"3\">{{ purchaseInfo.guessPriceYuan }}</td>\n                        </tr>\n                        <tr>\n                            <td>具体需求</td>\n                            <td colspan=\"3\">{{ purchaseInfo.demand }}</td>\n                        </tr>\n                        <tr>\n                            <td>京东/淘宝链接</td>\n                            <td colspan=\"3\"><el-link type=\"primary\" :href=\"purchaseInfo.buyUrl\" target=\"_blank\">链接</el-link></td>\n                        </tr>\n                        <tr>\n                            <td>推荐厂家/联系方式</td>\n                            <td colspan=\"3\">{{ purchaseInfo.factoryName }}</td>\n                        </tr>\n                        <tr>\n                            <td>备注</td>\n                            <td colspan=\"3\">{{ purchaseInfo.remark }}</td>\n                        </tr>\n                        <tr>\n                            <td>收货信息</td>\n                            <td colspan=\"3\">{{ purchaseInfo.contact }}</td>\n                        </tr>\n                        <tr>\n                            <td>预计到货时间</td>\n                            <td colspan=\"3\">{{ purchaseInfo.guessTime }}</td>\n                        </tr>\n                        <tr>\n                            <td>型号参数</td>\n                            <td colspan=\"3\">{{ purchaseInfo.model }}</td>\n                        </tr>\n                        <tr>\n                            <td>型号参数图片</td>\n                            <td colspan=\"3\" v-if=\"purchaseInfo.purchaseImg\">\n                                <el-image v-for=\"(url, index) in urls2\" :key=\"url\" :src=\"url\" lazy @click=\"onPreview2(index)\"></el-image>\n                                <el-image-viewer v-if=\"showViewer\" :on-close=\"closeViewer\" :url-list=\"[url]\"></el-image-viewer>\n                            </td>\n                            <td colspan=\"3\" v-else><span>无</span></td>\n                        </tr>\n                        <tr>\n                            <td>状态</td>\n                            <td colspan=\"3\" v-if=\"purchaseInfo.status == 0\"><el-tag type=\"warning\">审批中</el-tag></td>\n                            <td colspan=\"3\" v-if=\"purchaseInfo.status == 1\"><el-tag type=\"success\">已同意</el-tag></td>\n                            <td colspan=\"3\" v-if=\"purchaseInfo.status == 2\"><el-tag type=\"danger\">已拒绝</el-tag></td>\n                        </tr>\n                    </table>\n                </div>\n                <div><p class=\"name\">审批结果</p></div>\n                <div class=\"result\" v-for=\"approver in approverList\">\n                    <el-avatar size=\"medium\" :src=\"approver.checkUserAvatar\" class=\"avatar\"></el-avatar>\n                    <span class=\"username\" style=\"color: #65CEA7;\">\n                        {{ approver.checkUserName }}\n                        <i class=\"el-icon-time\" style=\"color: #000;margin-left: 10px;margin-right: 5px\" v-if=\"approver.check > 0\"></i>\n                        <span style=\"color: #000\" v-if=\"approver.check > 0\">{{ approver.updateTime }}</span>\n                    </span>\n                    <span style=\"color: #000000;margin-top: 45px;position: absolute;font-size: 12px\">审批意见：{{ approver.summary }}</span>\n                    <div>\n                        <span v-if=\"approver.check == 0 && approver.isBeing == 1\">\n                            <el-tag class=\"checkSty\" type=\"warning\">\n                                <i class=\"el-icon-loading\" style=\"margin-right:5px\"></i>\n                                审批中\n                            </el-tag>\n                        </span>\n                        <span v-if=\"approver.check == 0 && approver.isBeing == 0\">\n                            <el-tag class=\"checkSty\" type=\"\">\n                                <i class=\"el-icon-loading\" style=\"margin-right:5px\"></i>\n                                待审批\n                            </el-tag>\n                        </span>\n                        <span v-if=\"approver.check == 1\">\n                            <el-tag class=\"checkSty\" type=\"success\">\n                                <i class=\"el-icon-success\" style=\"margin-right:5px\"></i>\n                                已同意\n                            </el-tag>\n                        </span>\n                        <span v-if=\"approver.check == 2\">\n                            <el-tag class=\"checkSty\" type=\"danger\">\n                                <i class=\"el-icon-error\" style=\"margin-right:5px\"></i>\n                                已拒绝\n                            </el-tag>\n                        </span>\n                    </div>\n                </div>\n\n                <div v-if=\"showCheck\">\n                    <div class=\"title left\"><p class=\"name\">审批</p></div>\n                    <el-alert title=\"审批流程不可逆转\" type=\"warning\"></el-alert>\n                    <el-form :model=\"formData\" :rules=\"rules\" ref=\"formData\" label-width=\"100px\" class=\"demo-ruleForm res\" style=\"width: 100%\">\n                        <!-- <el-form-item label=\"采购负责人：\" prop=\"principalId\">\n                            <el-select v-model=\"formData.principalId\" placeholder=\"请选择\">\n                                <el-option v-for=\"item in BusinessList\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"></el-option>\n                            </el-select>\n                        </el-form-item> -->\n                        <el-radio-group v-model=\"formData.check\" @change=\"selectChcek\" style=\"margin-top: 10px;margin-left: 20px\">\n                            <el-radio label=\"1\">同意</el-radio>\n                            <el-radio label=\"2\">拒绝</el-radio>\n                        </el-radio-group>\n                        <el-form-item prop=\"summary\" style=\"margin-left: -100px;margin-top: 10px\">\n                            <el-input type=\"textarea\" v-model=\"formData.summary\" placeholder=\"请填写原因\" maxlength=\"30\" show-word-limit></el-input>\n                        </el-form-item>\n                        <el-form-item><el-button type=\"success\" class=\"submit\" @click=\"onSubmit\" :loading=\"saving\">提交</el-button></el-form-item>\n                    </el-form>\n                </div>\n            </el-col>\n        </el-row>\n    </div>\n</template>\n\n<script>\nimport { getPurchaseInfo, updatePurchaseApprover, getBusinessDept } from '../../../api/purchase/purchase.js';\nimport { mapGetters } from 'vuex';\nimport ElImageViewer from 'element-ui/packages/image/src/image-viewer';\n\nexport default {\n    components: { ElImageViewer },\n    data() {\n        return {\n            purchaseId: null,\n            purchaseInfo: '',\n            approverList: [],\n            url: '',\n            urls2: [],\n            showViewer: false, // 显示查看器\n            formData: {\n                userId: null,\n                approverId: null,\n                userId: null,\n                check: '1',\n                summary: '同意',\n                principalId: 91\n            },\n            query: {\n                deptId: 3100\n            },\n            rules: {\n                summary: [{ required: true, message: '请填写原因' }],\n                principalId: [{ required: true, message: '请选择采购负责人', trigger: 'change' }]\n            },\n            showCheck: false,\n            saving: false,\n            BusinessList: []\n        };\n    },\n    computed: {\n        ...mapGetters(['permissions', 'userId'])\n    },\n    created() {\n        this.purchaseId = this.$route.params.purchaseId;\n        this.getPurchaseInfo();\n        this.formData.userId = this.userId;\n        this.getBusinessDept(this.query);\n    },\n    methods: {\n        backHistory() {\n            this.$router.go(-1);\n        },\n        getPurchaseInfo() {\n            getPurchaseInfo(this.purchaseId).then(res => {\n                this.purchaseInfo = res.data.data;\n                console.log(this.purchaseInfo);\n                this.approverList = res.data.data.checkUserList;\n                this.approverList.forEach((item, index) => {\n                    if (item.check == 0 && item.isBeing == 1 && item.userId == this.formData.userId) {\n                        this.formData.approverId = item.approverId;\n                        this.showCheck = true;\n                    }\n                });\n                this.urls2 = [];\n                if (this.purchaseInfo.purchaseImg) {\n                    this.purchaseInfo.purchaseImg.split(',').forEach((item, index) => {\n                        if (item) {\n                            this.urls2.push(`${window.location.origin}/apply/purchase/` + item);\n                        }\n                    });\n                }\n            });\n        },\n        selectChcek() {\n            if (this.formData.check == 1) {\n                this.formData.summary = '同意';\n            } else {\n                this.formData.summary = '';\n            }\n        },\n        onSubmit() {\n            this.$refs['formData'].validate(valid => {\n                console.log(this.formData);\n\n                if (valid) {\n                    updatePurchaseApprover(this.formData)\n                        .then(res => {\n                            // console.log(res);\n                            if (res.data.data) {\n                                this.backHistory();\n                            }\n                        })\n                        .finally(() => {\n                            this.saving = false;\n                        });\n\n                    // console.log(this.formData);\n                }\n            });\n        },\n        getBusinessDept(id) {\n            getBusinessDept(id).then(res => {\n                // console.log(res);\n                res.data.data.forEach(item => {\n                    this.BusinessList.push({\n                        value: item.userId,\n                        label: item.username\n                    });\n                });\n            });\n        },\n        closeViewer() {\n            this.showViewer = false;\n            this.url = '';\n        },\n        onPreview2(val) {\n            this.url = this.urls2[val];\n            this.showViewer = true;\n        }\n    }\n};\n</script>\n\n<style scoped>\n.paste {\n    display: none;\n}\n.line {\n    display: none;\n}\n@page {\n    size: auto; /* auto is the initial value */\n    margin: 0mm; /* this affects the margin in the printer settings */\n}\nhtml {\n    background-color: #ffffff;\n    margin: 0px; /* this affects the margin on the html before sending to printer */\n}\nbody {\n    border: solid 1px blue;\n    margin: 10mm 15mm 10mm 15mm; /* margin you want for the content */\n}\ntable {\n    margin-top: 20px;\n    color: #1f2d3d;\n    width: 100%;\n    border-right: 1px solid #1f2d3d;\n    border-bottom: 1px solid #1f2d3d;\n}\ntable td {\n    padding: 10px 0;\n    border-left: 1px solid #1f2d3d;\n    border-top: 1px solid #1f2d3d;\n}\n.el-tag {\n    line-height: 16px;\n    height: auto;\n}\n.el-image {\n    width: 100px;\n}\n.submit {\n    float: right;\n    margin-top: -10px;\n}\n.back {\n    margin-top: 10px;\n}\n.title {\n    text-align: center;\n}\n.name {\n    font-size: 21px;\n    color: #1f2d3d;\n    padding: 10px 0 5px 0;\n    text-align: center;\n}\n.time {\n    font-size: 16px;\n    color: #9d9e61;\n    padding: 10px 0;\n}\n.result {\n    max-width: 800px;\n    height: 100px;\n    border: 1px solid #f1f3f4;\n    margin-bottom: 10px;\n}\n.avatar {\n    margin-top: 20px;\n    margin-left: 20px;\n    margin-right: 20px;\n    height: 45px;\n    width: 45px;\n}\n.username {\n    margin-top: 22px;\n    position: absolute;\n}\n.res {\n    max-width: 800px;\n    height: 225px;\n    border: 1px solid #f1f3f4;\n    padding: 10px;\n}\n.submit {\n    float: right;\n    margin-top: -10px;\n}\n\n.checkSty {\n    float: right;\n    right: 10px;\n    margin-top: -60px;\n    position: relative;\n    line-height: 32px;\n    height: 32px;\n}\n.result {\n    max-width: 800px;\n    height: 100px;\n    border: 1px solid #f1f3f4;\n    margin-bottom: 10px;\n}\n.avatar {\n    margin-top: 20px;\n    margin-left: 20px;\n    margin-right: 20px;\n    height: 45px;\n    width: 45px;\n}\n.print {\n    float: right;\n    background-color: #65cea7;\n    color: #ffffff;\n    position: absolute;\n    right: 3%;\n}\n</style>\n"]}]}