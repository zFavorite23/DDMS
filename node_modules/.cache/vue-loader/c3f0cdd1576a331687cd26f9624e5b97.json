{"remainingRequest":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\checkwork\\My.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\DDMS\\src\\views\\checkwork\\My.vue","mtime":1588235430059},{"path":"D:\\DDMS\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.el-dropdown-link {\r\n    cursor: pointer;\r\n    color: #409eff;\r\n}\r\n",{"version":3,"sources":["My.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+bA;AACA;AACA;AACA","file":"My.vue","sourceRoot":"src/views/checkwork","sourcesContent":["<template>\r\n    <div>\r\n        <div>\r\n            <span class=\"tit\">我的考勤</span>\r\n            <el-form :inline=\"true\" :model=\"query\">\r\n                <el-form-item>\r\n                    <el-date-picker\r\n                        v-model=\"query.selectMonth\"\r\n                        :picker-options=\"expireTimeOption\"\r\n                        type=\"month\"\r\n                        value-format=\"yyyy-MM\"\r\n                        format=\"yyyy 年 MM 月\"\r\n                        placeholder=\"选择月\"\r\n                    >\r\n                    </el-date-picker>\r\n                </el-form-item>\r\n                <el-form-item>\r\n                    <el-button\r\n                        type=\"primary\"\r\n                        size=\"medium\"\r\n                        v-on:click=\"getClockList()\"\r\n                        icon=\"el-icon-search\"\r\n                        >搜索</el-button\r\n                    >\r\n                </el-form-item>\r\n                <el-form-item style=\"float: right;right: 0;position: absolute;\">\r\n                    <el-button type=\"primary\" @click=\"getStatisticsUserId\"\r\n                        >当月小计</el-button\r\n                    >\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n\r\n        <el-row>\r\n            <!--            <el-col  :xs=\"{span:24}\" :md=\"{span:15}\">-->\r\n            <el-table\r\n                :data=\"list\"\r\n                stripe\r\n                border\r\n                v-loading=\"listLoading\"\r\n                style=\"width: 100%;\"\r\n            >\r\n                <el-table-column\r\n                    prop=\"day\"\r\n                    min-width=\"100\"\r\n                    label=\"日期\"\r\n                ></el-table-column>\r\n                <el-table-column\r\n                    prop=\"time\"\r\n                    min-width=\"80\"\r\n                    label=\"时间\"\r\n                ></el-table-column>\r\n                <el-table-column\r\n                    prop=\"type\"\r\n                    min-width=\"80\"\r\n                    label=\"类型\"\r\n                    :formatter=\"formatType\"\r\n                >\r\n                </el-table-column>\r\n                <el-table-column prop=\"status\" min-width=\"130\" label=\"状态\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-tag v-if=\"scope.row.status == 0\" type=\"success\"\r\n                            >菜单</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 1\" type=\"\"\r\n                            >正常</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2\" type=\"danger\"\r\n                            >迟到</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 3\" type=\"danger\"\r\n                            >早退</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 4\" type=\"danger\"\r\n                            >旷工</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 10\" type=\"danger\"\r\n                            >请假</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 11\" type=\"success\"\r\n                            >外出</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 12\" type=\"success\"\r\n                            >出差</el-tag\r\n                        >\r\n\r\n                        <el-tag v-if=\"scope.row.status == 1930\" type=\"success\"\r\n                            >加班到19:30</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2000\" type=\"success\"\r\n                            >加班到20:00</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2030\" type=\"success\"\r\n                            >加班到20:30</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2100\" type=\"success\"\r\n                            >加班到21:00</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2130\" type=\"success\"\r\n                            >加班到21:30</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2200\" type=\"success\"\r\n                            >加班到22:00</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2230\" type=\"success\"\r\n                            >加班到22:30</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2300\" type=\"success\"\r\n                            >加班到23:00</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2330\" type=\"success\"\r\n                            >加班到23:30</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2400\" type=\"success\"\r\n                            >加班到00:00</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2430\" type=\"success\"\r\n                            >加班到00:30</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 2500\" type=\"success\"\r\n                            >加班到01:00</el-tag\r\n                        >\r\n\r\n                        <el-tag v-if=\"scope.row.status == 21\" type=\"warning\"\r\n                            >五分钟内第一次</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 22\" type=\"warning\"\r\n                            >五分钟内第二次</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 23\" type=\"warning\"\r\n                            >五分钟内第三次</el-tag\r\n                        >\r\n\r\n                        <el-tag v-if=\"scope.row.status == 101\" type=\"info\"\r\n                            >第一次未打卡</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 102\" type=\"info\"\r\n                            >第二次未打卡</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 103\" type=\"info\"\r\n                            >第三次未打卡</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 104\" type=\"info\"\r\n                            >第四次未打卡</el-tag\r\n                        >\r\n                        <el-tag v-if=\"scope.row.status == 105\" type=\"info\"\r\n                            >第五次未打卡</el-tag\r\n                        >\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column\r\n                    prop=\"start\"\r\n                    min-width=\"60\"\r\n                    label=\"提前\"\r\n                ></el-table-column>\r\n                <el-table-column\r\n                    prop=\"end\"\r\n                    min-width=\"60\"\r\n                    label=\"加班\"\r\n                ></el-table-column>\r\n                <el-table-column\r\n                    prop=\"createTime\"\r\n                    min-width=\"160\"\r\n                    label=\"创建时间\"\r\n                ></el-table-column>\r\n                <el-table-column label=\"操作\" min-width=\"100\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-dropdown\r\n                            v-if=\"\r\n                                scope.row.status == 2 ||\r\n                                    scope.row.status == 3 ||\r\n                                    scope.row.status == 4\r\n                            \"\r\n                            trigger=\"click\"\r\n                            @command=\"handleCommand\"\r\n                        >\r\n                            <el-button\r\n                                type=\"primary\"\r\n                                size=\"mini\"\r\n                                class=\"el-dropdown-link\"\r\n                            >\r\n                                异常申请<i\r\n                                    class=\"el-icon-arrow-down el-icon--right\"\r\n                                ></i>\r\n                            </el-button>\r\n                            <el-dropdown-menu slot=\"dropdown\">\r\n                                <el-dropdown-item\r\n                                    :command=\"composeValue(1, scope.row)\"\r\n                                    >未打卡</el-dropdown-item\r\n                                >\r\n                                <el-dropdown-item\r\n                                    :command=\"composeValue(2, scope.row)\"\r\n                                    >出差</el-dropdown-item\r\n                                >\r\n                                <el-dropdown-item\r\n                                    :command=\"composeValue(3, scope.row)\"\r\n                                    >外出</el-dropdown-item\r\n                                >\r\n                                <el-dropdown-item\r\n                                    :command=\"composeValue(4, scope.row)\"\r\n                                    >请假</el-dropdown-item\r\n                                >\r\n                            </el-dropdown-menu>\r\n                        </el-dropdown>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n            <el-pagination\r\n                class=\"right\"\r\n                @size-change=\"handleSizeChange\"\r\n                @current-change=\"handleCurrentChange\"\r\n                :current-page=\"query.current\"\r\n                :page-sizes=\"[10, 20, 50, 100]\"\r\n                :page-size=\"query.size\"\r\n                layout=\"total, sizes, prev, pager, next\"\r\n                :total=\"total\"\r\n            >\r\n            </el-pagination>\r\n            <!--            </el-col>-->\r\n            <!--            <el-col  :xs=\"{span:24}\" :md=\"{span:8}\" :offset=\"1\" style=\"border: 1px solid #DCDFE6;padding: 30px\">-->\r\n            <!--                 <div style=\"color: #000;line-height: 40px\">-->\r\n            <!--                     <h3>当月小计</h3>-->\r\n            <!--                     <p>姓名：{{userStatisticsInfo.userName}}</p>-->\r\n            <!--                     <p>正常：{{userStatisticsInfo.normalNum}} 次</p>-->\r\n            <!--                     <p>迟到：{{userStatisticsInfo.lateNum}} 次</p>-->\r\n            <!--                     <p>早退：{{userStatisticsInfo.earlyNum}} 次</p>-->\r\n            <!--                     <p>旷工：{{userStatisticsInfo.absenteeismNum}} 次</p>-->\r\n            <!--                     <p>出差：{{userStatisticsInfo.businesstripNum}} 天</p>-->\r\n            <!--                     <p>请假：{{userStatisticsInfo.leaveNum}} 小时</p>-->\r\n            <!--                     <p>外出：{{userStatisticsInfo.gooutNum}} 小时</p>-->\r\n            <!--                 </div>-->\r\n            <!--            </el-col>-->\r\n        </el-row>\r\n    </div>\r\n</template>\r\n<script>\r\nimport {\r\n    getPageList,\r\n    getStatisticsUserId,\r\n    clockMigration\r\n} from \"../../api/checkwork/clock.js\";\r\nimport { dateFormat } from \"../../utils/date.js\";\r\nimport { mapGetters } from \"vuex\";\r\nexport default {\r\n    data() {\r\n        return {\r\n            query: {\r\n                selectMonth: dateFormat(new Date()).substr(0, 7),\r\n                userId: \"\",\r\n                current: 1,\r\n                size: 10\r\n            },\r\n            expireTimeOption: {\r\n                disabledDate: time => {\r\n                    var date = new Date();\r\n                    var year = date.getFullYear();\r\n                    var month = date.getMonth() + 1;\r\n                    if (month >= 1 && month <= 9) {\r\n                        month = \"0\" + month;\r\n                    }\r\n                    var currentdate = year.toString() + month.toString();\r\n                    var timeyear = time.getFullYear();\r\n                    var timemonth = time.getMonth() + 1;\r\n                    if (timemonth >= 1 && timemonth <= 9) {\r\n                        timemonth = \"0\" + timemonth;\r\n                    }\r\n                    var timedate = timeyear.toString() + timemonth.toString();\r\n                    return currentdate < timedate;\r\n                }\r\n            },\r\n            pages: 0,\r\n            total: 0,\r\n            listLoading: false,\r\n            list: [],\r\n            number: \"\",\r\n            arr1: [],\r\n            userStatisticsInfo: {\r\n                userName: \"\"\r\n            }\r\n        };\r\n    },\r\n    created() {\r\n        this.getClockList();\r\n        this.query.userId = this.userId;\r\n        this.getStatisticsUserId();\r\n    },\r\n    computed: {\r\n        ...mapGetters([\"permissions\", \"userId\"])\r\n    },\r\n    mounted() {},\r\n    methods: {\r\n        open() {},\r\n        setdates(arr) {\r\n            var obj = {},\r\n                k,\r\n                arr1 = [];\r\n            for (var i = 0, len = arr.length; i < len; i++) {\r\n                k = arr[i].day;\r\n                if (obj[k]) obj[k]++;\r\n                else obj[k] = 1;\r\n            }\r\n            //console.log(obj)\r\n            //保存结果{el-'元素'，count-出现次数}\r\n            for (var o in obj) {\r\n                for (let i = 0; i < obj[o]; i++) {\r\n                    if (i === 0) {\r\n                        this.arr1.push(obj[o]);\r\n                    } else {\r\n                        this.arr1.push(0);\r\n                    }\r\n                }\r\n            }\r\n            //console.log(this.arr1);\r\n        },\r\n        objectSpanMethod({ row, column, rowIndex, columnIndex }) {\r\n            if (columnIndex === 0) {\r\n                let _row = this.arr1[rowIndex];\r\n                let _col = this.arr1[rowIndex] > 0 ? 1 : 0;\r\n                return [_row, _col];\r\n            }\r\n        },\r\n\r\n        getClockList() {\r\n            this.listLoading = true;\r\n            getPageList(this.query)\r\n                .then(response => {\r\n                    this.listLoading = false;\r\n                    this.total = response.data.data.total;\r\n                    this.query.current = response.data.data.current;\r\n                    this.query.size = response.data.data.size;\r\n                    this.list = response.data.data.records;\r\n                    this.setdates(this.list);\r\n\r\n                    // this.getStatisticsUserId();\r\n                })\r\n                .catch(() => {\r\n                    this.listLoading = false;\r\n                });\r\n        },\r\n        getClockMigration() {\r\n            clockMigration().then(response => {});\r\n        },\r\n        getStatisticsUserId() {\r\n            getStatisticsUserId(this.query).then(response => {\r\n                this.userStatisticsInfo = response.data.data;\r\n                console.log(this.userStatisticsInfo);\r\n                var a =\r\n                    this.userStatisticsInfo.normalNum == null\r\n                        ? +0 + \" 次\"\r\n                        : this.userStatisticsInfo.normalNum + \" 次\";\r\n                var b =\r\n                    this.userStatisticsInfo.lateNum == null\r\n                        ? +0 + \" 次\"\r\n                        : this.userStatisticsInfo.lateNum + \" 次\";\r\n                var c =\r\n                    this.userStatisticsInfo.earlyNum == null\r\n                        ? +0 + \" 次\"\r\n                        : this.userStatisticsInfo.earlyNum + \" 次\";\r\n                var d =\r\n                    this.userStatisticsInfo.absenteeismNum == null\r\n                        ? +0 + \" 次\"\r\n                        : this.userStatisticsInfo.absenteeismNum + \" 次\";\r\n                var e =\r\n                    this.userStatisticsInfo.businesstripNum == null\r\n                        ? +0 + \" 天\"\r\n                        : this.userStatisticsInfo.businesstripNum + \" 天\";\r\n                var f =\r\n                    this.userStatisticsInfo.leaveNum == null\r\n                        ? +0 + \" 小时\"\r\n                        : this.userStatisticsInfo.leaveNum + \" 小时\";\r\n                var g =\r\n                    this.userStatisticsInfo.gooutNum == null\r\n                        ? +0 + \" 小时\"\r\n                        : this.userStatisticsInfo.gooutNum + \" 小时\";\r\n                content = [\r\n                    \"姓名：\" + this.userStatisticsInfo.userName,\r\n                    \"正常：\" + a,\r\n                    \"迟到：\" + b,\r\n                    \"早退：\" + c,\r\n                    \"旷工：\" + d,\r\n                    \"出差：\" + e,\r\n                    \"请假：\" + f,\r\n                    \"外出：\" + g\r\n                ];\r\n                console.log(content);\r\n                let content = content;\r\n                let newDatas = [];\r\n                const h = this.$createElement;\r\n                for (let i in content) {\r\n                    newDatas.push(h(\"p\", null, content[i]));\r\n                }\r\n                this.$alert(h(\"div\", null, newDatas), \"当月小计\");\r\n            });\r\n        },\r\n        formatType: function(row) {\r\n            return row.type == 1 ? \"上班\" : row.type == 2 ? \"下班\" : \"未知\";\r\n        },\r\n        // 单独处理时间的函数\r\n        dealDisabledDate(time) {\r\n            return time.getTime() >= Date.now();\r\n        },\r\n        handleSizeChange(val) {\r\n            this.query.size = val;\r\n            this.getClockList();\r\n        },\r\n        handleCurrentChange(val) {\r\n            this.query.current = val;\r\n            this.getClockList();\r\n        },\r\n        composeValue(item, row) {\r\n            return {\r\n                button: item,\r\n                row: row\r\n            };\r\n        },\r\n        handleCommand(command) {\r\n            //this.$message('click on item ' + command);\r\n            //console.log(command)\r\n            window.localStorage.setItem(\r\n                \"applyClockInfo\",\r\n                JSON.stringify(command.row)\r\n            );\r\n            if (command.button == 1) {\r\n                this.$router.push({\r\n                    path: \"/apply/clock/form\"\r\n                });\r\n            }\r\n            if (command.button == 2) {\r\n                this.$router.push({\r\n                    path: \"/apply/businesstrip/form\"\r\n                });\r\n            }\r\n            if (command.button == 3) {\r\n                this.$router.push({\r\n                    path: \"/apply/goout/form\"\r\n                });\r\n            }\r\n            if (command.button == 4) {\r\n                this.$router.push({\r\n                    path: \"/apply/leave/form\"\r\n                });\r\n            }\r\n        }\r\n    }\r\n};\r\n</script>\r\n<style type=\"text/scss\" lang=\"scss\">\r\n.el-dropdown-link {\r\n    cursor: pointer;\r\n    color: #409eff;\r\n}\r\n</style>\r\n"]}]}