{"remainingRequest":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\apply\\invoice\\Info.vue?vue&type=style&index=0&id=2f93a2ea&scoped=true&lang=css&","dependencies":[{"path":"D:\\DDMS\\src\\views\\apply\\invoice\\Info.vue","mtime":1593067089949},{"path":"D:\\DDMS\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.paste {\n    display: none;\n}\n.line {\n    display: none;\n}\n@page {\n    size: auto; /* auto is the initial value */\n    margin: 0mm; /* this affects the margin in the printer settings */\n}\nhtml {\n    background-color: #ffffff;\n    margin: 0px; /* this affects the margin on the html before sending to printer */\n}\nbody {\n    border: solid 1px blue;\n    margin: 10mm 15mm 10mm 15mm; /* margin you want for the content */\n}\ntable {\n    margin-top: 20px;\n    color: #1f2d3d;\n    width: 100%;\n    border-right: 1px solid #1f2d3d;\n    border-bottom: 1px solid #1f2d3d;\n}\ntable td {\n    padding: 10px 0;\n    border-left: 1px solid #1f2d3d;\n    border-top: 1px solid #1f2d3d;\n}\n.el-tag {\n    line-height: 16px;\n    height: auto;\n}\n.el-image {\n    width: 100px;\n}\n.submit {\n    float: right;\n    margin-top: -10px;\n}\n.back {\n    margin-top: 10px;\n}\n.title {\n    text-align: center;\n}\n.name {\n    font-size: 21px;\n    color: #1f2d3d;\n    padding: 10px 0 5px 0;\n    text-align: center;\n}\n.time {\n    font-size: 16px;\n    color: #9d9e61;\n    padding: 10px 0;\n}\n.result {\n    max-width: 800px;\n    height: 100px;\n    border: 1px solid #f1f3f4;\n    margin-bottom: 10px;\n}\n.avatar {\n    margin-top: 20px;\n    margin-left: 20px;\n    margin-right: 20px;\n    height: 45px;\n    width: 45px;\n}\n.username {\n    margin-top: 22px;\n    position: absolute;\n}\n.res {\n    max-width: 800px;\n    height: 200px;\n    border: 1px solid #f1f3f4;\n    padding: 10px;\n}\n.submit {\n    float: right;\n    margin-top: -10px;\n}\n\n.checkSty {\n    float: right;\n    right: 10px;\n    margin-top: -60px;\n    position: relative;\n    line-height: 32px;\n    height: 32px;\n}\n.result {\n    max-width: 800px;\n    height: 100px;\n    border: 1px solid #f1f3f4;\n    margin-bottom: 10px;\n}\n.avatar {\n    margin-top: 20px;\n    margin-left: 20px;\n    margin-right: 20px;\n    height: 45px;\n    width: 45px;\n}\n.print {\n    float: right;\n    background-color: #65cea7;\n    color: #ffffff;\n    position: absolute;\n    right: 3%;\n}\n",{"version":3,"sources":["Info.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6dA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Info.vue","sourceRoot":"src/views/apply/invoice","sourcesContent":["<template>\n    <div>\n        <el-button @click=\"backHistory\" class=\"back\">返回</el-button>\n\n        <el-row :gutter=\"20\">\n            <el-col :xs=\"{ span: 24 }\" :md=\"{ span: 12 }\">\n                <div class=\"title\" style=\"margin-bottom:20px;\">\n                    <p class=\"name\">报销申请单</p>\n                    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" v-if=\"invoiceInfo\">\n                        <tr>\n                            <td>姓名</td>\n                            <td colspan=\"3\">{{ invoiceInfo.applyUserName }}</td>\n                        </tr>\n                        <tr>\n                            <td>项目名称</td>\n                            <td colspan=\"3\" v-if=\"invoiceInfo.alias != null\">{{ invoiceInfo.alias }}</td>\n                            <td colspan=\"3\" v-else>与项目无关</td>\n                        </tr>\n                        <tr>\n                            <td width=\"100\">总分类</td>\n                            <td v-if=\"invoiceInfo.classify == 7\">办公用品</td>\n                            <td v-if=\"invoiceInfo.classify == 8\">固定资产</td>\n                            <td v-if=\"invoiceInfo.classify == 9\">管理费用</td>\n                            <td v-if=\"invoiceInfo.classify == 10\">人员补助</td>\n                            <td v-if=\"invoiceInfo.classify == 11\">项目报销</td>\n                            <td width=\"100\">明细分类</td>\n                            <td v-if=\"invoiceInfo.classify == 7 && invoiceInfo.type == 1\">办公文具</td>\n                            <td v-if=\"invoiceInfo.classify == 7 && invoiceInfo.type == 2\">办公耗材</td>\n                            <td v-if=\"invoiceInfo.classify == 7 && invoiceInfo.type == 3\">日杂百货</td>\n                            <td v-if=\"invoiceInfo.classify == 7 && invoiceInfo.type == 4\">财务用品</td>\n                            <td v-if=\"invoiceInfo.classify == 7 && invoiceInfo.type == 5\">电子设备及工具</td>\n\n                            <td v-if=\"invoiceInfo.classify == 8 && invoiceInfo.type == 1\">办公设备</td>\n                            <td v-if=\"invoiceInfo.classify == 8 && invoiceInfo.type == 2\">办公家具</td>\n\n                            <td v-if=\"invoiceInfo.classify == 9 && invoiceInfo.type == 1\">市内交通</td>\n                            <td v-if=\"invoiceInfo.classify == 9 && invoiceInfo.type == 2\">办公费用</td>\n                            <td v-if=\"invoiceInfo.classify == 9 && invoiceInfo.type == 3\">运输</td>\n                            <td v-if=\"invoiceInfo.classify == 9 && invoiceInfo.type == 4\">业务招待费</td>\n                            <td v-if=\"invoiceInfo.classify == 9 && invoiceInfo.type == 5\">会议费</td>\n                            <td v-if=\"invoiceInfo.classify == 9 && invoiceInfo.type == 6\">差旅费</td>\n                            <td v-if=\"invoiceInfo.classify == 9 && invoiceInfo.type == 7\">福利费</td>\n\n                            <td v-if=\"invoiceInfo.classify == 10 && invoiceInfo.type == 1\">住房补助</td>\n\n                            <td v-if=\"invoiceInfo.classify == 11 && invoiceInfo.type == 1\">差旅费</td>\n                            <td v-if=\"invoiceInfo.classify == 11 && invoiceInfo.type == 2\">业务招待费</td>\n                            <td v-if=\"invoiceInfo.classify == 11 && invoiceInfo.type == 3\">外协</td>\n                            <td v-if=\"invoiceInfo.classify == 11 && invoiceInfo.type == 4\">设备采购</td>\n                            <td v-if=\"invoiceInfo.classify == 11 && invoiceInfo.type == 5\">办公费</td>\n                            <td v-if=\"invoiceInfo.classify == 11 && invoiceInfo.type == 6\">市内交通</td>\n                            <td v-if=\"invoiceInfo.classify == 11 && invoiceInfo.type == 7\">会议费</td>\n                        </tr>\n                        <tr>\n                            <td>是否找票</td>\n                            <td colspan=\"3\" v-if=\"invoiceInfo.isFull == 0\">否</td>\n                            <td colspan=\"3\" v-else-if=\"invoiceInfo.isFull == 1\">是</td>\n                        </tr>\n                        <tr>\n                            <td>报销支付描述</td>\n                            <td colspan=\"3\">{{ invoiceInfo.payDesc }}</td>\n                        </tr>\n                        <tr v-if=\"invoiceInfo.isFull == 1 && invoiceInfo.classify != 10\">\n                            <td>支付时间</td>\n                            <td colspan=\"3\">{{ invoiceInfo.payTimeCh }}</td>\n                        </tr>\n                        <tr v-if=\"invoiceInfo.isFull == 1 && invoiceInfo.classify != 10\">\n                            <td>支付金额</td>\n                            <td>{{ invoiceInfo.payPriceYuan }} 元</td>\n                            <td>支付截图数量</td>\n                            <td v-if=\"invoiceInfo.payImgNum != null\">{{ invoiceInfo.payImgNum }} 张</td>\n                            <td v-else>无</td>\n                        </tr>\n                        <tr v-if=\"invoiceInfo.isFull == 1 && invoiceInfo.classify != 10\">\n                            <td>支付截图</td>\n                            <td colspan=\"3\" v-if=\"invoiceInfo.payImg\">\n                                <el-image v-for=\"(url, index) in urls1\" :key=\"url\" :src=\"url\" lazy @click=\"onPreview1(index)\"></el-image>\n                                <el-image-viewer v-if=\"showViewer\" :on-close=\"closeViewer\" :url-list=\"[url]\"></el-image-viewer>\n                            </td>\n                            <td colspan=\"3\" v-else>无</td>\n                        </tr>\n                        <tr>\n                            <td>发票描述</td>\n                            <td colspan=\"3\">{{ invoiceInfo.invoiceDesc }}</td>\n                        </tr>\n                        <tr>\n                            <td>发票时间</td>\n                            <td colspan=\"3\">{{ invoiceInfo.invoiceTimeCh }}</td>\n                        </tr>\n                        <tr>\n                            <td>发票金额</td>\n                            <td>{{ invoiceInfo.invoicePriceYuan }} 元</td>\n                            <td>发票数量</td>\n                            <td>{{ invoiceInfo.invoiceImgNum }} 张</td>\n                        </tr>\n                        <tr>\n                            <td>发票图片</td>\n                            <td colspan=\"3\" v-if=\"invoiceInfo.invoiceImg\">\n                                <el-image v-for=\"(url, index) in urls2\" :key=\"url\" :src=\"url\" lazy @click=\"onPreview2(index)\"></el-image>\n                                <el-image-viewer v-if=\"showViewer\" :on-close=\"closeViewer\" :url-list=\"[url]\"></el-image-viewer>\n                            </td>\n                            <td colspan=\"3\" v-else>无</td>\n                        </tr>\n                        <tr>\n                            <td>发票代码</td>\n                            <td colspan=\"3\">无</td>\n                        </tr>\n                        <tr>\n                            <td>状态</td>\n                            <td colspan=\"3\">\n                                <el-tag v-if=\"invoiceInfo.status == 0\" type=\"warning\">审批中</el-tag>\n                                <el-tag v-else-if=\"invoiceInfo.status == 1\" type=\"success\">已同意</el-tag>\n                                <el-tag v-else-if=\"invoiceInfo.status == 2\" type=\"danger\">已拒绝</el-tag>\n\n                                <el-tag v-if=\"invoiceInfo.isAffirm == 1\" type=\"success\">已确认</el-tag>\n                                <el-tag v-else-if=\"invoiceInfo.isAffirm == 0\" type=\"danger\">未确认</el-tag>\n\n                                &nbsp;&nbsp;\n                                <el-button\n                                    size=\"mini\"\n                                    type=\"danger\"\n                                    @click.native=\"handleModalAffirm(invoiceInfo)\"\n                                    v-if=\"invoiceInfo.status == 1 && invoiceInfo.isAffirm == 0 && deptId == '7100'\"\n                                >\n                                    确认\n                                </el-button>\n                            </td>\n                        </tr>\n                        <tr v-if=\"RefuseInfo.length == 0\">\n                            <td>审批历史</td>\n                            <td colspan=\"3\">\n                                <el-tag type=\"warning\">第{{ RefuseInfo.length + 1 }}次审批</el-tag>\n                            </td>\n                        </tr>\n                        <tr v-else v-for=\"(item, index) in RefuseInfo\" :key=\"index\">\n                            <td v-if=\"index == 0\" :rowspan=\"RefuseInfo.length\">拒绝历史</td>\n                            <td colspan=\"3\" style=\"height: 100px;\">\n                                <div style=\"color: #65CEA7;margin-top: 22px;\">\n                                    {{ item.checkUserName }}\n                                    <i class=\"el-icon-time\" style=\"color: #000;margin-left: 10px;margin-right: 5px\" v-if=\"item.check > 0\"></i>\n                                    <span style=\"color: #000\" v-if=\"item.check > 0\">{{ item.updateTime }}</span>\n                                </div>\n                                <div style=\"color: #000000;margin-top: 15px;font-size: 12px\">\n                                    <el-tag type=\"warning\">第{{ index + 1 }}次审批</el-tag>\n                                    审批意见：{{ item.summary }}\n                                </div>\n                            </td>\n                        </tr>\n                    </table>\n                </div>\n                <div><p class=\"name\">审批结果</p></div>\n                <div class=\"result\" v-for=\"approver in approverList\">\n                    <el-avatar size=\"medium\" :src=\"approver.checkUserAvatar\" class=\"avatar\"></el-avatar>\n                    <span class=\"username\" style=\"color: #65CEA7;\">\n                        {{ approver.checkUserName }}\n                        <i class=\"el-icon-time\" style=\"color: #000;margin-left: 10px;margin-right: 5px\" v-if=\"approver.check > 0\"></i>\n                        <span style=\"color: #000\" v-if=\"approver.check > 0\">{{ approver.updateTime }}</span>\n                    </span>\n                    <span style=\"color: #000000;margin-top: 45px;position: absolute;font-size: 12px\">审批意见：{{ approver.summary }}</span>\n                    <div>\n                        <span v-if=\"approver.check == 0 && approver.isBeing == 1\">\n                            <el-tag class=\"checkSty\" type=\"warning\">\n                                <i class=\"el-icon-loading\" style=\"margin-right:5px\"></i>\n                                审批中\n                            </el-tag>\n                        </span>\n                        <span v-if=\"approver.check == 0 && approver.isBeing == 0\">\n                            <el-tag class=\"checkSty\" type=\"\">\n                                <i class=\"el-icon-loading\" style=\"margin-right:5px\"></i>\n                                待审批\n                            </el-tag>\n                        </span>\n                        <span v-if=\"approver.check == 1\">\n                            <el-tag class=\"checkSty\" type=\"success\">\n                                <i class=\"el-icon-success\" style=\"margin-right:5px\"></i>\n                                已同意\n                            </el-tag>\n                        </span>\n                        <span v-if=\"approver.check == 2\">\n                            <el-tag class=\"checkSty\" type=\"danger\">\n                                <i class=\"el-icon-error\" style=\"margin-right:5px\"></i>\n                                已拒绝\n                            </el-tag>\n                        </span>\n                    </div>\n                </div>\n\n                <div v-if=\"showCheck\">\n                    <div class=\"title left\"><p class=\"name\">审批</p></div>\n                    <el-alert title=\"审批流程不可逆转\" type=\"warning\"></el-alert>\n                    <el-form :model=\"formData\" :rules=\"rules\" ref=\"formData\" label-width=\"100px\" class=\"demo-ruleForm res\" style=\"width: 100%\">\n                        <el-radio-group v-model=\"formData.check\" @change=\"selectChcek\" style=\"margin-top: 10px;margin-left: 20px\">\n                            <el-radio label=\"1\">同意</el-radio>\n                            <el-radio label=\"2\">拒绝</el-radio>\n                        </el-radio-group>\n                        <el-form-item prop=\"summary\" style=\"margin-left: -100px;margin-top: 10px\">\n                            <el-input type=\"textarea\" v-model=\"formData.summary\" placeholder=\"请填写原因\" maxlength=\"30\" show-word-limit></el-input>\n                        </el-form-item>\n                        <el-form-item><el-button type=\"success\" class=\"submit\" @click=\"onSubmit\" :loading=\"saving\">提交</el-button></el-form-item>\n                    </el-form>\n                </div>\n            </el-col>\n            <el-col :xs=\"{ span: 24 }\" :md=\"{ span: 12 }\">\n                <el-button class=\"print\" style=\"\" @click=\"print\" v-if=\"invoiceInfo.status == 1 && formData.checkUserId == invoiceInfo.userId\">打印</el-button>\n                <div class=\"title\" id=\"printContent\" ref=\"print\">\n                    <p class=\"name\" style=\"text-align: center\">费用报销单</p>\n                    <div style=\"width: 90%;margin-left:3%;\">\n                        <span style=\"color: #1f2d3d;display: inline-block;padding: 10px 10px 10px 0px;float: left; width: 40%;\">\n                            单位:\n                            <span v-if=\"invoiceInfo.companyId == '2'\">北京甲板智慧科技有限公司</span>\n                            <span v-if=\"invoiceInfo.companyId == '3'\">北京甲板数字科技有限公司</span>\n                        </span>\n                        <span style=\"color: #1f2d3d;display: inline-block;padding: 10px 0;float: left; width: 30%;\">{{ invoiceInfo.invoiceTimeCh }}</span>\n                        <span style=\"color: #1f2d3d;display: inline-block;padding: 10px 10px;float: right;text-align: right; margin-right: -3%;width: 20%;\">\n                            第\n                            <span v-if=\"invoiceInfo.classify == 10\" style=\"padding: 0 2px;\">2</span>\n                            <span v-else style=\"padding: 0 2px;\">1</span>\n                            号\n                        </span>\n                    </div>\n                    <table border=\"1\" cellspacing=\"0\" cellpadding=\"0\" v-if=\"invoiceInfo\" style=\"width: 90%;margin-left: 5%;\">\n                        <tr style=\"height: 110px;text-align: center\">\n                            <td width=\"200\">摘要</td>\n                            <td colspan=\"3\" style=\"text-align: left; padding: 0 10px;\">{{ invoiceInfo.invoiceDesc }}</td>\n                        </tr>\n                        <tr style=\"height: 110px;text-align: center\">\n                            <td width=\"200\">金额</td>\n                            <td colspan=\"3\" style=\"padding: 0 10px;\">\n                                <span style=\"float: left;margin-top: 30px;\">\n                                    人民币(大写) :\n                                    <u>{{ invoiceInfo.invoicePriceChYuan }}</u>\n                                </span>\n                                <div style=\"float: right;margin-top: 60px;margin-right: 10px;\">\n                                    ￥\n                                    <u>{{ invoiceInfo.invoicePriceYuan }}</u>\n                                </div>\n                            </td>\n                        </tr>\n                        <tr style=\"height: 110px;text-align: center\">\n                            <td width=\"200\">附单据张数</td>\n                            <td width=\"400\" style=\"text-align: left; padding: 0 10px;\">{{ invoiceInfo.invoiceImgNum }}</td>\n                            <td width=\"200\">领款人签章</td>\n                            <td width=\"400\" style=\"text-align: left; padding: 0 10px;\">{{ applyUser }}</td>\n                        </tr>\n                    </table>\n\n                    <div style=\"display: flex;color: #000000;text-align:left;line-height: 60px;margin-left: 5%;\">\n                        <span style=\"flex:1;\">审批人：{{ checkUser1 }}</span>\n                        <span style=\"flex:1;\">审核：{{ checkUser2 }}</span>\n                        <span style=\"flex:1;\">证明或验收：{{ checkUser3 }}</span>\n                        <span style=\"flex:1;\">经手：{{ applyUser }}</span>\n                    </div>\n                    <div style=\"height: 1px;border-top: 1px dotted #000000;width: 90%;margin: 5% 5%;display: none\" id=\"line\"></div>\n                    <div style=\"height: 440px;border: 1px solid #000000;width: 90%;margin: 5% 5%;display: none\" id=\"cont\">\n                        <h2 style=\"line-height: 440px;color: #000000;letter-spacing: 30px;text-align: center;\">发票粘贴处</h2>\n                    </div>\n                </div>\n            </el-col>\n        </el-row>\n    </div>\n</template>\n<script>\nimport { getInvoiceInfo, affirmInvoice, getInvoiceApproverList, updateInvoiceApprover, getInvoiceRefuse } from '../../../api/apply/invoice.js';\nimport { print } from '../../../utils/utils';\nimport { mapGetters } from 'vuex';\n\nimport ElImageViewer from 'element-ui/packages/image/src/image-viewer';\nimport moment from 'moment';\nexport default {\n    components: { ElImageViewer },\n    data() {\n        return {\n            formData: {\n                approverId: null,\n                checkUserId: null,\n                check: '1',\n                summary: '同意'\n            },\n            invoiceInfo: {\n                applyUserName: '',\n                invoiceTime: ''\n            },\n            invoiceId: null,\n            createTime: null,\n            listLoading: false,\n            list: [],\n            approverList: [],\n            rules: {\n                summary: [{ required: true, message: '请填写原因' }]\n            },\n            previewTime: '',\n            previewList: [],\n            checkUser1: '',\n            checkUser2: '',\n            checkUser3: '',\n            applyUser: '',\n            showCheck: false,\n            saving: false,\n            url: '',\n            urls1: [],\n            urls2: [],\n            showViewer: false, // 显示查看器\n            RefuseInfo: []\n        };\n    },\n    computed: {\n        ...mapGetters(['permissions', 'userId', 'deptId'])\n    },\n    created() {\n        this.invoiceId = this.$route.params.invoiceId;\n        this.formData.checkUserId = this.userId;\n        this.getInvoiceInfo();\n        this.getInvoiceRefuse();\n        // window.addEventListener('beforeunload', e => this.beforeunloadFn(e))\n    },\n    methods: {\n        getInvoiceRefuse() {\n            getInvoiceRefuse(this.invoiceId).then(res => {\n                console.log(res);\n                this.RefuseInfo = res.data.data;\n            });\n        },\n        getInvoiceInfo() {\n            getInvoiceInfo(this.invoiceId).then(response => {\n                this.invoiceInfo = response.data.data;\n                this.invoiceInfo.invoiceTimeCh = moment(this.invoiceInfo.invoiceTime).format('YYYY年MM月DD日');\n                this.invoiceInfo.payTimeCh = moment(this.invoiceInfo.payTime).format('YYYY年MM月DD日');\n                this.urls1 = [];\n                this.urls2 = [];\n                if (this.invoiceInfo.payImg) {\n                    this.invoiceInfo.payImg.split(',').forEach((item, index) => {\n                        if (item) {\n                            this.urls1.push(`${window.location.origin}/apply/invoice/` + item);\n                        }\n                    });\n                }\n                if (this.invoiceInfo.invoiceImg) {\n                    this.invoiceInfo.invoiceImg.split(',').forEach((item, index) => {\n                        if (item) {\n                            this.urls2.push(`${window.location.origin}/apply/invoice/` + item);\n                        }\n                    });\n                }\n\n                if (this.invoiceInfo.classify == 10) {\n                    this.checkUser1 = '王铮';\n                    this.checkUser3 = '王海清';\n                    this.applyUser = '李长霖';\n                } else {\n                    this.applyUser = this.invoiceInfo.applyUserName;\n                }\n\n                this.getInvoiceApproverList();\n            });\n        },\n        getInvoiceApproverList() {\n            getInvoiceApproverList(this.invoiceId).then(response => {\n                // console.log(response);\n                this.approverList = response.data.data;\n                this.approverList.forEach((item, index) => {\n                    if (item.check == 0 && item.isBeing == 1 && item.userId == this.formData.checkUserId) {\n                        this.formData.approverId = item.approverId;\n                        this.showCheck = true;\n                    }\n                });\n                if (this.invoiceInfo.status == 1) {\n                    if (this.approverList.length == 2) {\n                        this.checkUser1 = this.approverList[0].checkUserName;\n                        this.checkUser3 = this.approverList[1].checkUserName;\n                    }\n                    if (this.approverList.length == 3) {\n                        this.checkUser1 = this.approverList[0].checkUserName;\n                        this.checkUser2 = this.approverList[1].checkUserName;\n                        this.checkUser3 = this.approverList[2].checkUserName;\n                    }\n                }\n            });\n        },\n        selectChcek() {\n            if (this.formData.check == 1) {\n                this.formData.summary = '同意';\n            } else {\n                this.formData.summary = '';\n            }\n        },\n        onSubmit() {\n            this.$confirm('请审批人审核发票信息、报销内容、项目名称后再同意，一经同意后流程不能逆转。', '温馨提示：', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning',\n                showClose: false\n            })\n                .then(() => {\n                    updateInvoiceApprover(this.formData)\n                        .then(res => {\n                            // console.log(res);\n                            if (res.data.data) {\n                                this.backHistory();\n                            }\n                        })\n                        .finally(() => {\n                            this.saving = false;\n                        });\n                })\n                .catch(() => {\n                    this.saving = false;\n                });\n\n            // console.log(this.formData);\n        },\n        backHistory() {\n            this.$router.go(-1);\n        },\n        onPreview1(val) {\n            this.url = this.urls1[val];\n            this.showViewer = true;\n        },\n        closeViewer() {\n            this.showViewer = false;\n            this.url = '';\n        },\n        onPreview2(val) {\n            this.url = this.urls2[val];\n            this.showViewer = true;\n        },\n        print(e) {\n            // this.remove();\n            // let subOutputRankPrint = document.getElementById('printContent');\n            // let newContent =subOutputRankPrint.innerHTML;\n            // let oldContent = document.body.innerHTML;\n            // document.body.innerHTML = newContent;\n            // window.print();\n            // // window.location.reload();\n            // document.body.innerHTML = oldContent;\n            // return false;\n            this.remove();\n            const windows = print(document.getElementById('printContent').innerHTML);\n            windows.close();\n        },\n        remove() {\n            document.getElementById('line').style.display = 'block';\n            document.getElementById('cont').style.display = 'block';\n            var hkey_path;\n            hkey_path = 'HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Internet Explorer\\\\PageSetup\\\\';\n            try {\n                var RegWsh = new ActiveXObject('WScript.Shell');\n                RegWsh.RegWrite(hkey_path + 'header', '');\n                RegWsh.RegWrite(hkey_path + 'footer', '');\n            } catch (e) {}\n        },\n        handleModalAffirm(data) {\n            //console.log(data)\n\n            if (data.invoiceId) {\n                this.$confirm('确认收到发票了吗?', '提示', {\n                    type: 'warning'\n                }).then(() => {\n                    const editData = {\n                        invoiceId: data.invoiceId,\n                        isAffirm: '1'\n                    };\n                    affirmInvoice(editData).then(res => {\n                        if (res.data.data) {\n                            this.getInvoiceInfo();\n                        }\n                    });\n                });\n            }\n        }\n    }\n    // mounted:{\n    // window.addEventListener('beforeunload', e => this.beforeunloadFn(e))\n    // }\n};\n</script>\n\n<style scoped>\n.paste {\n    display: none;\n}\n.line {\n    display: none;\n}\n@page {\n    size: auto; /* auto is the initial value */\n    margin: 0mm; /* this affects the margin in the printer settings */\n}\nhtml {\n    background-color: #ffffff;\n    margin: 0px; /* this affects the margin on the html before sending to printer */\n}\nbody {\n    border: solid 1px blue;\n    margin: 10mm 15mm 10mm 15mm; /* margin you want for the content */\n}\ntable {\n    margin-top: 20px;\n    color: #1f2d3d;\n    width: 100%;\n    border-right: 1px solid #1f2d3d;\n    border-bottom: 1px solid #1f2d3d;\n}\ntable td {\n    padding: 10px 0;\n    border-left: 1px solid #1f2d3d;\n    border-top: 1px solid #1f2d3d;\n}\n.el-tag {\n    line-height: 16px;\n    height: auto;\n}\n.el-image {\n    width: 100px;\n}\n.submit {\n    float: right;\n    margin-top: -10px;\n}\n.back {\n    margin-top: 10px;\n}\n.title {\n    text-align: center;\n}\n.name {\n    font-size: 21px;\n    color: #1f2d3d;\n    padding: 10px 0 5px 0;\n    text-align: center;\n}\n.time {\n    font-size: 16px;\n    color: #9d9e61;\n    padding: 10px 0;\n}\n.result {\n    max-width: 800px;\n    height: 100px;\n    border: 1px solid #f1f3f4;\n    margin-bottom: 10px;\n}\n.avatar {\n    margin-top: 20px;\n    margin-left: 20px;\n    margin-right: 20px;\n    height: 45px;\n    width: 45px;\n}\n.username {\n    margin-top: 22px;\n    position: absolute;\n}\n.res {\n    max-width: 800px;\n    height: 200px;\n    border: 1px solid #f1f3f4;\n    padding: 10px;\n}\n.submit {\n    float: right;\n    margin-top: -10px;\n}\n\n.checkSty {\n    float: right;\n    right: 10px;\n    margin-top: -60px;\n    position: relative;\n    line-height: 32px;\n    height: 32px;\n}\n.result {\n    max-width: 800px;\n    height: 100px;\n    border: 1px solid #f1f3f4;\n    margin-bottom: 10px;\n}\n.avatar {\n    margin-top: 20px;\n    margin-left: 20px;\n    margin-right: 20px;\n    height: 45px;\n    width: 45px;\n}\n.print {\n    float: right;\n    background-color: #65cea7;\n    color: #ffffff;\n    position: absolute;\n    right: 3%;\n}\n</style>\n"]}]}