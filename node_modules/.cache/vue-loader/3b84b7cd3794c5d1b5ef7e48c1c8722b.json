{"remainingRequest":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\login\\index.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"D:\\DDMS\\src\\views\\login\\index.vue","mtime":1591691395962},{"path":"D:\\DDMS\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n@import \"../../styles/mixin\";\r\n\r\n$bg: #2d3a4b;\r\n$dark_gray: #889aa4;\r\n$light_gray: #eee;\r\n.login-container {\r\n    @include relative;\r\n    height: 100%;\r\n    background-color: $bg;\r\n    input:-webkit-autofill {\r\n        -webkit-box-shadow: 0 0 0 1000px #293444 inset !important;\r\n        -webkit-text-fill-color: #fff !important;\r\n    }\r\n    .item {\r\n        .el-form-item__content {\r\n            display: flex;\r\n            flex-flow: row;\r\n        }\r\n    }\r\n    input {\r\n        background: transparent;\r\n        border: 0;\r\n        -webkit-appearance: none;\r\n        border-radius: 0;\r\n        padding: 0.46rem 0.0666rem 0.16rem 0.2rem;\r\n        color: $light_gray;\r\n        height: 100%;\r\n    }\r\n    .el-input {\r\n        display: inline-block;\r\n    }\r\n    .tips {\r\n        font-size: 14px;\r\n        color: #fff;\r\n        margin-bottom: 0.13333rem;\r\n    }\r\n    .svg-container {\r\n        padding: 0.08rem 0.0666rem 0.08rem 0.2rem;\r\n        color: $dark_gray;\r\n        vertical-align: middle;\r\n        display: inline-block;\r\n        &_login {\r\n            font-size: 20px;\r\n        }\r\n    }\r\n    .title {\r\n        font-size: 26px;\r\n        color: $light_gray;\r\n        margin: 0 auto 0.5333rem auto;\r\n        text-align: center;\r\n        font-weight: bold;\r\n        letter-spacing: 5px;\r\n    }\r\n    .login-form {\r\n        @include fxied-center;\r\n        top: 40%;\r\n        width: 22em;\r\n        padding: 1.4666rem 1.4666rem 1.2rem 1.4666rem;\r\n        box-shadow: 0px 0px 5px 3px #888888;\r\n        border-radius: 10px;\r\n    }\r\n    .el-form-item {\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n        background: rgba(0, 0, 0, 0.1);\r\n        border-radius: 0.0666rem;\r\n        color: #454545;\r\n    }\r\n    .show-pwd {\r\n        position: absolute;\r\n        right: 0.1333rem;\r\n        top: 0.09333rem;\r\n        font-size: 16px;\r\n        color: $dark_gray;\r\n        cursor: pointer;\r\n    }\r\n    .thirdparty-button {\r\n        /*position: absolute;*/\r\n        /*right: .4666rem;*/\r\n        /*bottom: .37333rem;*/\r\n    }\r\n    .login-code-img {\r\n        width: 70px;\r\n        margin-top: 5px;\r\n        margin-left: 15%;\r\n    }\r\n}\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoWA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\r\n    <div class=\"login-container\">\r\n        <el-form\r\n            class=\"card-box login-form\"\r\n            autoComplete=\"on\"\r\n            :model=\"ruleForm\"\r\n            :rules=\"rules\"\r\n            ref=\"ruleForm\"\r\n            label-position=\"left\"\r\n        >\r\n            <h3 class=\"title\">系统登录</h3>\r\n            <el-form-item prop=\"username\" class=\"item\" style=\"height: 40px\">\r\n                <el-input\r\n                    placeholder=\"姓名或手机号\"\r\n                    name=\"username\"\r\n                    autoComplete=\"off\"\r\n                    v-model=\"ruleForm.username\"\r\n                >\r\n                    <i slot=\"prefix\" class=\"el-input__icon\"\r\n                        ><icon-svg icon-class=\"yonghu\"\r\n                    /></i>\r\n                </el-input>\r\n            </el-form-item>\r\n            <el-form-item prop=\"password\" class=\"item\" style=\"height: 40px\">\r\n                <el-input\r\n                    placeholder=\"密码\"\r\n                    name=\"pwd\"\r\n                    :type=\"isShowPwd ? 'text' : 'password'\"\r\n                    @keyup.enter.native=\"handleLogin\"\r\n                    v-model=\"ruleForm.password\"\r\n                    autoComplete=\"off\"\r\n                >\r\n                    <i slot=\"prefix\" class=\"el-input__icon\"\r\n                        ><icon-svg icon-class=\"mima\"\r\n                    /></i>\r\n                    <i\r\n                        slot=\"suffix\"\r\n                        class=\"el-input__icon\"\r\n                        @click=\"isShowPwd = !isShowPwd\"\r\n                        ><icon-svg icon-class=\"zu\"\r\n                    /></i>\r\n                </el-input>\r\n            </el-form-item>\r\n            <el-form-item prop=\"code\" style=\"height: 40px\">\r\n                <el-row :span=\"24\">\r\n                    <el-col :span=\"16\">\r\n                        <el-input\r\n                            :maxlength=\"code.len\"\r\n                            v-model=\"ruleForm.code\"\r\n                            size=\"small\"\r\n                            auto-complete=\"off\"\r\n                            placeholder=\"请输入验证码\"\r\n                        >\r\n                            <i slot=\"prefix\" class=\"el-input__icon\"\r\n                                ><icon-svg icon-class=\"mima\"\r\n                            /></i>\r\n                        </el-input>\r\n                    </el-col>\r\n                    <el-col :span=\"8\">\r\n                        <div class=\"login-code\">\r\n                            <span\r\n                                v-if=\"code.type == 'text'\"\r\n                                class=\"login-code-img\"\r\n                                >{{ code.value }}</span\r\n                            >\r\n                            <img\r\n                                v-else\r\n                                :src=\"code.src\"\r\n                                class=\"login-code-img\"\r\n                            />\r\n                        </div>\r\n                    </el-col>\r\n                </el-row>\r\n            </el-form-item>\r\n\r\n            <el-form-item\r\n                prop=\"code\"\r\n                style=\"margin-left: 1px;border: 0; background: none; height: 40px\"\r\n            >\r\n                <el-checkbox v-model=\"remember\" @change=\"isRemember\"\r\n                    >记住密码</el-checkbox\r\n                >\r\n                <el-checkbox v-model=\"autoLogin\" :disabled=\"isAutoLogin\"\r\n                    >自动登陆</el-checkbox\r\n                >\r\n            </el-form-item>\r\n            <div>\r\n                <el-button\r\n                    type=\"primary\"\r\n                    style=\"width:100%;margin-bottom:25px;\"\r\n                    :loading=\"loading\"\r\n                    @click.native=\"handleLogin()\"\r\n                    >登录\r\n                </el-button>\r\n            </div>\r\n            <div v-if=\"isMobile\" style=\"text-align: center\">\r\n                <img\r\n                    src=\"../../assets/image/wx.png\"\r\n                    style=\"width: 18%;\"\r\n                    @click=\"wxLogin()\"\r\n                />\r\n                <!--                <img src=\"../../assets/image/qq.png\" style=\"width: 18%;float: right;right: 0;margin-right: 20%\"/>-->\r\n                <!--                <el-button type=\"primary\" style=\"width:100%;margin-bottom:30px;\"-->\r\n                <!--                           @click='showDialog = true'>-->\r\n                <!--                    第三方登录-->\r\n                <!--                </el-button>-->\r\n            </div>\r\n        </el-form>\r\n\r\n        <el-dialog title=\"第三方验证\" :visible.sync=\"showDialog\">\r\n            邮箱登录成功,请选择第三方验证<br />\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { randomLenNum } from \"@/utils/utils\";\r\nimport { codeUrl } from \"@/config/app\";\r\nconst Base64 = require(\"js-base64\").Base64;\r\nexport default {\r\n    name: \"login\",\r\n    data() {\r\n        return {\r\n            ruleForm: {\r\n                username: \"\", //用户名\r\n                password: \"\",\r\n                code: \"\",\r\n                randomStr: \"\"\r\n            },\r\n            remember: true,\r\n            autoLogin: true,\r\n            isAutoLogin: false,\r\n            isMobile: false,\r\n            checked: true,\r\n            code: {\r\n                src: \"/code\",\r\n                value: \"\",\r\n                len: 4,\r\n                type: \"image\"\r\n            },\r\n            rules: {\r\n                username: [\r\n                    { required: true, message: \"请输入用户名\", trigger: \"blur\" }\r\n                ],\r\n                password: [\r\n                    { required: true, message: \"请输入密码\", trigger: \"blur\" },\r\n                    { min: 6, message: \"密码长度最少为6位\", trigger: \"blur\" }\r\n                ],\r\n                code: [\r\n                    {\r\n                        required: true,\r\n                        message: \"请输入验证码\",\r\n                        trigger: \"blur\"\r\n                    },\r\n                    {\r\n                        min: 4,\r\n                        max: 4,\r\n                        message: \"验证码长度为4位\",\r\n                        trigger: \"blur\"\r\n                    }\r\n                ]\r\n            },\r\n            isShowPwd: false, // 是否显示密码\r\n            loading: false, // 登录loading\r\n            showDialog: false, // 显示dialog\r\n            redirect: null, // 回调地址\r\n            codeUrl: codeUrl\r\n        };\r\n    },\r\n    created() {\r\n        // 将参数拷贝进查询对象\r\n        let query = this.$route.query;\r\n        if (query.redirect) {\r\n            // URL Encode\r\n            this.redirect = decodeURIComponent(query.redirect);\r\n        }\r\n\r\n        //this._isMobile();\r\n\r\n        // let ddmsusername = this.getCookie(\"ddmsusername\");\r\n        // let ddmspassword = Base64.decode(this.getCookie(\"ddmspassword\"));\r\n\r\n        let ddmsusername = window.localStorage.getItem(\"ddmsusername\");\r\n        let ddmspassword = Base64.decode(\r\n            window.localStorage.getItem(\"ddmspassword\")\r\n        );\r\n        if (ddmsusername) {\r\n            this.ruleForm.username = ddmsusername;\r\n            this.ruleForm.password = ddmspassword;\r\n        }\r\n\r\n        this.refreshCode(ddmsusername);\r\n\r\n        //alert(this.getCode().code);\r\n    },\r\n    methods: {\r\n        isRemember(val) {\r\n            console.log(val);\r\n            if (!val) {\r\n                this.autoLogin = false;\r\n                this.isAutoLogin = true;\r\n            } else {\r\n                this.autoLogin = true;\r\n                this.isAutoLogin = false;\r\n            }\r\n        },\r\n        refreshCode(ddmsusername) {\r\n            this.ruleForm.code = \"\";\r\n            this.ruleForm.randomStr = randomLenNum(this.code.len, true);\r\n            if (ddmsusername) {\r\n                this.code.type = \"text\";\r\n            }\r\n            this.code.type === \"text\"\r\n                ? (this.code.value = randomLenNum(this.code.len))\r\n                : (this.code.src = `${this.codeUrl}?randomStr=${this.ruleForm.randomStr}`);\r\n            this.ruleForm.code = this.code.value;\r\n            //let ddmsAutoLogin = this.getCookie(\"ddmsAutoLogin\");\r\n            let ddmsAutoLogin = window.localStorage.getItem(\"ddmsAutoLogin\");\r\n            if (ddmsAutoLogin) {\r\n                this.login();\r\n            }\r\n        },\r\n        handleLogin() {\r\n            this.$refs[\"ruleForm\"].validate(valid => {\r\n                if (valid) {\r\n                    this.login();\r\n                } else {\r\n                    return false;\r\n                }\r\n            });\r\n        },\r\n\r\n        login() {\r\n            this.loading = true;\r\n            this.$store\r\n                .dispatch(\"loginName\", this.ruleForm)\r\n                .then(response => {\n                    console.log(response)\r\n                    this.loading = false;\r\n                    // if (response.code) {\r\n                    //     this.$message.error(response.message);\r\n                    //     return;\r\n                    // }\r\n                    // 储存登录信息\r\n                    this.setUserInfo();\r\n                    let path = \"/\";\r\n                    // if (this.redirect) {\r\n                    //     path = this.redirect;\r\n                    // }\r\n                    this.$router.push({\r\n                        path: path\r\n                    });\r\n                    //console.log(path)\r\n                    //window.location.replace(path);\r\n                    // this.showDialog = true\r\n                })\r\n                .catch(() => {\r\n                    this.loading = false;\r\n                });\r\n        },\r\n\r\n        wxLogin() {\r\n            // if(this._isMobile()){\r\n            //     console.log(\"m\")\r\n            // }else {\r\n            //     console.log(\"pc\")\r\n            // }\r\n\r\n            // let appid, client_id, redirect_uri, url\r\n            // redirect_uri = encodeURIComponent(window.location.origin + '/#/authredirect')\r\n            //\r\n            // appid = 'wxd1678d3f83b1d83a'\r\n            // url = 'https://open.weixin.qq.com/connect/qrconnect?appid=' + appid + '&redirect_uri=' + redirect_uri + '&state=WX-BIND&response_type=code&scope=snsapi_login#wechat_redirect'\r\n\r\n            let url =\r\n                \"https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxce4bd89765319e92&redirect_uri=http%3A%2F%2Foa.dreamdeck.cn%2F#%2Flogin&response_type=code&scope=snsapi_userinfo&state=123#wechat_redirect\";\r\n\r\n            window.location.href = url;\r\n        },\r\n        _isMobile() {\r\n            let flag = navigator.userAgent.match(\r\n                /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i\r\n            );\r\n\r\n            if (flag) {\r\n                this.isMobile = true;\r\n            }\r\n\r\n            return flag;\r\n        },\r\n        getCode() {\r\n            const href = location.href;\r\n            if (href.indexOf(\"?\") != -1) {\r\n                var search = href.split(\"?\")[1].split(\"&\"),\r\n                    data = {};\r\n                for (var i = 0; i < search.length; i++) {\r\n                    var item = search[i].split(\"=\");\r\n                    data[item[0]] = item[1];\r\n                }\r\n                return data;\r\n            } else {\r\n                return {};\r\n            }\r\n        },\r\n\r\n        // 储存表单信息\r\n        setUserInfo: function() {\r\n            // 判断用户是否勾选记住密码，如果勾选，向cookie中储存登录信息，\r\n            // 如果没有勾选，储存的信息为空\r\n            if (this.remember) {\r\n                window.localStorage.setItem(\r\n                    \"ddmsusername\",\r\n                    this.ruleForm.username\r\n                );\r\n                //this.setCookie(\"ddmsusername\",this.ruleForm.username)\r\n                // base64加密密码\r\n                let passWord = Base64.encode(this.ruleForm.password);\r\n                window.localStorage.setItem(\"ddmspassword\", passWord);\r\n                //this.setCookie(\"ddmspassword\",passWord)\r\n            } else {\r\n                window.localStorage.setItem(\"ddmsusername\", \"\");\r\n                window.localStorage.setItem(\"ddmspassword\", \"\");\r\n                //this.setCookie(\"ddmsusername\",\"\")\r\n                //this.setCookie(\"ddmspassword\",\"\")\r\n            }\r\n            //this.setCookie(\"ddmsAutoLogin\",this.autoLogin)\r\n            window.localStorage.setItem(\"ddmsAutoLogin\", this.autoLogin);\r\n        },\r\n        // 获取cookie\r\n        getCookie: function(key) {\r\n            if (document.cookie.length > 0) {\r\n                var start = document.cookie.indexOf(key + \"=\");\r\n                if (start !== -1) {\r\n                    start = start + key.length + 1;\r\n                    var end = document.cookie.indexOf(\";\", start);\r\n                    if (end === -1) end = document.cookie.length;\r\n                    return unescape(document.cookie.substring(start, end));\r\n                }\r\n            }\r\n            return \"\";\r\n        },\r\n        // 保存cookie\r\n        setCookie: function(cName, value, expiredays) {\r\n            var exdate = new Date();\r\n            exdate.setDate(exdate.getDate() + expiredays);\r\n            document.cookie =\r\n                cName +\r\n                \"=\" +\r\n                decodeURIComponent(value) +\r\n                (expiredays == null ? \"\" : \";expires=\" + exdate.toGMTString());\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style type=\"text/scss\" lang=\"scss\">\r\n@import \"../../styles/mixin\";\r\n\r\n$bg: #2d3a4b;\r\n$dark_gray: #889aa4;\r\n$light_gray: #eee;\r\n.login-container {\r\n    @include relative;\r\n    height: 100%;\r\n    background-color: $bg;\r\n    input:-webkit-autofill {\r\n        -webkit-box-shadow: 0 0 0 1000px #293444 inset !important;\r\n        -webkit-text-fill-color: #fff !important;\r\n    }\r\n    .item {\r\n        .el-form-item__content {\r\n            display: flex;\r\n            flex-flow: row;\r\n        }\r\n    }\r\n    input {\r\n        background: transparent;\r\n        border: 0;\r\n        -webkit-appearance: none;\r\n        border-radius: 0;\r\n        padding: 0.46rem 0.0666rem 0.16rem 0.2rem;\r\n        color: $light_gray;\r\n        height: 100%;\r\n    }\r\n    .el-input {\r\n        display: inline-block;\r\n    }\r\n    .tips {\r\n        font-size: 14px;\r\n        color: #fff;\r\n        margin-bottom: 0.13333rem;\r\n    }\r\n    .svg-container {\r\n        padding: 0.08rem 0.0666rem 0.08rem 0.2rem;\r\n        color: $dark_gray;\r\n        vertical-align: middle;\r\n        display: inline-block;\r\n        &_login {\r\n            font-size: 20px;\r\n        }\r\n    }\r\n    .title {\r\n        font-size: 26px;\r\n        color: $light_gray;\r\n        margin: 0 auto 0.5333rem auto;\r\n        text-align: center;\r\n        font-weight: bold;\r\n        letter-spacing: 5px;\r\n    }\r\n    .login-form {\r\n        @include fxied-center;\r\n        top: 40%;\r\n        width: 22em;\r\n        padding: 1.4666rem 1.4666rem 1.2rem 1.4666rem;\r\n        box-shadow: 0px 0px 5px 3px #888888;\r\n        border-radius: 10px;\r\n    }\r\n    .el-form-item {\r\n        border: 1px solid rgba(255, 255, 255, 0.1);\r\n        background: rgba(0, 0, 0, 0.1);\r\n        border-radius: 0.0666rem;\r\n        color: #454545;\r\n    }\r\n    .show-pwd {\r\n        position: absolute;\r\n        right: 0.1333rem;\r\n        top: 0.09333rem;\r\n        font-size: 16px;\r\n        color: $dark_gray;\r\n        cursor: pointer;\r\n    }\r\n    .thirdparty-button {\r\n        /*position: absolute;*/\r\n        /*right: .4666rem;*/\r\n        /*bottom: .37333rem;*/\r\n    }\r\n    .login-code-img {\r\n        width: 70px;\r\n        margin-top: 5px;\r\n        margin-left: 15%;\r\n    }\r\n}\r\n</style>\r\n"]}]}