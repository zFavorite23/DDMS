{"remainingRequest":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\ability\\dept\\Hour.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\ability\\dept\\Hour.vue","mtime":1596537159523},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { getHourRadixUserBySum, getHourRadixUserYesterday } from '../../../api/checkwork/hour.js';\nimport { getHourRadixDept, getHourRadixDeptCentre, getHourRadixDeptCentreuser } from '../../../api/checkwork/hour.js';\nimport { dateFormat } from '../../../utils/date.js';\nimport { mapGetters } from 'vuex';\nexport default {\n    data() {\n        return {\n            // 部门\n            query1: {\n                startDay: dateFormat(new Date()).substr(0, 7) + '-01',\n                endDay: dateFormat(new Date()),\n                deptId: null\n            },\n            // 个人\n            query2: {\n                startDay: dateFormat(new Date()).substr(0, 7) + '-01',\n                endDay: dateFormat(new Date())\n            },\n            // 公司\n            query3: {\n                startDay: dateFormat(new Date()).substr(0, 7) + '-01',\n                endDay: dateFormat(new Date()),\n                userId: null,\n                type: '1'\n            },\n            // 中心\n            query4: {\n                startDay: dateFormat(new Date()).substr(0, 7) + '-01',\n                endDay: dateFormat(new Date()),\n                userId: null,\n                parentId: null\n            },\n            DeptList: [],\n            options2: [\n                {\n                    value: '1',\n                    label: '中心'\n                },\n                {\n                    value: '2',\n                    label: '部门'\n                }\n            ],\n            CentreList: [],\n\n            isShow: false,\n            isShow2: false,\n            isShow3: false,\n            isShow4: false,\n            optionBar: {\n                title: {\n                    text: ''\n                    //subtext: '纯属虚构'\n                },\n                toolbox: {\n                    show: true,\n                    feature: {\n                        restore: { show: true },\n                        saveAsImage: { show: true }\n                    }\n                },\n                color: ['#3398DB'],\n                tooltip: {\n                    trigger: 'axis',\n                    axisPointer: {\n                        // 坐标轴指示器，坐标轴触发有效\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\n                    }\n                },\n                grid: {\n                    left: '3%',\n                    right: '4%',\n                    bottom: '3%',\n                    containLabel: true\n                },\n                xAxis: [\n                    {\n                        type: 'category',\n                        data: [],\n                        axisTick: {\n                            alignWithLabel: true\n                        }\n                    }\n                ],\n                yAxis: [\n                    {\n                        type: 'value',\n                        splitLine: { show: false }\n                    }\n                ],\n                series: [\n                    {\n                        name: '总工时',\n                        type: 'bar',\n                        barWidth: '40%',\n                        data: [],\n                        markLine: {\n                            data: [\n                                {\n                                    type: 'average',\n                                    name: '平均值',\n                                    itemStyle: { normal: { color: 'green' } },\n                                    label: {\n                                        formatter: '平均线'\n                                    }\n                                },\n                                {\n                                    name: '达标线',\n                                    itemStyle: { normal: { color: 'red' } },\n                                    label: {\n                                        formatter: '达标线'\n                                    },\n                                    yAxis: ''\n                                }\n                            ]\n                        },\n                        label: {\n                            show: true,\n                            position: 'top',\n                            color: 'black',\n                            formatter: function(params) {\n                                return params.value;\n                            }\n                        }\n                    }\n                ]\n            },\n            optionBar2: {\n                title: {\n                    text: '公司个人工时排行'\n                    //subtext: '纯属虚构'\n                },\n                toolbox: {\n                    show: true,\n                    feature: {\n                        restore: { show: true },\n                        saveAsImage: { show: true }\n                    }\n                },\n                color: ['#3398DB'],\n                tooltip: {\n                    trigger: 'axis',\n                    axisPointer: {\n                        // 坐标轴指示器，坐标轴触发有效\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\n                    }\n                },\n                grid: {\n                    left: '3%',\n                    right: '4%',\n                    bottom: '3%',\n                    containLabel: true\n                },\n                xAxis: [\n                    {\n                        type: 'category',\n                        data: [],\n                        axisTick: {\n                            alignWithLabel: true\n                        },\n                        axisLabel: {\n                            //底部文字倾斜\n                            interval: 0,\n                            rotate: 25\n                        }\n                    }\n                ],\n                yAxis: [\n                    {\n                        type: 'value',\n                        splitLine: { show: false }\n                    }\n                ],\n                series: [\n                    {\n                        name: '总工时',\n                        type: 'bar',\n                        barWidth: '40%',\n                        data: [],\n                        markLine: {\n                            data: [\n                                {\n                                    type: 'average',\n                                    name: '平均值',\n                                    itemStyle: { normal: { color: 'green' } },\n                                    label: {\n                                        formatter: '平均线'\n                                    }\n                                },\n                                {\n                                    name: '达标线',\n                                    itemStyle: { normal: { color: 'red' } },\n                                    label: {\n                                        formatter: '达标线'\n                                    },\n                                    yAxis: ''\n                                },\n                                {\n                                    name: '劳模线',\n                                    itemStyle: { normal: { color: 'blue' } },\n                                    label: {\n                                        formatter: '劳模线'\n                                    },\n                                    yAxis: ''\n                                }\n                            ]\n                        },\n                        label: {\n                            show: true,\n                            position: 'top',\n                            color: 'black',\n                            formatter: function(params) {\n                                return params.value;\n                            }\n                        }\n                    }\n                ]\n            },\n            optionBar3: {\n                title: {\n                    text: ''\n                    //subtext: '纯属虚构'\n                },\n                toolbox: {\n                    show: true,\n                    feature: {\n                        restore: { show: true },\n                        saveAsImage: { show: true }\n                    }\n                },\n                color: ['#3398DB'],\n                tooltip: {\n                    trigger: 'axis',\n                    axisPointer: {\n                        // 坐标轴指示器，坐标轴触发有效\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\n                    }\n                },\n                grid: {\n                    left: '3%',\n                    right: '4%',\n                    bottom: '3%',\n                    containLabel: true\n                },\n                xAxis: [\n                    {\n                        type: 'category',\n                        data: [],\n                        axisTick: {\n                            alignWithLabel: true\n                        },\n                        axisLabel: {\n                            //底部文字倾斜\n                            interval: 0,\n                            rotate: 25\n                        }\n                    }\n                ],\n                yAxis: [\n                    {\n                        type: 'value',\n                        splitLine: { show: false }\n                    }\n                ],\n                series: [\n                    {\n                        name: '总工时',\n                        type: 'bar',\n                        barWidth: '40%',\n                        data: [],\n                        markLine: {\n                            data: [\n                                {\n                                    type: 'average',\n                                    name: '平均值',\n                                    itemStyle: { normal: { color: 'green' } },\n                                    label: {\n                                        formatter: '平均线'\n                                    }\n                                }\n                            ]\n                        },\n                        label: {\n                            show: true,\n                            position: 'top',\n                            color: 'black',\n                            formatter: function(params) {\n                                return params.value;\n                            }\n                        }\n                    }\n                ]\n            },\n            optionBar4: {\n                title: {\n                    text: ''\n                    //subtext: '纯属虚构'\n                },\n                toolbox: {\n                    show: true,\n                    feature: {\n                        restore: { show: true },\n                        saveAsImage: { show: true }\n                    }\n                },\n                color: ['#3398DB'],\n                tooltip: {\n                    trigger: 'axis',\n                    axisPointer: {\n                        // 坐标轴指示器，坐标轴触发有效\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\n                    }\n                },\n                grid: {\n                    left: '3%',\n                    right: '4%',\n                    bottom: '3%',\n                    containLabel: true\n                },\n                xAxis: [\n                    {\n                        type: 'category',\n                        data: [],\n                        axisTick: {\n                            alignWithLabel: true\n                        },\n                        axisLabel: {\n                            //底部文字倾斜\n                            interval: 0,\n                            rotate: 25\n                        }\n                    }\n                ],\n                yAxis: [\n                    {\n                        type: 'value',\n                        splitLine: { show: false }\n                    }\n                ],\n                series: [\n                    {\n                        name: '总工时',\n                        type: 'bar',\n                        barWidth: '40%',\n                        data: [],\n                        markLine: {\n                            data: [\n                                {\n                                    type: 'average',\n                                    name: '平均值',\n                                    itemStyle: { normal: { color: 'green' } },\n                                    label: {\n                                        formatter: '平均线'\n                                    }\n                                },\n                                {\n                                    name: '达标线',\n                                    itemStyle: { normal: { color: 'red' } },\n                                    label: {\n                                        formatter: '达标线'\n                                    },\n                                    yAxis: 9\n                                },\n                                {\n                                    name: '劳模线',\n                                    itemStyle: { normal: { color: 'blue' } },\n                                    label: {\n                                        formatter: '劳模线'\n                                    },\n                                    yAxis: 11\n                                }\n                            ]\n                        },\n                        label: {\n                            show: true,\n                            position: 'top',\n                            color: 'black',\n                            formatter: function(params) {\n                                return params.value;\n                            }\n                        }\n                    }\n                ]\n            },\n            optionBar5: {\n                title: {\n                    text: ''\n                    //subtext: '纯属虚构'\n                },\n                toolbox: {\n                    show: true,\n                    feature: {\n                        restore: { show: true },\n                        saveAsImage: { show: true }\n                    }\n                },\n                color: ['#3398DB'],\n                tooltip: {\n                    trigger: 'axis',\n                    axisPointer: {\n                        // 坐标轴指示器，坐标轴触发有效\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\n                    }\n                },\n                grid: {\n                    left: '3%',\n                    right: '4%',\n                    bottom: '3%',\n                    containLabel: true\n                },\n                xAxis: [\n                    {\n                        type: 'category',\n                        data: [],\n                        axisTick: {\n                            alignWithLabel: true\n                        },\n                        axisLabel: {\n                            //底部文字倾斜\n                            interval: 0,\n                            rotate: 25\n                        }\n                    }\n                ],\n                yAxis: [\n                    {\n                        type: 'value',\n                        splitLine: { show: false }\n                    }\n                ],\n                series: [\n                    {\n                        name: '总工时',\n                        type: 'bar',\n                        barWidth: '40%',\n                        data: [],\n                        markLine: {\n                            data: [\n                                {\n                                    type: 'average',\n                                    name: '平均值',\n                                    itemStyle: { normal: { color: 'green' } },\n                                    label: {\n                                        formatter: '平均线'\n                                    }\n                                },\n                                {\n                                    name: '达标线',\n                                    itemStyle: { normal: { color: 'red' } },\n                                    label: {\n                                        formatter: '达标线'\n                                    },\n                                    yAxis: ''\n                                },\n                                {\n                                    name: '劳模线',\n                                    itemStyle: { normal: { color: 'blue' } },\n                                    label: {\n                                        formatter: '劳模线'\n                                    },\n                                    yAxis: ''\n                                }\n                            ]\n                        },\n                        label: {\n                            show: true,\n                            position: 'top',\n                            color: 'black',\n                            formatter: function(params) {\n                                return params.value;\n                            }\n                        }\n                    }\n                ]\n            }\n        };\n    },\n    computed: {\n        ...mapGetters(['permissions', 'deptId', 'userId'])\n    },\n    created() {\n        this.getHourRadixDept();\n        this.getHourRadixDeptCentre();\n        this.query1.deptId = this.deptId;\n        this.query4.userId = this.userId;\n        this.query3.userId = this.userId;\n\n        this.getHourRadix();\n    },\n    mounted() {},\n    methods: {\n        // 获取所有部门\n        getHourRadixDept() {\n            getHourRadixDept().then(res => {\n                res.data.data.forEach(item => {\n                    this.DeptList.push({\n                        value: item.deptId,\n                        label: item.deptName\n                    });\n                });\n            });\n        },\n        // 获取所有中心\n        getHourRadixDeptCentre() {\n            getHourRadixDeptCentre().then(res => {\n                res.data.data.forEach(item => {\n                    this.CentreList.push({\n                        value: item.parentId,\n                        label: item.parentName\n                    });\n\n                });\n                this.query4.parentId = this.CentreList[0].value;\n            });\n\n\n        },\n        // 部门\n        getHourRadix() {\n            this.optionBar.xAxis[0].data = [];\n            this.optionBar.series[0].data = [];\n            this.isShow = true;\n            this.isShow2 = false;\n            this.isShow3 = false;\n            this.isShow4 = false;\n            this.isShow5 = false;\n            getHourRadixUserBySum(this.query1).then(response => {\n                var deptName = response.data.data[0].deptName;\n                this.optionBar.title.text = `${deptName}成员工时排行`;\n                var workTotalNum = response.data.data[0].workTotalNum - 1;\n                this.optionBar.series[0].markLine.data[1].yAxis = workTotalNum * 9;\n                response.data.data.forEach((item, index) => {\n                    this.optionBar.xAxis[0].data[index] = item.userName;\n                    this.optionBar.series[0].data[index] = item.sumNum.toFixed(2);\n                });\n                this.drawBar1();\n            });\n        },\n        // 个人\n        getHourRadix2() {\n            this.isShow2 = true;\n            this.isShow = false;\n            this.isShow3 = false;\n            this.isShow4 = false;\n            this.isShow5 = false;\n            getHourRadixUserBySum(this.query2).then(response => {\n                var workTotalNum = response.data.data[0].workTotalNum - 1;\n                this.optionBar2.series[0].markLine.data[1].yAxis = workTotalNum * 9;\n                this.optionBar2.series[0].markLine.data[2].yAxis = workTotalNum * 11;\n                response.data.data.forEach((item, index) => {\n                    //console.log(item);\n                    this.optionBar2.xAxis[0].data[index] = item.userName;\n                    this.optionBar2.series[0].data[index] = item.sumNum.toFixed(2);\n                });\n                this.drawBar2();\n            });\n        },\n        // 公司\n        getHourRadix3() {\n            this.optionBar3.xAxis[0].data = [];\n            this.optionBar3.series[0].data = [];\n            this.isShow3 = true;\n            this.isShow = false;\n            this.isShow2 = false;\n            this.isShow4 = false;\n            this.isShow5 = false;\n            if (this.query3.type == 1) {\n                getHourRadixDeptCentre(this.query3).then(res => {\n                    this.optionBar3.title.text = `公司中心工时排行`;\n                    res.data.data.forEach((item, index) => {\n                        // console.log(item);\n                        this.optionBar3.xAxis[0].data[index] = item.parentName;\n                        this.optionBar3.series[0].data[index] = item.avgMin.toFixed(2);\n                    });\n                    this.drawBar3();\n                });\n            } else if (this.query3.type == 2) {\n                getHourRadixDept(this.query3).then(response => {\n                    this.optionBar3.title.text = `公司部门工时排行`;\n                    response.data.data.forEach((item, index) => {\n                        // console.log(item);\n                        this.optionBar3.xAxis[0].data[index] = item.deptName;\n                        this.optionBar3.series[0].data[index] = item.avgNum.toFixed(2);\n                    });\n                    this.drawBar3();\n                });\n            }\n        },\n        // 昨日\n        getHourRadix4() {\n            this.isShow = false;\n            this.isShow2 = false;\n            this.isShow3 = false;\n            this.isShow4 = true;\n            this.isShow5 = false;\n            getHourRadixUserYesterday().then(res => {\n                var time = res.data.data[0].time;\n                var reg = /(\\d{4})\\-(\\d{2})\\-(\\d{2})/;\n                var date = time.replace(reg, '$1年$2月$3日');\n                this.optionBar4.title.text = `${date}个人工时排行`;\n                res.data.data.forEach((item, index) => {\n                    // console.log(item);\n                    this.optionBar4.xAxis[0].data[index] = item.userName;\n                    this.optionBar4.series[0].data[index] = item.sumNum.toFixed(2);\n                });\n                this.drawBar4();\n            });\n        },\n        // 中心\n        getHourRadix5() {\n            this.optionBar5.xAxis[0].data = [];\n            this.optionBar5.series[0].data = [];\n            this.isShow = false;\n            this.isShow2 = false;\n            this.isShow3 = false;\n            this.isShow4 = false;\n            this.isShow5 = true;\n            getHourRadixDeptCentreuser(this.query4).then(response => {\n                var parentName = response.data.data[0].parentName;\n                this.optionBar5.title.text = `${parentName}工时排行`;\n                var workTotalNum = response.data.data[0].workTotalNum - 1;\n                this.optionBar5.series[0].markLine.data[1].yAxis = workTotalNum * 9;\n                this.optionBar5.series[0].markLine.data[2].yAxis = workTotalNum * 11;\n                response.data.data.forEach((item, index) => {\n                    //console.log(item);\n                    this.optionBar5.xAxis[0].data[index] = item.userName;\n                    this.optionBar5.series[0].data[index] = item.sumNum.toFixed(2);\n                });\n                this.drawBar5();\n            });\n        },\n\n        drawBar1() {\n            let bar1 = this.$echarts.init(document.getElementById('userBar'));\n\n            bar1.setOption(this.optionBar, (window.onresize = bar1.resize));\n            bar1.resize();\n            window.addEventListener('resize', function() {\n                bar1.resize();\n            });\n        },\n        drawBar2() {\n            let bar2 = this.$echarts.init(document.getElementById('userBar2'));\n\n            bar2.setOption(this.optionBar2, (window.onresize = bar2.resize));\n            bar2.resize();\n            window.addEventListener('resize', function() {\n                bar2.resize();\n            });\n        },\n        drawBar3() {\n            let bar3 = this.$echarts.init(document.getElementById('userBar3'));\n\n            bar3.setOption(this.optionBar3, (window.onresize = bar3.resize));\n            bar3.resize();\n            window.addEventListener('resize', function() {\n                bar3.resize();\n            });\n        },\n        drawBar4() {\n            let bar4 = this.$echarts.init(document.getElementById('userBar4'));\n\n            bar4.setOption(this.optionBar4, (window.onresize = bar4.resize));\n            bar4.resize();\n            window.addEventListener('resize', function() {\n                bar4.resize();\n            });\n        },\n        drawBar5() {\n            let bar5 = this.$echarts.init(document.getElementById('userBar5'));\n\n            bar5.setOption(this.optionBar5, (window.onresize = bar5.resize));\n            bar5.resize();\n            window.addEventListener('resize', function() {\n                bar5.resize();\n            });\n        }\n    }\n};\n",null]}