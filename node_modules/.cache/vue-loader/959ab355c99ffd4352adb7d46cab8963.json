{"remainingRequest":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\ability\\company\\Clock.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\ability\\company\\Clock.vue","mtime":1588235430038},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { getStatisticsAbnormal } from \"../../../api/checkwork/clock.js\";\nimport { getDecline } from \"../../../api/checkwork/hour.js\";\nimport { dateFormat } from \"../../../utils/date.js\";\nimport { mapGetters } from \"vuex\";\nexport default {\n    data() {\n        return {\n            query: {\n                selectMonth: dateFormat(new Date()).substr(0, 7)\n            },\n            expireTimeOption: {\n                disabledDate: time => {\n                    var date = new Date();\n                    var year = date.getFullYear();\n                    var month = date.getMonth() + 1;\n                    if (month >= 1 && month <= 9) {\n                        month = \"0\" + month;\n                    }\n                    var currentdate = year.toString() + month.toString();\n                    var timeyear = time.getFullYear();\n                    var timemonth = time.getMonth() + 1;\n                    if (timemonth >= 1 && timemonth <= 9) {\n                        timemonth = \"0\" + timemonth;\n                    }\n                    var timedate = timeyear.toString() + timemonth.toString();\n                    return currentdate < timedate;\n                }\n            },\n            listLoading: false,\n            list: [],\n            optionBar1: {\n                title: {\n                    text: '迟到早退统计图',\n                    y: \"bottom\",\n                    left: \"center\"\n                },\n                tooltip: {\n                    trigger: 'axis'\n                },\n                legend: {\n                    y: \"top\",\n                    data: ['旷工', '迟到', '早退']\n                },\n                xAxis: [\n                    {\n                        type: \"category\",\n                        data: []\n                    }\n                ],\n                yAxis: [\n                    {\n                        type: \"value\"\n                    }\n                ],\n                series: [\n                    {\n                        name: \"旷工\",\n                        type: \"bar\",\n                        data: []\n                    },\n                    {\n                        name: \"迟到\",\n                        type: \"bar\",\n                        stack: \"1\",\n                        data: [],\n                    },\n                    {\n                        name: \"早退\",\n                        type: \"bar\",\n                        stack: \"1\",\n                        data: []\n                    },\n\n                ]\n            },\n            optionBar2: {\n                title: {\n                    text: '工时率下降统计图',\n                    y: \"bottom\",\n                    left: \"center\"\n                },\n                tooltip: {\n                    trigger: 'axis'\n                },\n                legend: {\n                    data: []\n                },\n                toolbox: {\n                    feature: {\n                        saveAsImage: {}\n                    }\n                },\n                xAxis: {\n                    type: 'category',\n                    boundaryGap: false,\n                    data: ['第一周', '第二周', '第三周', '第四周', '第五周', '第六周', '第七周']\n                },\n                yAxis: {\n                    type: 'value'\n                },\n                series: [\n                    // {\n                    //     name: '第一周',\n                    //     type: 'line',\n                    //     stack: '工时',\n                    //     data: []\n                    // }\n                ]\n            }\n        };\n    },\n    computed: {\n        ...mapGetters([\"permissions\"])\n    },\n    created() {\n        this.getStatisticsAbnormal();\n        this.$nextTick(function() {\n            this.drawBar();\n        });\n    },\n    mounted() {},\n    methods: {\n\n        getStatisticsAbnormal() {\n            getStatisticsAbnormal(this.query)\n                .then(response => {\n\n                    this.list = response.data.data;\n                    this.list.forEach((item, index) => {\n                        this.optionBar1.xAxis[0].data.push(item.userName);\n                        this.optionBar1.series[0].data.push(item.absenteeismNum);\n                        this.optionBar1.series[1].data.push(item.lateNum);\n                        this.optionBar1.series[2].data.push(item.leaveEarlyNum);\n\n                    });\n                    this.getDecline();\n                })\n        },\n        getDecline(){\n            getDecline(this.query)\n                .then(response => {\n                    this.list = response.data.data;\n                    this.list.forEach((item, index) => {\n                        this.optionBar2.legend.data.push(item.userName);\n                        // this.optionBar1.series[0].data.push(item.absenteeismNum);\n                        this.optionBar2.series.push(\n                            {\n                                name: item.userName,\n                                type: 'line',\n                                stack: index,\n                                data: item.minList\n                            }\n                        );\n\n                        // this.optionBar1.series[2].data.push(item.leaveEarlyNum);\n                        console.log(item)\n                    });\n                    this.drawBar();\n                })\n        },\n        drawBar() {\n            let bar1 = this.$echarts.init(document.getElementById(\"userBar1\"));\n            let bar2 = this.$echarts.init(document.getElementById(\"userBar2\"));\n\n            bar1.setOption(this.optionBar1, (window.onresize = bar1.resize));\n            bar2.setOption(this.optionBar2, (window.onresize = bar2.resize));\n            bar1.resize();\n            bar2.resize();\n            window.addEventListener(\"resize\", function() {\n                bar1.resize();\n                bar2.resize();\n            });\n        }\n    }\n};\n",null]}