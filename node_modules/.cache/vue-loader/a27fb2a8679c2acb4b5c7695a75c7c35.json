{"remainingRequest":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\ability\\dept\\Hour.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\ability\\dept\\Hour.vue","mtime":1589439025537},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { getHourRadixUserBySum, getHourRadixUserYesterday } from '../../../api/checkwork/hour.js';\r\nimport { getHourRadixDept } from '../../../api/checkwork/hour.js';\r\nimport { dateFormat } from '../../../utils/date.js';\r\nimport { mapGetters } from 'vuex';\r\nexport default {\r\n    data() {\r\n        return {\r\n            query1: {\r\n                startDay: dateFormat(new Date()).substr(0, 7) + '-01',\r\n                endDay: dateFormat(new Date()),\r\n                deptId: null\r\n            },\r\n            query2: {\r\n                startDay: dateFormat(new Date()).substr(0, 7) + '-01',\r\n                endDay: dateFormat(new Date())\r\n            },\r\n            query3: {\r\n                startDay: dateFormat(new Date()).substr(0, 7) + '-01',\r\n                endDay: dateFormat(new Date())\r\n            },\r\n            isShow: false,\r\n            isShow2: false,\r\n            isShow3: false,\r\n            isShow4: false,\r\n            optionBar: {\r\n                title: {\r\n                    text: '部门成员工时排行'\r\n                    //subtext: '纯属虚构'\r\n                },\r\n                toolbox: {\r\n                    show: true,\r\n                    feature: {\r\n                        restore: { show: true },\r\n                        saveAsImage: { show: true }\r\n                    }\r\n                },\r\n                color: ['#3398DB'],\r\n                tooltip: {\r\n                    trigger: 'axis',\r\n                    axisPointer: {\r\n                        // 坐标轴指示器，坐标轴触发有效\r\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\r\n                    }\r\n                },\r\n                grid: {\r\n                    left: '3%',\r\n                    right: '4%',\r\n                    bottom: '3%',\r\n                    containLabel: true\r\n                },\r\n                xAxis: [\r\n                    {\r\n                        type: 'category',\r\n                        data: [],\r\n                        axisTick: {\r\n                            alignWithLabel: true\r\n                        },\r\n                    }\r\n                ],\r\n                yAxis: [\r\n                    {\r\n                        type: 'value',\r\n                        splitLine: { show: false }\r\n                    }\r\n                ],\r\n                series: [\r\n                    {\r\n                        name: '总工时',\r\n                        type: 'bar',\r\n                        barWidth: '40%',\r\n                        data: [],\r\n                        markLine: {\r\n                            data: [\r\n                                {\r\n                                    type: 'average',\r\n                                    name: '平均值',\r\n                                    itemStyle: { normal: { color: 'green' } },\r\n                                    label: {\r\n                                        formatter: '平均线'\r\n                                    }\r\n                                },\r\n                                {\r\n                                    name: '达标线',\r\n                                    itemStyle: { normal: { color: 'red' } },\r\n                                    label: {\r\n                                        formatter: '达标线'\r\n                                    },\r\n                                    yAxis: ''\r\n                                },\r\n                            ]\r\n                        },\r\n                        label: {\r\n                            show: true,\r\n                            position: 'top',\r\n                            color: 'black',\r\n                            formatter: function(params) {\r\n                                return params.value;\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            optionBar2: {\r\n                title: {\r\n                    text: '公司个人工时排行'\r\n                    //subtext: '纯属虚构'\r\n                },\r\n                toolbox: {\r\n                    show: true,\r\n                    feature: {\r\n                        restore: { show: true },\r\n                        saveAsImage: { show: true }\r\n                    }\r\n                },\r\n                color: ['#3398DB'],\r\n                tooltip: {\r\n                    trigger: 'axis',\r\n                    axisPointer: {\r\n                        // 坐标轴指示器，坐标轴触发有效\r\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\r\n                    }\r\n                },\r\n                grid: {\r\n                    left: '3%',\r\n                    right: '4%',\r\n                    bottom: '3%',\r\n                    containLabel: true\r\n                },\r\n                xAxis: [\r\n                    {\r\n                        type: 'category',\r\n                        data: [],\r\n                        axisTick: {\r\n                            alignWithLabel: true\r\n                        },\r\n                        axisLabel: {\r\n                            //底部文字倾斜\r\n                            interval: 0,\r\n                            rotate: 25\r\n                        }\r\n                    }\r\n                ],\r\n                yAxis: [\r\n                    {\r\n                        type: 'value',\r\n                        splitLine: { show: false }\r\n                    }\r\n                ],\r\n                series: [\r\n                    {\r\n                        name: '总工时',\r\n                        type: 'bar',\r\n                        barWidth: '40%',\r\n                        data: [],\r\n                        markLine: {\r\n                            data: [\r\n                                {\r\n                                    type: 'average',\r\n                                    name: '平均值',\r\n                                    itemStyle: { normal: { color: 'green' } },\r\n                                    label: {\r\n                                        formatter: '平均线'\r\n                                    }\r\n                                },\r\n                                {\r\n                                    name: '达标线',\r\n                                    itemStyle: { normal: { color: 'red' } },\r\n                                    label: {\r\n                                        formatter: '达标线'\r\n                                    },\r\n                                    yAxis: ''\r\n                                },\r\n                                {\r\n                                    name: '劳模线',\r\n                                    itemStyle: { normal: { color: 'blue' } },\r\n                                    label: {\r\n                                        formatter: '劳模线'\r\n                                    },\r\n                                    yAxis: ''\r\n                                }\r\n                            ]\r\n                        },\r\n                        label: {\r\n                            show: true,\r\n                            position: 'top',\r\n                            color: 'black',\r\n                            formatter: function(params) {\r\n                                return params.value;\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            optionBar3: {\r\n                title: {\r\n                    text: '公司部门工时排行'\r\n                    //subtext: '纯属虚构'\r\n                },\r\n                toolbox: {\r\n                    show: true,\r\n                    feature: {\r\n                        restore: { show: true },\r\n                        saveAsImage: { show: true }\r\n                    }\r\n                },\r\n                color: ['#3398DB'],\r\n                tooltip: {\r\n                    trigger: 'axis',\r\n                    axisPointer: {\r\n                        // 坐标轴指示器，坐标轴触发有效\r\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\r\n                    }\r\n                },\r\n                grid: {\r\n                    left: '3%',\r\n                    right: '4%',\r\n                    bottom: '3%',\r\n                    containLabel: true\r\n                },\r\n                xAxis: [\r\n                    {\r\n                        type: 'category',\r\n                        data: [],\r\n                        axisTick: {\r\n                            alignWithLabel: true\r\n                        },\r\n                        axisLabel: {\r\n                            //底部文字倾斜\r\n                            interval: 0,\r\n                            rotate: 25\r\n                        }\r\n                    }\r\n                ],\r\n                yAxis: [\r\n                    {\r\n                        type: 'value',\r\n                        splitLine: { show: false }\r\n                    }\r\n                ],\r\n                series: [\r\n                    {\r\n                        name: '总工时',\r\n                        type: 'bar',\r\n                        barWidth: '40%',\r\n                        data: [],\r\n                        markLine: {\r\n                            data: [\r\n                                {\r\n                                    type: 'average',\r\n                                    name: '平均值',\r\n                                    itemStyle: { normal: { color: 'green' } },\r\n                                    label: {\r\n                                        formatter: '平均线'\r\n                                    }\r\n                                }\r\n                            ]\r\n                        },\r\n                        label: {\r\n                            show: true,\r\n                            position: 'top',\r\n                            color: 'black',\r\n                            formatter: function(params) {\r\n                                return params.value;\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            },\r\n            optionBar4: {\r\n                title: {\r\n                    text: ''\r\n                    //subtext: '纯属虚构'\r\n                },\r\n                toolbox: {\r\n                    show: true,\r\n                    feature: {\r\n                        restore: { show: true },\r\n                        saveAsImage: { show: true }\r\n                    }\r\n                },\r\n                color: ['#3398DB'],\r\n                tooltip: {\r\n                    trigger: 'axis',\r\n                    axisPointer: {\r\n                        // 坐标轴指示器，坐标轴触发有效\r\n                        type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\r\n                    }\r\n                },\r\n                grid: {\r\n                    left: '3%',\r\n                    right: '4%',\r\n                    bottom: '3%',\r\n                    containLabel: true\r\n                },\r\n                xAxis: [\r\n                    {\r\n                        type: 'category',\r\n                        data: [],\r\n                        axisTick: {\r\n                            alignWithLabel: true\r\n                        },\r\n                        axisLabel: {\r\n                            //底部文字倾斜\r\n                            interval: 0,\r\n                            rotate: 25\r\n                        }\r\n                    }\r\n                ],\r\n                yAxis: [\r\n                    {\r\n                        type: 'value',\r\n                        splitLine: { show: false }\r\n                    }\r\n                ],\r\n                series: [\r\n                    {\r\n                        name: '总工时',\r\n                        type: 'bar',\r\n                        barWidth: '40%',\r\n                        data: [],\r\n                        markLine: {\r\n                            data: [\r\n                                {\r\n                                    type: 'average',\r\n                                    name: '平均值',\r\n                                    itemStyle: { normal: { color: 'green' } },\r\n                                    label: {\r\n                                        formatter: '平均线'\r\n                                    }\r\n                                },\r\n                                {\r\n                                    name: '达标线',\r\n                                    itemStyle: { normal: { color: 'red' } },\r\n                                    label: {\r\n                                        formatter: '达标线'\r\n                                    },\r\n                                    yAxis: 9\r\n                                },\r\n                                {\r\n                                    name: '劳模线',\r\n                                    itemStyle: { normal: { color: 'blue' } },\r\n                                    label: {\r\n                                        formatter: '劳模线'\r\n                                    },\r\n                                    yAxis: 11\r\n                                }\r\n                            ]\r\n                        },\r\n                        label: {\r\n                            show: true,\r\n                            position: 'top',\r\n                            color: 'black',\r\n                            formatter: function(params) {\r\n                                return params.value;\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapGetters(['permissions', 'deptId'])\r\n    },\r\n    created() {\r\n        this.query1.deptId = this.deptId;\r\n        this.getHourRadix();\r\n    },\r\n    mounted() {},\r\n    methods: {\r\n        getHourRadix() {\r\n            this.isShow = true;\r\n            this.isShow2 = false;\r\n            this.isShow3 = false;\r\n            this.isShow4 = false;\r\n            getHourRadixUserBySum(this.query1).then(response => {\r\n                var workTotalNum = response.data.data[0].workTotalNum - 1\r\n                this.optionBar.series[0].markLine.data[1].yAxis = workTotalNum * 9\r\n                response.data.data.forEach((item, index) => {\r\n                    this.optionBar.xAxis[0].data[index] = item.userName;\r\n                    this.optionBar.series[0].data[index] = item.sumNum.toFixed(2);\r\n                });\r\n                this.drawBar1();\r\n            });\r\n        },\r\n        getHourRadix2() {\r\n            this.isShow2 = true;\r\n            this.isShow = false;\r\n            this.isShow3 = false;\r\n            this.isShow4 = false;\r\n            getHourRadixUserBySum(this.query2).then(response => {\r\n                var workTotalNum = response.data.data[1].workTotalNum - 1;\r\n                this.optionBar2.series[0].markLine.data[1].yAxis = workTotalNum * 9;\r\n                this.optionBar2.series[0].markLine.data[2].yAxis = workTotalNum * 11;\r\n                response.data.data.forEach((item, index) => {\r\n                    //console.log(item);\r\n                    this.optionBar2.xAxis[0].data[index] = item.userName;\r\n                    this.optionBar2.series[0].data[index] = item.sumNum.toFixed(2);\r\n                });\r\n                this.drawBar2();\r\n            });\r\n        },\r\n        getHourRadix3() {\r\n            this.isShow3 = true;\r\n            this.isShow = false;\r\n            this.isShow2 = false;\r\n            this.isShow4 = false;\r\n            getHourRadixDept(this.query3).then(response => {\r\n                response.data.data.forEach((item, index) => {\r\n                    // console.log(item);\r\n                    this.optionBar3.xAxis[0].data[index] = item.deptName;\r\n                    this.optionBar3.series[0].data[index] = item.avgNum.toFixed(2);\r\n                });\r\n                this.drawBar3();\r\n            });\r\n        },\r\n        getHourRadix4() {\r\n            this.isShow = false;\r\n            this.isShow2 = false;\r\n            this.isShow3 = false;\r\n            this.isShow4 = true;\r\n            getHourRadixUserYesterday().then(res => {\r\n                var time = res.data.data[0].time\r\n                var reg = /(\\d{4})\\-(\\d{2})\\-(\\d{2})/;\r\n                var date = time.replace(reg, \"$1年$2月$3日\");\r\n                this.optionBar4.title.text = `${date}个人工时排行`\r\n                res.data.data.forEach((item, index) => {\r\n                    // console.log(item);\r\n                    this.optionBar4.xAxis[0].data[index] = item.userName;\r\n                    this.optionBar4.series[0].data[index] = item.sumNum.toFixed(2);\r\n                });\r\n                this.drawBar4();\r\n            });\r\n        },\r\n\r\n        drawBar1() {\r\n            let bar1 = this.$echarts.init(document.getElementById('userBar'));\r\n\r\n            bar1.setOption(this.optionBar, (window.onresize = bar1.resize));\r\n            bar1.resize();\r\n            window.addEventListener('resize', function() {\r\n                bar1.resize();\r\n            });\r\n        },\r\n        drawBar2() {\r\n            let bar2 = this.$echarts.init(document.getElementById('userBar2'));\r\n\r\n            bar2.setOption(this.optionBar2, (window.onresize = bar2.resize));\r\n            bar2.resize();\r\n            window.addEventListener('resize', function() {\r\n                bar2.resize();\r\n            });\r\n        },\r\n        drawBar3() {\r\n            let bar3 = this.$echarts.init(document.getElementById('userBar3'));\r\n\r\n            bar3.setOption(this.optionBar3, (window.onresize = bar3.resize));\r\n            bar3.resize();\r\n            window.addEventListener('resize', function() {\r\n                bar3.resize();\r\n            });\r\n        },\r\n        drawBar4() {\r\n            let bar4 = this.$echarts.init(document.getElementById('userBar4'));\r\n\r\n            bar4.setOption(this.optionBar4, (window.onresize = bar4.resize));\r\n            bar4.resize();\r\n            window.addEventListener('resize', function() {\r\n                bar4.resize();\r\n            });\r\n        }\r\n    }\r\n};\r\n",null]}