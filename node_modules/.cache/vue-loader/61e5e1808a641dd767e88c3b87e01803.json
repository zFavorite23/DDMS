{"remainingRequest":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DDMS\\src\\views\\apply\\leave\\Info.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DDMS\\src\\views\\apply\\leave\\Info.vue","mtime":1590489361032},{"path":"D:\\DDMS\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DDMS\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport {\r\n    getLeaveInfo,\r\n    getLeaveApproverList,\r\n    updateLeaveApprover\r\n} from \"../../../api/apply/leave.js\";\r\nimport { mapGetters } from \"vuex\";\r\nimport ElImageViewer from \"element-ui/packages/image/src/image-viewer\";\r\nexport default {\r\n    components: { ElImageViewer },\r\n    data() {\r\n        return {\r\n            formData: {\r\n                approverId: null,\r\n                checkUserId: null,\r\n                check: \"1\",\r\n                summary: \"同意\"\r\n            },\r\n            leaveId: null,\r\n            leaveInfo: null,\r\n            listLoading: false,\r\n            list: [],\r\n            approverList: [],\r\n            rules: {\r\n                summary: [{ required: true, message: \"请填写原因\" }]\r\n            },\r\n            showViewer: false, // 显示查看器\r\n            url: \"\",\r\n            urls: [],\r\n            showCheck: false,\r\n            saving: false\r\n        };\r\n    },\r\n    computed: {\r\n        ...mapGetters([\"permissions\", \"userId\"])\r\n    },\r\n    created() {\r\n        this.leaveId = this.$route.params.leaveId;\r\n        this.formData.checkUserId = this.userId;\n        console.log(this.userId)\r\n        this.getLeaveInfo();\r\n        this.getLeaveApproverList();\r\n    },\r\n    methods: {\r\n        getLeaveInfo() {\r\n            getLeaveInfo(this.leaveId).then(response => {\r\n                this.leaveInfo = response.data.data;\r\n                if (this.leaveInfo.proveImg != null){\r\n                    this.leaveInfo.proveImg.split(\",\").forEach((item, index) => {\r\n                        if (item) {\r\n                            this.urls.push(\r\n                                `${window.location.origin}/apply/leave/` + item\r\n                            );\r\n                        }\r\n                    });\r\n                }\r\n\r\n            });\r\n        },\r\n        getLeaveApproverList() {\r\n            getLeaveApproverList(this.leaveId).then(response => {\r\n                this.approverList = response.data.data;\r\n                this.approverList.forEach((item, index) => {\r\n                    if (\r\n                        item.check == 0 &&\r\n                        item.userId == this.formData.checkUserId\r\n                    ) {\r\n                        this.formData.approverId = item.approverId;\r\n                        this.showCheck = true;\r\n                    }\r\n                });\r\n            });\r\n        },\r\n        backHistory() {\r\n            this.$router.go(-1);\r\n        },\r\n        onPreview(val) {\r\n            this.url = this.urls[val];\r\n            this.showViewer = true;\r\n        },\r\n        closeViewer() {\r\n            this.showViewer = false;\r\n            this.url = \"\";\r\n        },\r\n        selectChcek() {\r\n            if (this.formData.check == 1) {\r\n                this.formData.summary = \"同意\";\r\n            } else {\r\n                this.formData.summary = \"\";\r\n            }\r\n        },\r\n        onSubmit() {\n            console.log(this.formData)\r\n            updateLeaveApprover(this.formData)\r\n                .then(res => {\r\n                    if (res.data.data) {\r\n                        this.backHistory();\r\n                    }\r\n                })\r\n                .finally(() => {\r\n                    this.saving = false;\r\n                });\r\n        }\r\n    }\r\n};\r\n",null]}